import{d as K,ap as C,aq as B,r as d,e as N,s as V,n as U,b as S,a as W,h as u,j as D,k as m,w as i,A as g,E as O,q as e,t as a,v as n,b4 as v,x as _,y as E,F as z,z as j,B as w,p as F,P as Y,f as G,g as H,c as J,L as Q}from"./index-7XFzyDag.js";const X={class:"amount-list"},Z={class:"amount-title"},ee={class:"multi-line-ellipsis"},se={class:"multi-line-ellipsis",style:{"line-height":"24px"}},te={style:{display:"flex","justify-content":"space-between","align-items":"center"}},ae={style:{"line-height":"24px",color:"#ff2222"}},le={class:"amount-list"},oe={style:{"margin-top":"8px"}},ie={class:"desc-list width-c3"},ne={class:"desc-item"},de={class:"desc-value"},ce={class:"desc-label"},re={class:"desc-value"},pe={class:"desc-list width-c5"},ue={class:"desc-item"},me={class:"desc-value"},ve={class:"desc-item"},_e={class:"desc-value"},fe={class:"desc-item"},ye={class:"desc-value"},he={class:"desc-item"},be={class:"desc-value"},ge={class:"desc-list width-c4"},xe={class:"desc-item"},Le={class:"desc-value"},Te={class:"desc-item"},Pe={class:"desc-value"},Ce={class:"desc-item"},Ne={class:"desc-value"},f="ContractList",De=K({name:f,__name:"related-contract-dialog",props:C({processInstanceId:{type:String,default:""},preApplyKeyword:{type:String,default:""},rowKey:{type:String,default:"processInstanceId"}},{modelValue:{},modelModifiers:{}}),emits:C(["success"],["update:modelValue"]),setup(x,{emit:R}){const L=x,I=R,y=B(x,"modelValue");d(!1);const r=d();d();const T=d({}),M=d(0),P=d([]),$=(l,s)=>{const o=Y[l];if(!o)return console.error(`未找到名为 ${l} 的字典`),"";const c=o.find(h=>h.value==s);return c?c.label:""},k=d({code:f,beforeRequest:l=>{if(l.contractTypeEnumList=["FRAMEWORK_CONTRACT"],l.contractStatusEnumList=["IN_FULFILLMENT"],l.businessTypeList){const s=[];return l.businessTypeList.forEach(o=>{s.push(o[o.length-1])}),{...l,businessTypeList:s}}},requestFunction:J,afterRequest:(l,s)=>{P.value=l,M.value=s},pageSize:20,searchProps:{code:`${f}Search`,options:[N({label:"合同编号",prop:"code"}),N({label:"合同名称",prop:"name"}),{formItemProps:{prop:"businessTypeList",label:"业务类型"},inputName:"YmCascader",inputProps:{clearable:!0,placeholder:"请选择业务类型",multiple:!0,filterable:!0,checkStrictly:!0}},V({label:"供应商",prop:"partyCodeList",multiple:!0,searchMethod:G}),V({label:"机构名称",prop:"orgCodeList",multiple:!0,searchMethod:H}),U({label:"合同金额",prop:"",sf:"startAmount",ef:"endAmount"}),S({label:"合同创建时间",prop:"",sf:"startCreateTime",ef:"endCreateTime"}),S({label:"合同有效期",prop:"",sf:"startDate",ef:"endDate"}),W({label:"归档",prop:"archived",code:"archived_status"})]},tableProps:{code:`${f}Table`,showRadio:!0,rowKey:L.rowKey,autoTable:!1,height:400,columns:[{label:"合同名称｜合同编号｜合同金额",prop:"amount",slot:"amount",minWidth:260},{label:"业务类型｜合同类型",prop:"type",slot:"type",minWidth:160},{label:"人员｜签约方信息",prop:"contractPartyList",slot:"contractPartyList",minWidth:240},{label:"时间信息",prop:"time",slot:"time",width:200},{label:"金额信息",prop:"price",slot:"price",minWidth:200}]}}),A=async l=>{if(!r.value){Q.error("请选择合同"),l.value=!1;return}const s=P.value.find(o=>o[L.rowKey]===r.value);I("success",{...s}),l.value=!1,y.value=!1};return(l,s)=>{const o=u("el-tooltip"),c=u("el-tag"),h=u("complex-page"),q=u("complex-dialog");return m(),D(q,{modelValue:y.value,"onUpdate:modelValue":s[2]||(s[2]=t=>y.value=t),width:"1200px",title:"选择合同",onSubmit:A},{default:i(()=>[g(h,O({ref:"contractListRef",searchData:T.value,"onUpdate:searchData":s[0]||(s[0]=t=>T.value=t),"radio-value":r.value,"onUpdate:radioValue":s[1]||(s[1]=t=>r.value=t)},k.value),{amount:i(({row:t,$index:p})=>[e("div",X,[e("div",Z,[g(o,{class:"box-item",effect:"dark",content:t.name,placement:"top"},{default:i(()=>[e("span",ee,a(t.name),1)]),_:2},1032,["content"])]),e("div",se,a(t.code),1),e("div",te,[e("div",ae,a(n(v)(t.amount)),1)])])]),type:i(({row:t,$index:p})=>[e("div",le,[e("div",null,a(t.businessTypeFirstName)+" - "+a(t.businessTypeSecondName),1),e("div",oe,[g(c,{effect:"plain",type:"info",style:{color:"#1d2129"}},{default:i(()=>[F(a($("contract_type",t.type)),1)]),_:2},1024),t.changed?(m(),D(c,{key:0,style:{"margin-left":"4px",color:"#ff2a2a"},size:"small",type:"danger"},{default:i(()=>s[3]||(s[3]=[F("变更")])),_:1,__:[3]})):w("",!0)])])]),contractPartyList:i(({row:t,$index:p})=>[e("div",ie,[e("div",ne,[s[4]||(s[4]=e("div",{class:"desc-label"},"创建人：",-1)),e("div",de,a(t.createUserName),1)]),(m(!0),E(z,null,j(t.contractPartyList,b=>(m(),E("div",{class:"desc-item",key:b.id},[e("div",ce,a(b.partyTypeName)+"方：",1),e("div",re,a(b.partyName),1)]))),128))])]),time:i(({row:t,$index:p})=>[e("div",pe,[e("div",ue,[s[5]||(s[5]=e("div",{class:"desc-label"},"有效时间起：",-1)),e("div",me,a(n(_)(t.startDate)),1)]),e("div",ve,[s[6]||(s[6]=e("div",{class:"desc-label"},"有效时间止：",-1)),e("div",_e,a(n(_)(t.endDate)),1)]),e("div",fe,[s[7]||(s[7]=e("div",{class:"desc-label"},"创建时间：",-1)),e("div",ye,a(n(_)(t.createTime)),1)]),e("div",he,[s[8]||(s[8]=e("div",{class:"desc-label"},"签订时间：",-1)),e("div",be,a(n(_)(t.signDate)),1)])])]),price:i(({row:t,$index:p})=>[e("div",ge,[e("div",xe,[s[9]||(s[9]=e("div",{class:"desc-label"},"总金额：",-1)),e("div",Le,a(n(v)(t.amount)),1)]),e("div",Te,[s[10]||(s[10]=e("div",{class:"desc-label"},"已付金额：",-1)),e("div",Pe,a(n(v)(t.amountFinish)),1)]),e("div",Ce,[s[11]||(s[11]=e("div",{class:"desc-label"},"在途金额：",-1)),e("div",Ne,a(n(v)(t.amountApply)),1)])])]),_:1},16,["searchData","radio-value"])]),_:1},8,["modelValue"])}}});export{De as default};
