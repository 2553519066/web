import{d as W,ap as L,aq as X,T as _,ar as Y,r as T,o as Z,cf as ee,be as te,h as n,j as k,k as c,w as a,A as s,v as r,q as d,y as p,F as C,z as h,t as S,dQ as I,L as oe,cd as le,Q as se}from"./index-7XFzyDag.js";import{a as ae,u as ne}from"./index-C9UdkEp8.js";const re={class:"item-box"},ue={class:"item-single",key:"orgCode"},ce={class:"item-single-name"},de={class:"item-box"},pe={class:"item-single",key:"costTypeCode"},ie={class:"item-single-name"},me=W({__name:"form-dialog",props:L({initData:{type:Object,default:()=>({})}},{modelValue:{},modelModifiers:{}}),emits:L(["success"],["update:modelValue"]),setup(O,{emit:w}){const f=O,D=w,g=X(O,"modelValue"),v=_(()=>!f.initData.id),F=_(()=>v.value?"新增履约流程":"编辑履约流程"),{formData:o,formRef:q,requestSave:B}=Y(f,{typeLabel:"银行信息",convert(e){return e}}),M={processId:[{required:!0,message:"请选择履约流程",trigger:"blur"}],orgVOS:[{required:!0,message:"请选择机构",trigger:["blur","change"]}],costTypeVOS:[{required:!0,message:"请选择费用名称",trigger:["blur","change"]}]};T([{value:o.value.parentId,label:o.value.parentBankName}]),Z(()=>{R(),j()});const i=_({get(){return o.value.orgVOS.map(e=>e.orgCode)},set(e){o.value.orgVOS=e&&e.map(t=>({orgCode:t,orgName:y.value.find(u=>u.value===t).label}))}}),m=_({get(){return o.value.costTypeVOS.map(e=>e.costTypeCode)},set(e){o.value.costTypeVOS=e&&e.map(t=>({costTypeCode:t,costTypeName:V.value.find(u=>u.feeCode===t).typeName}))}}),y=T([]),R=()=>{ee({}).then(e=>{y.value=e})},V=T([]),j=()=>{te().then(e=>{V.value=e})},A=e=>{B(v.value?ae:ne,t=>v.value?{processId:o.value.processId,orgList:o.value.orgVOS,costTypeList:o.value.costTypeVOS}:{id:f.initData.id,processId:o.value.processId,orgList:o.value.orgVOS,costTypeList:o.value.costTypeVOS}).then(t=>{oe.success("保存成功"),D("success",t),e.value=!1,g.value=!1}).catch(()=>{e.value=!1})},E=e=>{i.value=i.value.filter(t=>t!==e.orgCode)},U=e=>{m.value=m.value.filter(t=>t!==e.costTypeCode)},z=e=>le({processName:e,configProcessesType:"CONTRACT_PERFORMANCE"}).then(t=>t.map(u=>({label:u.processName,value:u.id})));return(e,t)=>{const u=n("fs-select"),b=n("el-form-item"),N=n("el-icon"),x=n("el-col"),P=n("el-option"),Q=n("el-select"),$=n("el-row"),G=n("form-select-v2"),H=n("el-form"),J=n("complex-dialog");return c(),k(J,{modelValue:g.value,"onUpdate:modelValue":t[3]||(t[3]=l=>g.value=l),width:"1200px",title:F.value,onSubmit:A},{default:a(()=>[s(H,{ref_key:"formRef",ref:q,class:"radius-box",model:r(o),"label-width":"130px",rules:M,style:{padding:"12px"}},{default:a(()=>[s($,{gutter:24},{default:a(()=>[s(x,{span:12},{default:a(()=>[s(b,{label:"机构名称",prop:"orgVOS"},{default:a(()=>[s(u,{modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=l=>i.value=l),options:y.value,"show-value":"",virtualized:"",multiple:"",filterable:"","collapse-tags":"","collapse-tags-tooltip":""},null,8,["modelValue","options"])]),_:1}),d("div",re,[(c(!0),p(C,null,h(r(o).orgVOS,l=>(c(),p("div",ue,[d("span",ce,S(l.orgName),1),s(N,{class:"icon-box",onClick:K=>E(l)},{default:a(()=>[s(r(I))]),_:2},1032,["onClick"])]))),128))])]),_:1}),s(x,{span:12},{default:a(()=>[s(b,{label:"费用名称",prop:"costTypeVOS"},{default:a(()=>[s(Q,{modelValue:m.value,"onUpdate:modelValue":t[1]||(t[1]=l=>m.value=l),multiple:"",filterable:"","collapse-tags":"","collapse-tags-tooltip":"",placeholder:"搜索费用名称",style:{width:"400px"}},{default:a(()=>[(c(!0),p(C,null,h(V.value,l=>(c(),k(P,{key:l.feeCode,label:l.typeName,value:l.feeCode},{default:a(()=>[d("span",null,S(l.typeName),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),d("div",de,[(c(!0),p(C,null,h(r(o).costTypeVOS,l=>(c(),p("div",pe,[d("span",ie,S(l.costTypeName),1),s(N,{class:"icon-box",onClick:K=>U(l)},{default:a(()=>[s(r(I))]),_:2},1032,["onClick"])]))),128))])]),_:1})]),_:1}),s(b,{label:"流程",prop:"processId"},{default:a(()=>[s(G,{modelValue:r(o).processId,"onUpdate:modelValue":t[2]||(t[2]=l=>r(o).processId=l),"request-method":z,"echo-options":[{value:r(o).processId,label:r(o).processName}],placeholder:"请选择流程"},null,8,["modelValue","echo-options"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),ge=se(me,[["__scopeId","data-v-538d4861"]]);export{ge as default};
