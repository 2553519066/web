import{u as Y,_ as Z,C as ee,d as te}from"./detail-log-DumklOgE.js";import{d as ae,r as i,S as oe,aH as se,U as le,V as ne,h as n,i as ce,m as ie,y as d,k as c,q as t,B as u,A as o,F as f,p as v,t as p,w as l,j as g,z as re,D as ue,v as k,L as q,Q as de}from"./index-Cyvvb__l.js";import{c as D}from"./add-order-yZp2642q.js";import"./index-i7ixLZTb.js";import"./error-Cq9Fpw4b.js";/* empty css                                                                          */import"./contract-order-void.vue_vue_type_script_setup_true_lang-DIINNztQ.js";const ve={class:"contract-details"},pe={class:"contract-details-top"},_e={class:"contract-details-top-content"},me={class:"contract-details-top-content-tags"},fe={class:"grid-2-2"},ye={class:"flex-center"},ge={class:"price-box"},he={class:"flex-center"},Ce={class:"flex-center"},we={class:"flex-center"},xe={class:"status-box"},ke={key:0,style:{display:"flex","align-items":"center"}},De={class:"contract-details-top-right"},be={class:"contract-details-top-right-content"},Ne={class:"contract-details-middle"},Ve={class:"details-basic"},Ie={class:"details-basic"},Le=ae({name:"ContractDetails",__name:"preview",setup(Ee){var A;const b=i(null),N=i(null),w=oe(),z=i(w.query.processInstanceNo),h=i(w.query.contractCode),_=i((A=w.query)==null?void 0:A.contractVersion);i(),se();const{copy:P,isSupported:R}=Y();i(0);const V=s=>{const a=s==="copyTitle"?b.value:N.value;if(!R.value){q.warning("请在https环境下使用");return}P(a.innerText),q.success(`复制成功：${a.innerText}`)},I=i("basic"),m=i([]),M=s=>{_.value=s,E()},y=i(!0);le({contractCode:h.value}).then(s=>{console.log(s,h.value),m.value=s,m.value&&m.value.length>0?(_.value||(_.value=m.value[m.value.length-1]),E()):y.value=!1}).catch(()=>{y.value=!1});const L=i({}),e=i(),E=()=>{y.value=!0,console.log(h.value,_.value),ne({contractCode:h.value,cVersion:_.value,processInstanceNo:z.value}).then(s=>{e.value=s,L.value.url=(s.controlInfo?JSON.parse(s.controlInfo):{}).url,L.value.name=`${s.name}.docx`}).finally(()=>{y.value=!1})},H=()=>{const s={CREATED:0,INVALID:3,IN_APPROVAL:1,CANCELLED:3,CHANGED_WAITE_APPROVAL:0,IN_FULFILLMENT:2,ENDED:3};if(e.value&&e.value.status)return s[e.value.status]+1};return(s,a)=>{var $,B;const T=n("DocumentCopy"),x=n("el-icon"),S=n("el-tag"),O=n("arrow-down"),U=n("el-button"),j=n("el-dropdown-item"),G=n("el-dropdown-menu"),J=n("el-dropdown"),Q=n("el-text"),C=n("el-step"),W=n("el-steps"),F=n("el-tab-pane"),K=n("el-tabs"),X=ce("loading");return ie((c(),d("div",ve,[t("div",pe,[a[7]||(a[7]=t("img",{class:"contract-details-top-img",src:Z,alt:""},null,-1)),t("div",_e,[t("div",{class:"contract-details-top-content-title flex-center",ref_key:"copyTitle",ref:b},[e.value&&e.value.name?(c(),d(f,{key:0},[v(p(e.value.name),1)],64)):u("",!0),o(x,{class:"copy-icon",onClick:a[0]||(a[0]=r=>V("copyTitle"))},{default:l(()=>[o(T)]),_:1}),t("div",me,[e.value&&e.value.archived?(c(),g(S,{key:0,style:{margin:"0 8px",color:"#1d2129","font-weight":"600"},type:"info",effect:"plain",size:"small"},{default:l(()=>[e.value&&e.value.archived?(c(),d(f,{key:0},[v(p(e.value.archived=="ARCHIVED"?"已归档":"未归档"),1)],64)):u("",!0)]),_:1})):u("",!0),e.value&&e.value.changed?(c(),g(S,{key:1,type:e.value&&e.value.changed=="1"?"warning":"danger",effect:"plain",size:"small"},{default:l(()=>[e.value&&e.value.changed||e.value.changed==0?(c(),d(f,{key:0},[v(p(e.value.changed=="1"?"变更":"未变更"),1)],64)):u("",!0)]),_:1},8,["type"])):u("",!0)])],512),t("div",fe,[t("div",ye,[a[3]||(a[3]=t("div",{class:"title-name"},"合同金额：",-1)),t("div",ge,[e.value&&e.value.amount?(c(),d(f,{key:0},[v(p(s.$format.thousandsFormatCurrency(e.value.amount)),1)],64)):u("",!0)])]),t("div",he,[a[4]||(a[4]=t("div",{class:"title-name"},"合同编号：",-1)),t("div",{ref_key:"copyNum",ref:N},[e.value&&e.value.code?(c(),d(f,{key:0},[v(p(e.value.code),1)],64)):u("",!0)],512),o(x,{class:"copy-icon",onClick:a[1]||(a[1]=r=>V("copyNum"))},{default:l(()=>[o(T)]),_:1})]),t("div",Ce,[a[5]||(a[5]=t("div",{class:"title-name"},"合同版本：",-1)),o(J,{style:{"margin-right":"20px"}},{dropdown:l(()=>[o(G,null,{default:l(()=>[(c(!0),d(f,null,re(m.value,r=>(c(),g(j,{onClick:Ae=>M(r),key:r},{default:l(()=>[v("版本"+p(r),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),default:l(()=>[o(U,{size:"small"},{default:l(()=>[v(" 版本"+p(_.value)+" ",1),o(x,{class:"el-icon--right"},{default:l(()=>[o(O)]),_:1})]),_:1})]),_:1})]),t("div",we,[a[6]||(a[6]=t("div",{class:"title-name"},"当前状态：",-1)),t("div",xe,[e.value&&e.value.status?(c(),d("div",ke,[t("div",{style:ue(`width: 8px; height: 8px; border-radius: 50%; background-color: var(--el-color-${($=k(D).get(e.value.status))==null?void 0:$.type}); margin-right: 4px`)},null,4),o(Q,{type:(B=k(D).get(e.value.status))==null?void 0:B.type},{default:l(()=>{var r;return[v(p((r=k(D).get(e.value.status))==null?void 0:r.name),1)]}),_:1},8,["type"])])):u("",!0)])])])]),t("div",De,[t("div",be,[o(W,{style:{width:"450px"},active:H(),"align-center":""},{default:l(()=>[o(C,{title:"起草/变更中"}),o(C,{title:"审批中"}),o(C,{title:"已生效"}),o(C,{title:"已终止/作废/撤销"})]),_:1},8,["active"])])])]),t("div",Ne,[o(K,{class:"fixed-height el-tabs_modify-skew bg-white",modelValue:I.value,"onUpdate:modelValue":a[2]||(a[2]=r=>I.value=r)},{default:l(()=>[o(F,{label:"基础信息",name:"basic"},{default:l(()=>[t("div",Ve,[e.value?(c(),g(ee,{key:0,detailData:e.value,isPreview:!0},null,8,["detailData"])):u("",!0)])]),_:1}),o(F,{label:"操作日志",name:"detailLog"},{default:l(()=>[t("div",Ie,[e.value?(c(),g(te,{key:0,detailData:e.value},null,8,["detailData"])):u("",!0)])]),_:1})]),_:1},8,["modelValue"])])])),[[X,y.value]])}}}),Pe=de(Le,[["__scopeId","data-v-97a53e72"]]);export{Pe as default};
