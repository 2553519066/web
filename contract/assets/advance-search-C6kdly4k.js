import{Q as x,y as k,k as i,aU as U,d as j,ap as O,dA as m,aq as Q,r as T,T as Z,a6 as H,h as u,j as g,w as p,A as s,F as J,z as K,q as I,al as X,E as B,dB as ee,p as w,v as oe,dC as te,dD as N,N as P}from"./index-Cyvvb__l.js";const le={},ae={width:"16px",height:"16px",viewBox:"0 0 16 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"};function ne(v,d){return i(),k("svg",ae,d[0]||(d[0]=[U('<title>切片</title><g id="财税通WEB" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="3.2手工开票借票申请框架" transform="translate(-1050.000000, -860.000000)"><g id="编组-3" transform="translate(224.000000, 633.000000)"><g id="下拉-Icon备份-15" transform="translate(826.000000, 227.000000)"><circle id="椭圆形" stroke="currentColor" cx="8" cy="8" r="6.5"></circle><path d="M8,4 C8.27614237,4 8.5,4.22385763 8.5,4.5 L8.5,7.499 L11.5,7.5 C11.7761424,7.5 12,7.72385763 12,8 C12,8.27614237 11.7761424,8.5 11.5,8.5 L8.5,8.499 L8.5,11.5 C8.5,11.7761424 8.27614237,12 8,12 C7.72385763,12 7.5,11.7761424 7.5,11.5 L7.499,8.499 L4.5,8.5 C4.22385763,8.5 4,8.27614237 4,8 C4,7.72385763 4.22385763,7.5 4.5,7.5 L7.5,7.499 L7.5,4.5 C7.5,4.22385763 7.72385763,4 8,4 Z" id="形状结合" fill="currentColor"></path></g></g></g></g>',2)]))}const se=x(le,[["render",ne]]),re={},ce={width:"16px",height:"16px",viewBox:"0 0 16 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"};function pe(v,d){return i(),k("svg",ce,d[0]||(d[0]=[U('<title>切片</title><g id="财税通WEB" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="3.2手工开票借票申请框架" transform="translate(-1012.000000, -860.000000)"><g id="编组-3" transform="translate(224.000000, 633.000000)"><g id="下拉-Icon备份-14" transform="translate(788.000000, 227.000000)"><circle id="椭圆形" stroke="currentColor" cx="8" cy="8" r="6.5"></circle><rect id="形状结合" fill="currentColor" x="4" y="7.5" width="8" height="1" rx="0.5"></rect></g></g></g></g>',2)]))}const ue=x(re,[["render",pe]]),de={class:"input-com",style:{width:"364px"}},ie={class:"dialog-foot"},me=j({name:"AdvanceSearch",__name:"advance-search",props:O({options:{default:()=>[]},data:{default:()=>[]}},{modelValue:{},modelModifiers:{}}),emits:O(["success"],["update:modelValue"]),setup(v,{emit:d}){const f=v,M=d,E=[{value:!0,label:"精确"}],F=[{value:!0,label:"精确"},{value:!1,label:"模糊"}],_={};f.options.forEach(t=>{_[t.formItemProps.prop]={...t,matchOptions:!t.dataType||t.dataType===m.STRING?F:E}});const h=Q(v,"modelValue"),b=T(),l=T([]),y=Z(()=>({operator:[{label:"AND",value:"and"},{label:"OR",value:"or"},{label:"NOT",value:"ne"}],fieldList:f.options.map(t=>({value:t.formItemProps.prop,label:t.formItemProps.label}))})),$=(t,{value:o,selected:e})=>{console.log(t,"ww"),t.value=null,t.com=_[o]},S=t=>{l.value.splice(t,1)},C=t=>{if(l.value.length==10)return N.warning("最多可以设置10条检索条件");let o=l.value.map(c=>c.column),e=y.value.fieldList.find(c=>o.indexOf(c.value)==-1);if(!e)return N.warning("没有要添加的字段");l.value.splice(t+1,0,{_id:P(),column:e.value,isAccurate:!0,operator:"and",com:_[e.value]})},D=()=>{let t=f.data||[];if(t&&t.length>0){let o=t.map(e=>{e={_id:P(),...e};let c=_[e.column];return e.com=c,e.valueType===m.RANGE&&(e[c.mapOption[0].prop]=e.startValue,e[c.mapOption[1].prop]=e.endValue,delete e.startValue,delete e.endValue),e.valueType===m.ARRAY&&(e.value=e.valueList,delete e.valueList),e});l.value=o}else l.value=[],C(0)},A=()=>{h.value=!1},z=()=>{l.value=[],C(0)},G=t=>{b.value.validate().then(()=>{M("success",l.value.map(o=>{let e={valueType:o.com.dataType,column:o.com.formItemProps.prop,isAccurate:o.isAccurate,operator:o.operator};return e.valueType===m.RANGE?(e.startValue=o[o.com.mapOption[0].prop],e.endValue=o[o.com.mapOption[1].prop]):e.valueType===m.ARRAY?e.valueList=o.value:e.value=o.value,e})),A(),t.done()}).catch(o=>{t.done()})};return H(()=>f.data,t=>{D()},{immediate:!0}),(t,o)=>{const e=u("FsSelect"),c=u("el-button"),V=u("el-space"),q=u("el-form"),W=u("el-icon"),L=u("el-text"),R=u("FsButton"),Y=u("complex-dialog");return i(),g(Y,{modelValue:h.value,"onUpdate:modelValue":o[0]||(o[0]=a=>h.value=a),title:"高级检索",width:"816px"},{footer:p(()=>[I("div",ie,[s(L,{class:"foot-tip"},{default:p(()=>[s(W,{size:"14"},{default:p(()=>[s(oe(te))]),_:1}),o[2]||(o[2]=w(" 最多可以设置10条检索条件 ")),s(L,{type:"primary",onClick:z,style:{"margin-left":"12px",cursor:"pointer"}},{default:p(()=>o[1]||(o[1]=[w("重置")])),_:1,__:[1]})]),_:1,__:[2]}),s(V,null,{default:p(()=>[s(R,{"show-loading":!1,onClick:A},{default:p(()=>o[3]||(o[3]=[w("取消")])),_:1,__:[3]}),s(R,{type:"primary",onClick:G},{default:p(()=>o[4]||(o[4]=[w("检索")])),_:1,__:[4]})]),_:1})])]),default:p(()=>[s(q,{ref_key:"formRef",ref:b,class:"radius-box",model:l.value},{default:p(()=>[(i(!0),k(J,null,K(l.value,(a,n)=>(i(),g(V,{class:"condition-row",size:6,key:a._id},{default:p(()=>[s(e,{modelValue:l.value[n].operator,"onUpdate:modelValue":r=>l.value[n].operator=r,options:y.value.operator,placeholder:"请选择",style:{width:"96px"}},null,8,["modelValue","onUpdate:modelValue","options"]),s(e,{modelValue:l.value[n].column,"onUpdate:modelValue":r=>l.value[n].column=r,options:y.value.fieldList,filterable:"",placeholder:"请选择",style:{width:"133px"},onChange:r=>$(a,r)},null,8,["modelValue","onUpdate:modelValue","options","onChange"]),I("div",de,[a.com.mapOption?(i(),g(ee,B({data:l.value[n],key:"propmap"+a._id+n+a.com.formItemProps.prop,option:a.com,clearable:""},{ref_for:!0},a.com.inputProps,{style:{width:"100%"}}),null,16,["data","option"])):(i(),g(X(a.com.inputName),B({key:"com"+a._id+n+a.com.formItemProps.prop,modelValue:l.value[n].value,"onUpdate:modelValue":r=>l.value[n].value=r,clearable:""},{ref_for:!0},a.com.inputProps,{style:{width:"100%"}}),null,16,["modelValue","onUpdate:modelValue"]))]),s(e,{modelValue:l.value[n].isAccurate,"onUpdate:modelValue":r=>l.value[n].isAccurate=r,options:a.com.matchOptions,style:{width:"88px"}},null,8,["modelValue","onUpdate:modelValue","options"]),s(c,{disabled:n===0&&l.value.length==1,icon:ue,onClick:r=>S(n),style:{color:"var(--el-color-danger)",width:"32px"}},null,8,["disabled","onClick"]),s(c,{icon:se,onClick:r=>C(n),style:{width:"32px"}},null,8,["onClick"])]),_:2},1024))),128))]),_:1},8,["model"])]),_:1},8,["modelValue"])}}}),fe=x(me,[["__scopeId","data-v-053d0be4"]]);export{fe as default};
