import{d as L,ap as V,a4 as M,r as p,aq as R,h as d,j as k,k as f,w as r,q as S,A as e,y as $,F as j,z as E,cQ as D,cR as F,cS as K,cT as Q,L as _,Q as z}from"./index-B-DYpXrm.js";const O={class:"form"},T=L({__name:"org-dialog",props:V({initData:{type:Object,default:()=>({})}},{modelValue:{},modelModifiers:{}}),emits:V(["success"],["update:modelValue"]),setup(N,{emit:v}){const l=M({status:"enable",supplierCode:"",supplierName:"",businessContactUser:"",email:"",businessContactPhone:"",postCode:"",vatNo:"",supplierAddress:"",openBankName:"",bankName:"",accountName:"",bankAccount:"",bankNetId:""}),g=p(null),C=v,i=p(!1),b=R(N,"modelValue"),c=p(!1),m=p([]),q=p({supplierName:[{required:!0,message:"请输入供应商名称",trigger:"blur"}],businessContactUser:[{required:!0,message:"请输入联系人",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"}],businessContactPhone:[{required:!0,message:"请输入电话",trigger:"blur"}],postCode:[{required:!0,message:"请输入邮编",trigger:"blur"}],vatNo:[{required:!0,message:"请输入税号",trigger:"blur"}],supplierAddress:[{required:!0,message:"请输入地址",trigger:"blur"}],subjectCode:[{required:!0,message:"请输入科目",trigger:"blur"},{pattern:/^([0-9]*)$/,message:"科目格式错误，请输入数字",trigger:"blur"}],bankName:[{required:!0,message:"请输入所属银行",trigger:"blur"}],openBankName:[{required:!0,message:"请输入开户行",trigger:"blur"}],bankAccountName:[{required:!0,message:"请输入开户名",trigger:"blur"}],bankAccount:[{required:!0,message:"请输入银行账号",trigger:"blur"},{pattern:/^([0-9]*)$/,message:"银行账号格式错误，请输入数字",trigger:"blur"}]}),U=async n=>{n?(c.value=!0,m.value=await D({topCount:10,searchKey:n})||[],c.value=!1):m.value=[]},B=async n=>{if(n){i.value=!0;let a="";m.value.forEach(t=>{t.bankName===n&&(l.bankNetId=t.id,a=t.parentId)});try{const t=await F({parentId:a});l.bankName=t.bankName,i.value=!1}catch{i.value=!1}}else l.openBankName=""},A=n=>{g.value.validate(async a=>{a?(n.value=!0,l.supplierCode||(l.supplierCode=await K({})),Q(l).then(t=>{C("success",l),_.success("新增供应商成功"),b.value=!1}).catch(t=>{console.error("新增供应商失败:",t),_.error("新增供应商失败")}).finally(()=>{n.value=!1})):n.value=!1})};return(n,a)=>{const t=d("el-input"),u=d("el-form-item"),s=d("el-col"),y=d("el-option"),w=d("el-select"),h=d("el-row"),x=d("el-form"),I=d("complex-dialog");return f(),k(I,{modelValue:b.value,"onUpdate:modelValue":a[12]||(a[12]=o=>b.value=o),width:"800px",title:"新增供应商",onSubmit:A},{default:r(()=>[S("div",O,[e(x,{ref_key:"formRef",ref:g,model:l,"label-width":"100px",rules:q.value},{default:r(()=>[e(h,{gutter:12},{default:r(()=>[e(s,{span:12},{default:r(()=>[e(u,{label:"供应商编码",prop:"supplierCode"},{default:r(()=>[e(t,{modelValue:l.supplierCode,"onUpdate:modelValue":a[0]||(a[0]=o=>l.supplierCode=o),placeholder:"请输入供应商编码"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:r(()=>[e(u,{required:"",label:"供应商名称",prop:"supplierName"},{default:r(()=>[e(t,{modelValue:l.supplierName,"onUpdate:modelValue":a[1]||(a[1]=o=>l.supplierName=o),placeholder:"请输入供应商名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:r(()=>[e(u,{required:"",label:"联系人",prop:"businessContactUser"},{default:r(()=>[e(t,{modelValue:l.businessContactUser,"onUpdate:modelValue":a[2]||(a[2]=o=>l.businessContactUser=o),placeholder:"请输入联系人"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:r(()=>[e(u,{required:"",label:"邮箱",prop:"email"},{default:r(()=>[e(t,{modelValue:l.email,"onUpdate:modelValue":a[3]||(a[3]=o=>l.email=o),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:r(()=>[e(u,{required:"",label:"电话",prop:"businessContactPhone"},{default:r(()=>[e(t,{modelValue:l.businessContactPhone,"onUpdate:modelValue":a[4]||(a[4]=o=>l.businessContactPhone=o),placeholder:"请输入电话"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:r(()=>[e(u,{required:"",label:"邮编",prop:"postCode"},{default:r(()=>[e(t,{modelValue:l.postCode,"onUpdate:modelValue":a[5]||(a[5]=o=>l.postCode=o),placeholder:"请输入邮编"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:r(()=>[e(u,{required:"",label:"税号",prop:"vatNo"},{default:r(()=>[e(t,{modelValue:l.vatNo,"onUpdate:modelValue":a[6]||(a[6]=o=>l.vatNo=o),placeholder:"请输入税号"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:r(()=>[e(u,{required:"",label:"地址",prop:"supplierAddress"},{default:r(()=>[e(t,{modelValue:l.supplierAddress,"onUpdate:modelValue":a[7]||(a[7]=o=>l.supplierAddress=o),placeholder:"请输入地址"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:r(()=>[e(u,{required:"",label:"开户支行",prop:"openBankName"},{default:r(()=>[e(w,{style:{width:"100%"},modelValue:l.openBankName,"onUpdate:modelValue":a[8]||(a[8]=o=>l.openBankName=o),filterable:"",remote:"","reserve-keyword":"",clearable:"",placeholder:"请选择开户支行","remote-method":U,loading:c.value,onChange:B},{default:r(()=>[(f(!0),$(j,null,E(m.value,(o,P)=>(f(),k(y,{key:"netBank"+P,label:`${o.bankName}[${o.id}]`,value:o.bankName},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),_:1})]),_:1}),e(s,{span:12},{default:r(()=>[e(u,{required:"",label:"开户大行",prop:"bankName"},{default:r(()=>[e(t,{disabled:"",modelValue:l.bankName,"onUpdate:modelValue":a[9]||(a[9]=o=>l.bankName=o),placeholder:"所属开户大行"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:r(()=>[e(u,{required:"",label:"开户名",prop:"bankAccountName"},{default:r(()=>[e(t,{modelValue:l.bankAccountName,"onUpdate:modelValue":a[10]||(a[10]=o=>l.bankAccountName=o),placeholder:"请输入开户名"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:r(()=>[e(u,{required:"",label:"银行账号",prop:"bankAccount"},{default:r(()=>[e(t,{modelValue:l.bankAccount,"onUpdate:modelValue":a[11]||(a[11]=o=>l.bankAccount=o),placeholder:"请输入银行账号"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])])]),_:1},8,["modelValue"])}}}),H=z(T,[["__scopeId","data-v-43a09b9e"]]);export{H as default};
