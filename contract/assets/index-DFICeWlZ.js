import{d,u as p,r as s,o as u,dt as f,du as l,c3 as v,c_ as w,y as h,k as m}from"./index-D9FXDxt4.js";const k=d({__name:"index",setup(_){const c=p(),e=s({appId:"",projectCode:"",platform:"feishu",code:""}),t=s("");return u(()=>{const a=c.currentRoute.value.query||{};if(a.error==="access_denied"){c.replace({name:"Login"});return}if(e.value.code=a.code,a.state){const o=f.getKeyValuePairsFromQueryString(a.state||"");e.value.appId=o.appId,e.value.projectCode=o.projectCode;const i=o.redirectUrl;!o.projectCode&&i&&(e.value.redirect=decodeURIComponent(i)),l(e.value).then(async n=>{if(t.value=n.split("token=")[1],t.value)if(o.projectCode||i){let r=n.split("?");r.length>2&&(n=r[0]+"?"+r.slice(1).join("&")),window.location.href=n}else window.location.href=window.location.origin+`/main?token=${t.value}`;else window.location.href=window.location.origin})}else e.value.appId=a.appId,e.value.projectCode="shared",l(e.value).then(async o=>{t.value=o.split("token=")[1],v.set(w,t.value),window.location.href=`${window.location.origin}/main/expense-share?token=${t.value}`})}),(a,o)=>(m(),h("div"))}});export{k as default};
