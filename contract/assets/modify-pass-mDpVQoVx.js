import{Q as g,h as u,y as h,k as p,A as o,w as n,j as c,B as F,p as y,r as v,cU as V,v as b,di as x}from"./index-B-DYpXrm.js";const k={props:{isFirst:{type:Boolean,default:!1}},data(){function t(a){let e=!0;return/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8}$/.test(a)||(e=!1),e}var s=(a,e,r)=>{t(e)?(this.ruleForm.checkPass!==""&&this.$refs.ruleForm.validateField("checkPass"),r()):r(new Error("新密码必须由8位,且由大写、小写、数字混合组成！"))},l=(a,e,r)=>{e===""?r(new Error("请再次输入密码")):e!==this.ruleForm.newPwd?r(new Error("两次输入密码不一致!")):r()};return{loading:!1,ruleForm:{newPwd:"",checkPass:"",oldPwd:""},rules:{newPwd:[{required:!0,validator:s,trigger:"blur"}],checkPass:[{required:!0,validator:l,trigger:"blur"}],oldPwd:[{required:!0,message:"请填写原密码",trigger:"blur"}]}}},computed:{},methods:{isValidPassword(t){return/^(?=.*[A-Z])(?=.*[a-z])(?=.*\d)[A-Za-z\d]{8}$/.test(t)},submitForm(t){this.$route.query,this.$refs[t].validate(s=>{if(s){if(this.ruleForm.newPwd===this.ruleForm.oldPwd)return this.$message.warning("新旧密码不能一样！"),!1;const{oldPwd:l,newPwd:a}=this.ruleForm;this.loading=!0,this.$emit("postHttp",{oldPassword:l,newPassword:a})}else return console.log("error submit!!"),!1})},successHandle(){this.$message.success("修改成功！"),this.loading=!1},resetForm(t){this.$refs[t].resetFields()}}},q={class:"modifyPass"};function A(t,s,l,a,e,r){const f=u("el-alert"),m=u("el-input"),i=u("el-form-item"),w=u("el-button"),_=u("el-form"),P=u("el-card");return p(),h("div",q,[o(P,{class:"box-card"},{default:n(()=>[l.isFirst?(p(),c(f,{key:0,title:"首次登录请修改密码！",center:"",closable:!1,type:"warning"})):F("",!0),o(_,{ref:"ruleForm",model:e.ruleForm,"status-icon":"",rules:e.rules,"label-width":"100px",class:"modifyPass-ruleForm"},{default:n(()=>[o(i,{label:"原密码",prop:"oldPwd"},{default:n(()=>[o(m,{modelValue:e.ruleForm.oldPwd,"onUpdate:modelValue":s[0]||(s[0]=d=>e.ruleForm.oldPwd=d),type:"password",autocomplete:"off","show-password":""},null,8,["modelValue"])]),_:1}),o(i,{label:"新密码",prop:"newPwd"},{default:n(()=>[o(m,{modelValue:e.ruleForm.newPwd,"onUpdate:modelValue":s[1]||(s[1]=d=>e.ruleForm.newPwd=d),type:"password",autocomplete:"off","show-password":""},null,8,["modelValue"])]),_:1}),o(i,{label:"确认新密码",prop:"checkPass"},{default:n(()=>[o(m,{modelValue:e.ruleForm.checkPass,"onUpdate:modelValue":s[2]||(s[2]=d=>e.ruleForm.checkPass=d),type:"password",autocomplete:"off","show-password":""},null,8,["modelValue"])]),_:1}),o(i,null,{default:n(()=>[o(w,{type:"primary",loading:e.loading,onClick:s[3]||(s[3]=d=>r.submitForm("ruleForm"))},{default:n(()=>s[4]||(s[4]=[y("确定修改")])),_:1,__:[4]},8,["loading"])]),_:1})]),_:1},8,["model","rules"])]),_:1})])}const B=g(k,[["render",A],["__scopeId","data-v-0c0222b4"]]),U={__name:"modify-pass",setup(t){const s=v(null),l=V(),a=e=>{x({email:l.userInfo.email,...e}).then(()=>{l.requestLogout(!1)})};return(e,r)=>(p(),c(b(B),{ref_key:"changePasswordPageRef",ref:s,onPostHttp:a},null,512))}};export{U as default};
