import{o as E}from"./index-D6Zz0KLB.js";import{x as P,z as B}from"./add-order-k94JB960.js";import{d as O,T as D,h as d,y as F,k as g,z as L,A as l,w as a,p as i,t as n,v as m,F as H,ap as j,aq as q,r as T,j as f,q as U,B as h,x as k,as as A,Q as z}from"./index-B0EZE7ii.js";import{v as G}from"./format-BBeBxyJ_.js";const Q=O({name:"ProcessShow",inheritAttrs:!1,__name:"process-show",props:{processNo:{type:String,default:""}},setup(b){const u=b,_=D(()=>(u.processNo||"").split(",").filter(e=>!!e));return(e,w)=>{const y=d("el-link");return g(!0),F(H,null,L(_.value,(I,s)=>(g(),F("div",{key:s},[l(y,{type:"primary",onClick:N=>m(E)({flowId:I})},{default:a(()=>[i(n(I),1)]),_:2},1032,["onClick"])]))),128)}}}),Y={style:{"background-color":"#fff",padding:"10px"}},K=O({__name:"form-dialogly",props:j({initData:{type:Object,default:()=>({})}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(b){const u=b,_=q(b,"modelValue"),e=T({}),w={NO:"否",MONTHLY:"每月",QUARTER:"每季度",YEAR:"每年"},y={CASH:"现金",ONLINE_BANKING:"网银",BILL_EXCHANGE:"汇票"};(()=>{u.initData&&Object.keys(u.initData).length>3?e.value=u.initData:P({id:u.initData.id}).then(o=>{e.value=Object.assign({},o||{},u.initData||{})})})();const s=T({PROMISE_FINISH:{list:[],loading:!1},IN_PROMISE:{list:[],loading:!1}}),N=async(o="")=>{let r=s.value[o];if(r.list.length>0||r.loading)return;s.value[o].loading=!0;const t=await B({contractId:u.initData.contractId,type:o,code:u.initData.code});s.value[o].loading=!1,s.value[o].list=t},$=D(()=>{const o=e.value.amount||0,r=e.value.amountFinish||0,t=e.value.amountApply||0,C=o-r-t;return Math.max(0,C)});return(o,r)=>{const t=d("el-descriptions-item"),C=d("fs-dict-label"),v=d("el-link"),p=d("el-table-column"),M=d("el-table"),S=d("el-popover"),R=d("el-descriptions"),x=d("complex-dialog");return g(),f(x,{modelValue:_.value,"onUpdate:modelValue":r[2]||(r[2]=c=>_.value=c),width:"1000px",title:"履约详情",hideConfirm:!b.initData.lvyue},{default:a(()=>[U("div",Y,[l(R,{column:3,border:""},{default:a(()=>[l(t,{label:"合同履约节点","label-align":"right",align:"center","label-class-name":"my-label","class-name":"my-content"},{default:a(()=>[i(n(e.value.name),1)]),_:1}),l(t,{label:"要求履约时间","label-align":"right",align:"center"},{default:a(()=>[i(n(m(k)(e.value.fulfillDate)),1)]),_:1}),l(t,{label:"履约完成时间","label-align":"right",align:"center"},{default:a(()=>[i(n(m(k)(e.value.fulfillmentPlainFinishTime)||"-"),1)]),_:1}),l(t,{label:"审批流程","label-align":"right",align:"center"},{default:a(()=>[i(n(e.value.processInstanceName||""),1)]),_:1}),l(t,{label:"收支类型","label-align":"right",align:"center"},{default:a(()=>[i(n(e.value.financeTypeName),1)]),_:1}),l(t,{label:e.value.financeType==="INCOME"?"收款含税金额(元)":"付款含税金额(元)","label-align":"right",align:"center"},{default:a(()=>[i(n(o.$format.thousandsFormatCurrency(e.value.amount)),1)]),_:1},8,["label"]),l(t,{label:"发票类型","label-align":"right",align:"center"},{default:a(()=>[i(n(e.value.invoiceTypeName),1)]),_:1}),l(t,{label:"税率","label-align":"right",align:"center"},{default:a(()=>[i(n(m(G)(e.value.taxRate)),1)]),_:1}),e.value.financeType==="INCOME"?(g(),f(t,{key:0,label:"付款公司","label-align":"right",align:"center"},{default:a(()=>[i(n(e.value.payPartyName),1)]),_:1})):(g(),f(t,{key:1,label:"收款公司","label-align":"right",align:"center"},{default:a(()=>[i(n(e.value.receivePartyName),1)]),_:1})),l(t,{label:"费用类型","label-align":"right",align:"center"},{default:a(()=>[i(n(e.value.costTypeName),1)]),_:1}),l(t,{label:"开户行","label-align":"right",align:"center"},{default:a(()=>[i(n(e.value.bankName),1)]),_:1}),l(t,{label:"账号名称","label-align":"right",align:"center"},{default:a(()=>[i(n(e.value.bankAccountName),1)]),_:1}),l(t,{label:"银行账号","label-align":"right",align:"center"},{default:a(()=>[i(n(e.value.bankAccountNumber),1)]),_:1}),l(t,{label:"银行支行","label-align":"right",align:"center"},{default:a(()=>[i(n(e.value.bankSubName),1)]),_:1}),l(t,{label:"成本中心","label-align":"right",align:"center"},{default:a(()=>[i(n(e.value.costCenterName)+n(e.value.costCenterCode?`[${e.value.costCenterCode}]`:""),1)]),_:1}),l(t,{label:"是否保证金","label-align":"right",align:"center"},{default:a(()=>[i(n(e.value.deposit===1?"是":"否"),1)]),_:1}),e.value.deposit===1?(g(),f(t,{key:2,label:"归还时间","label-align":"right",align:"center"},{default:a(()=>[i(n(m(k)(e.value.depositReturnDate)),1)]),_:1})):h("",!0),l(t,{label:"合同延续","label-align":"right",align:"center"},{default:a(()=>[i(n(w[e.value.autoExtend]),1)]),_:1}),l(t,{label:"履约状态","label-align":"right",align:"center"},{default:a(()=>[l(C,{value:e.value.fulfillStatus,code:"fulfill_status"},null,8,["value"])]),_:1}),l(t,{label:"履约单据","label-align":"right",align:"center"},{default:a(()=>[l(Q,{"process-no":e.value.processInstanceNo},null,8,["process-no"])]),_:1}),l(t,{label:"已付金额","label-align":"right",align:"center"},{default:a(()=>[l(S,{placement:"top",width:700,trigger:"click",onShow:r[0]||(r[0]=c=>N("PROMISE_FINISH"))},{reference:a(()=>[l(v,{type:"primary"},{default:a(()=>[i(n(o.$format.thousandsFormatCurrency(e.value.amountFinish)),1)]),_:1})]),default:a(()=>[l(M,{data:s.value.PROMISE_FINISH.list,border:"",loading:s.value.PROMISE_FINISH.loading,style:{width:"100%"}},{default:a(()=>[l(p,{"min-width":"160",prop:"flowEngineInstanceId",label:"费控单号"},{default:a(({row:c})=>[l(v,{type:"primary",onClick:V=>m(E)({flowId:c.flowEngineInstanceId})},{default:a(()=>[i(n(c.processInstanceNo),1)]),_:2},1032,["onClick"])]),_:1}),l(p,{"min-width":"90",prop:"createUserName",label:"履约人"}),l(p,{"min-width":"140",prop:"amount",label:"金额",formatter:m(A)},null,8,["formatter"]),l(p,{"min-width":"180",prop:"updateTime",label:"履约完成时间"})]),_:1},8,["data","loading"])]),_:1})]),_:1}),l(t,{label:"费控待确认金额","label-align":"right",align:"center"},{default:a(()=>[i(n(o.$format.thousandsFormatCurrency(e.value.waitAmount)),1)]),_:1}),l(t,{label:"在途金额","label-align":"right",align:"center"},{default:a(()=>[l(S,{placement:"top",width:700,trigger:"click",onShow:r[1]||(r[1]=c=>N("IN_PROMISE"))},{reference:a(()=>[l(v,{type:"primary"},{default:a(()=>[i(n(o.$format.thousandsFormatCurrency(e.value.amountApply)),1)]),_:1})]),default:a(()=>[l(M,{data:s.value.IN_PROMISE.list},{default:a(()=>[l(p,{"min-width":"160",prop:"flowEngineInstanceId",label:"费控单号"},{default:a(({row:c,$index:V})=>[l(v,{type:"primary",onClick:W=>m(E)({flowId:c.flowEngineInstanceId})},{default:a(()=>[i(n(c.processInstanceNo),1)]),_:2},1032,["onClick"])]),_:1}),l(p,{"min-width":"90",prop:"createUserName",label:"履约人"}),l(p,{"min-width":"140",prop:"amount",label:"金额",formatter:m(A)},null,8,["formatter"]),l(p,{"min-width":"180",prop:"updateTime",label:"申请时间"})]),_:1},8,["data"])]),_:1})]),_:1}),l(t,{label:"可申请金额","label-align":"right",align:"center"},{default:a(()=>[i(n(o.$format.thousandsFormatCurrency($.value)),1)]),_:1}),e.value.financeType!=="INCOME"?(g(),f(t,{key:3,label:"预留质保金","label-align":"right",align:"center"},{default:a(()=>[i(n(o.$format.thousandsFormatCurrency(e.value.preWarrantyAmount)),1)]),_:1})):h("",!0),e.value.financeType!=="INCOME"?(g(),f(t,{key:4,label:"费用日期","label-align":"right",align:"center"},{default:a(()=>[i(n(e.value.feeStartTime&&e.value.feeEndTime?`${e.value.feeStartTime.split(" ")[0]} ~ ${e.value.feeEndTime.split(" ")[0]}`:"-"),1)]),_:1})):h("",!0),e.value.financeType!=="INCOME"?(g(),f(t,{key:5,label:"支付方式","label-align":"right",align:"center"},{default:a(()=>[i(n(y[e.value.payMethod]||e.value.payMethod||"-"),1)]),_:1})):h("",!0),l(t,{label:"初始版本","label-align":"right",align:"center"},{default:a(()=>[i(n(e.value.initVersion===0?"是":"否"),1)]),_:1})]),_:1})])]),_:1},8,["modelValue","hideConfirm"])}}}),ae=z(K,[["__scopeId","data-v-4ce04ff3"]]);export{ae as default};
