import{bh as N,bi as k,d as q,r as l,h as p,j as b,k as _,w as i,q as A,A as B,B as F,v as j,ci as w,p as z,E as I,L as O}from"./index-D-MzvSrp.js";import{i as D,j as L}from"./index-rhfranM8.js";import{E as S}from"./index-CGFKNQp1.js";import"./index-BEPrue_N.js";import"./error-Cq9Fpw4b.js";const U=o=>N.post(`${k.passportAuth}/v1/api/admin/findPage`,o),$={style:{height:"546px"}},Q=q({__name:"UserForm",props:{modelValue:{type:Boolean,required:!0},group:{type:Object,required:!0}},emits:["update:modelValue","success"],setup(o,{emit:v}){const s=o,u=l(!1),c=v,x=e=>{u.value?c("success"):c("update:modelValue",e)},y=e=>{const{pageNum:t,pageSize:a,total:f,...r}=e;return r.state=1,new Promise((n,g)=>{U({page:t,rows:a,params:r}).then(({rows:h,total:E})=>{n({list:h,total:E})}).catch(g)})},m=l({}),d=()=>{!s.group||!s.group.id||D(s.group.id).then(e=>{let t={};e.forEach(a=>{t[a.userAccount]=!0}),m.value=t})},P=e=>{S.confirm("确定添加该用户到分组吗？","提示",{type:"warning"}).then(()=>{L({groupId:s.group.id,userAccount:e.email,userName:e.name}).then(()=>{O.success("添加成功"),u.value=!0,d()})})},C=l({searchOptions:[{formItemProps:{prop:"name",label:"用户姓名"},inputName:"ElInput",inputProps:{clearable:!0,placeholder:"请输入用户姓名"}},{formItemProps:{prop:"email",label:"账号"},inputName:"ElInput",inputProps:{clearable:!0,placeholder:"请输入账号"}}]}),V=l({tableHeight:null,tableColumns:[{label:"用户姓名",prop:"name",minWidth:140},{label:"账号",prop:"email",minWidth:100},{label:"操作",prop:"id",width:80,slot:"colOperation"}]});return d(),(e,t)=>{const a=p("el-button"),f=p("FsPageLayout"),r=p("FsCommonDialog");return _(),b(r,I({"model-value":o.modelValue,title:"添加分组成员",width:"1000px"},e.$attrs,{"onUpdate:modelValue":x,"hidden-footer":!0}),{default:i(()=>[A("div",$,[B(f,{ref:"pageLayoutRef","fix-col":3,"search-props":C.value,"table-props":V.value,"request-function":y,"init-load":!0,"in-dialog":!0,"default-size":10},{colOperation:i(({row:n,$index:g})=>[m.value[n.email]?F("",!0):(_(),b(a,{key:0,type:"primary",link:"",size:j(w).actionSize,onClick:h=>P(n)},{default:i(()=>t[0]||(t[0]=[z("添加")])),_:2,__:[0]},1032,["size","onClick"]))]),_:1},8,["search-props","table-props"])])]),_:1},16,["model-value"])}}});export{Q as default};
