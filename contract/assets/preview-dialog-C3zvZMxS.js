import{d as L,T as W,r as B,h,y as b,k as o,j as f,B as x,v as p,dv as H,F as D,z,Q as T,ap as V,aq as M,aa as K,a9 as d,A as k,q as A,w as s,t as N,dw as Q,dk as F,dl as O,l as U,E,dx as X,cs as Y,ch as Z,D as J,aZ as G,aX as ee,dy as te,dz as le,aY as ae,ax as oe,b$ as ne}from"./index-CeQ2E0rp.js";import{O as se}from"./onlyoffice-TnC2VFlV.js";import{I as ie}from"./icon-download-RQDd_xc9.js";const re={class:"image-preview"},de=L({name:"AttachmentImagePreview",__name:"image",props:{data:{}},setup(_){const w=_,t=W(()=>[w.data.url]),a=B(!1),v=B(0),$=c=>{v.value=c,a.value=!0},u=()=>{a.value=!1};return(c,e)=>{const P=h("el-image");return o(),b("div",re,[a.value?(o(),f(p(H),{key:0,teleported:!0,"url-list":t.value,onClose:u,"initial-index":v.value},null,8,["url-list","initial-index"])):x("",!0),(o(!0),b(D,null,z(t.value,(g,y)=>(o(),f(P,{src:g,key:g,onClick:m=>$(y)},null,8,["src","onClick"]))),128))])}}}),ue=T(de,[["__scopeId","data-v-ca5ba576"]]),ce={class:"name-list"},me=["onClick"],pe={class:"name-text"},ve=L({name:"AttachmentNameList",__name:"name-list",props:V({list:{},downloadFun:{type:Function}},{active:{default:{}},activeModifiers:{}}),emits:V(["download","item-click"],["update:active"]),setup(_,{emit:w}){const t=_,a=w,v=M(_,"active"),$=c=>{a("item-click",c)},u=c=>{t.downloadFun?t.downloadFun(c):a("download",c)};return(c,e)=>{const P=h("Paperclip"),g=h("el-icon");return o(),b("ul",ce,[(o(!0),b(D,null,z(c.list,(y,m)=>(o(),b("li",{class:K(["name-item",v.value.url==y.url?"active":""]),key:m,onClick:i=>$(y)},[d(c.$slots,"item",{item:y},()=>[k(g,{class:"type-icon"},{default:s(()=>[k(P)]),_:1}),A("span",pe,N(y.name),1),y.downloading?(o(),f(g,{key:0,style:{"font-size":"16px",animation:"loading-rotate 1.5s linear infinite"}},{default:s(()=>[k(p(Q))]),_:1})):(o(),f(ie,{key:1,class:"download-icon",onClick:i=>u(y)},null,8,["onClick"]))],!0),d(c.$slots,"itemExtra",{item:y},void 0,!0)],10,me))),128))])}}}),fe=T(ve,[["__scopeId","data-v-a0aa53e1"]]),_e=L({name:"OnlyofficePreviewWrap",inheritAttrs:!1,__name:"onlyoffice-wrap",setup(_){const w=h("OutOnlyofficePreview"),t=w=="OutOnlyofficePreview"?se:w;return(a,v)=>(o(),f(p(t),F(O(a.$attrs)),null,16))}}),we=L({name:"AttachmentGroup",inheritAttrs:!1,__name:"group",props:V({groupList:{default:()=>[]},downloadFun:{}},{active:{default:{}},activeModifiers:{}}),emits:V(["item-click","download"],["update:active"]),setup(_,{emit:w}){const t=_,a=w,v=B(t.groupList.map(e=>e.name)),$=M(_,"active"),u=e=>{a("item-click",e)},c=e=>{a("download",e)};return(e,P)=>{const g=h("AttachmentGroup"),y=h("el-collapse-item"),m=h("el-collapse");return o(),f(m,{class:"collapse-box",modelValue:v.value,"onUpdate:modelValue":P[0]||(P[0]=i=>v.value=i)},{default:s(()=>[(o(!0),b(D,null,z(e.groupList,(i,n)=>(o(),f(y,{title:i.name,name:i.name,key:i.name},U({default:s(()=>[d(e.$slots,"list",{data:i},()=>[i.list&&i.list.length>0?(o(),f(fe,{key:0,list:i.list,active:$.value,style:{padding:"6px 10px"},onItemClick:u,onDownload:c,"download-fun":e.downloadFun},U({_:2},[e.$slots.item?{name:"item",fn:s(l=>[d(e.$slots,"item",E({ref_for:!0},l),void 0,!0)]),key:"0"}:void 0,e.$slots.itemExtra?{name:"itemExtra",fn:s(l=>[d(e.$slots,"itemExtra",E({ref_for:!0},l),void 0,!0)]),key:"1"}:void 0]),1032,["list","active","download-fun"])):x("",!0)],!0),i.groupList&&i.groupList.length>0?(o(),f(g,{key:0,active:$.value,"group-list":i.groupList,onItemClick:u,"download-fun":e.downloadFun,onDownload:c},U({_:2},[e.$slots.title?{name:"title",fn:s(l=>[d(e.$slots,"title",E({ref_for:!0},l),void 0,!0)]),key:"0"}:void 0,e.$slots.item?{name:"item",fn:s(l=>[d(e.$slots,"item",E({ref_for:!0},l),void 0,!0)]),key:"1"}:void 0,e.$slots.itemExtra?{name:"itemExtra",fn:s(l=>[d(e.$slots,"itemExtra",E({ref_for:!0},l),void 0,!0)]),key:"2"}:void 0]),1032,["active","group-list","download-fun"])):x("",!0)]),_:2},[e.$slots.title?{name:"title",fn:s(()=>[d(e.$slots,"title",{data:i},void 0,!0)]),key:"0"}:void 0]),1032,["title","name"]))),128))]),_:3},8,["modelValue"])}}}),ye=T(we,[["__scopeId","data-v-e1eb279c"]]),ke={class:"radius-box attachment-preview"},he={class:"preview-box"},$e={class:"preview-content"},ge=L({name:"ComplextPreview",__name:"index",props:{list:{default:()=>[]},current:{default:0},listWidth:{default:"300px"},downloadFun:{},urlConvert:{},kkBase:{},onlyofficeBase:{},enableOnlyoffice:{type:Boolean}},emits:["download"],setup(_,{emit:w}){const t=_,a=w,v=n=>{if(!n)return[];let l=[];return n.forEach(C=>{l.push(...C.list||[]),C.groupList&&l.push(...v(C.groupList))}),l},$=B([]),u=B([]),c=()=>{let l=t.list[0]&&(t.list[0].list||t.list[0].groupList)?t.list:[{name:"附件信息",list:t.list}];l=le(l);let C=v(l);C.forEach(r=>{!r.url&&(r.fileUrl||r.filePath)&&(r.url=r.fileUrl||r.filePath),r._oldUrl=r.url,r.url&&(r.attachmentType=ae(r.url),r.url=t.urlConvert?t.urlConvert(r,r.attachmentType):r.url)}),$.value=l,u.value=C,e.value=t.current},{currentIndex:e,onPrev:P,onNext:g,onActiveItem:y}=X({list:u,initIndex:Y(t,"current")}),m=W(()=>u.value[e.value]),i=n=>{let l={...n};l.url=l._oldUrl||l.url,t.downloadFun?t.downloadFun(l):a("download",l)};return Z(()=>{t.list&&c()}),(n,l)=>{const C=h("el-empty"),r=h("el-space"),j=h("ArrowLeft"),R=h("el-icon"),S=h("el-button"),q=h("ArrowRight");return o(),b("div",ke,[u.value.length>0?(o(),b(D,{key:0},[A("div",{class:"list-box",style:J(`width: ${n.listWidth};`)},[d(n.$slots,"listBefore",{},void 0,!0),k(ye,{"group-list":$.value,active:m.value,onItemClick:l[0]||(l[0]=I=>p(y)(I)),"download-fun":n.downloadFun,onDownload:i},U({_:2},[n.$slots.listTitle?{name:"title",fn:s(I=>[d(n.$slots,"listTitle",F(O(I)),void 0,!0)]),key:"0"}:void 0,n.$slots.listItem?{name:"item",fn:s(I=>[d(n.$slots,"listItem",F(O(I)),void 0,!0)]),key:"1"}:void 0,n.$slots.listItemExtra?{name:"itemExtra",fn:s(I=>[d(n.$slots,"listItemExtra",F(O(I)),void 0,!0)]),key:"2"}:void 0,n.$slots.list?{name:"list",fn:s(I=>[d(n.$slots,"list",F(O(I)),void 0,!0)]),key:"3"}:void 0]),1032,["group-list","active","download-fun"])],4),A("div",he,[A("div",$e,[d(n.$slots,"previewItem",{data:m.value},()=>[m.value.attachmentType===p(G).IMAGE?d(n.$slots,"image",{key:0,data:m.value},()=>[k(ue,{data:m.value},null,8,["data"])],!0):m.value.attachmentType===p(G).FILE||m.value.attachmentType===p(G).VIDEO?d(n.$slots,"file",{key:1,data:m.value},()=>[t.enableOnlyoffice&&p(ee)(m.value.url)?(o(),f(_e,{key:0,"onlyoffice-base":t.onlyofficeBase,data:m.value},null,8,["onlyoffice-base","data"])):(o(),f(te,{key:1,"kk-base":t.kkBase,data:m.value},null,8,["kk-base","data"]))],!0):(o(),f(C,{key:2,description:"暂不支持"}))],!0)]),k(r,{class:"tip-content",size:12},{default:s(()=>[A("span",null,N(p(e)+1)+" / "+N(u.value.length),1)]),_:1}),u.value.length>1?(o(),b(D,{key:0},[k(S,{class:"prev-btn",type:"info",disabled:u.value.length==0||p(e)==0,onClick:p(P)},{default:s(()=>[k(R,null,{default:s(()=>[k(j)]),_:1})]),_:1},8,["disabled","onClick"]),k(S,{class:"next-btn",type:"info",disabled:u.value.length==0||p(e)+1==u.value.length,onClick:p(g)},{default:s(()=>[k(R,null,{default:s(()=>[k(q)]),_:1})]),_:1},8,["disabled","onClick"])],64)):x("",!0)])],64)):(o(),f(C,{key:1,description:"无预览文件"}))])}}}),Ce=T(ge,[["__scopeId","data-v-2c7d75f2"]]),Ie={class:"preview-body"},be=L({name:"ComplexPreviewDialog",inheritAttrs:!1,__name:"preview-dialog",props:V({dialogProps:{type:Object,default:()=>({})}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:["update:modelValue"],setup(_){const w=M(_,"modelValue"),t=a=>{a.downloading=!0,ne(a.fileUrl||a.url,a.fileName||a.name).then(()=>{a.downloading=!1}).catch(()=>{a.downloading=!1})};return(a,v)=>(o(),f(p(oe),E({modelValue:w.value,"onUpdate:modelValue":v[0]||(v[0]=$=>w.value=$),top:"20px",width:"auto",title:"文件预览","modal-class":"file-preview-dialog","hide-foot":"",center:""},_.dialogProps),{default:s(()=>[A("div",Ie,[k(p(Ce),E(a.$attrs,{"download-fun":t}),null,16)])]),_:1},16,["modelValue"]))}}),Le=T(be,[["__scopeId","data-v-c3ab5b6e"]]);export{Le as default};
