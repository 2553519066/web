const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/form-dialogcg-BafkUszJ.js","assets/index-B0EZE7ii.js","assets/index-CCn4OCkM.css","assets/todo-BWyVGkx8.js","assets/form-dialog-tYIoweV_.js"])))=>i.map(i=>d[i]);
import{d as J,u as Q,aH as Y,r as g,e as $,a as D,s as F,n as K,b as A,f as Z,g as w,T as ee,h as b,i as te,j as m,k as i,w as n,m as h,B as c,p as d,q as a,t as o,v,x,y as N,F as ae,z as se,A as S,E as oe,N as ne,G as E,H as z,I as U,L as ie,Q as le}from"./index-B0EZE7ii.js";import{L as re}from"./StorageCache-CXk3PELT.js";import{q as ce,u as de}from"./todo-BWyVGkx8.js";import{E as pe}from"./index-D3qEiLu-.js";import"./index-CKmZDc37.js";import"./error-Cq9Fpw4b.js";const me={style:{color:"#1d2129","font-size":"13px","margin-bottom":"5px"}},ue={style:{color:"#ff1616","font-size":"13px"}},ye={style:{color:"#1d2129","font-size":"13px","margin-bottom":"5px"}},fe={style:{color:"#ff1616","font-size":"13px","margin-top":"5px"}},_e={style:{color:"#1d2129","font-size":"13px","margin-bottom":"5px"}},he={style:{color:"#1d2129","font-size":"13px","margin-bottom":"5px"}},ge={style:{color:"#1d2129","font-size":"13px"}},ve={key:0,style:{color:"#1d2129","font-size":"13px","margin-bottom":"5px"}},be={style:{color:"#1d2129","font-size":"13px","margin-bottom":"5px"}},xe={style:{display:"inline-block",width:"55px","text-align":"right"}},Ce={class:"desc-list width-c5"},ke={class:"desc-item"},Te={class:"desc-value"},De={class:"desc-item"},Ne={class:"desc-value"},Ee={class:"desc-item"},Re={class:"desc-value"},Le={class:"desc-item"},Ie={class:"desc-value"},r="ContractTodo",Pe=J({name:r,__name:"index",setup($e){const O=Q(),V=Y(),u=g({edit:`${r}:edit`,del:`${r}:del`,archiving:`${r}:archiving`,read:`${r}:read`,change:`${r}:change`,copy:`${r}:copy`}),C=g(),R=g({}),L=g({code:r,requestFunction:ce,beforeRequest:s=>{if(s.ymProp){let t=[];s.ymProp.forEach(p=>{t.push(p[p.length-1])}),s.bussinessTypeIdList=[...t],console.log(s)}return s},pageSize:20,searchProps:{code:`${r}Search`,options:[$({label:"合同编号",prop:"contractCode"}),$({label:"合同名称",prop:"contractName"}),D({label:"合同类型",prop:"contractType",code:"contract_type"}),{formItemProps:{prop:"ymProp",label:"业务类型"},inputName:"YmCascader",inputProps:{clearable:!0,placeholder:"请选择业务类型",multiple:!0,filterable:!0,checkStrictly:!0}},D({label:"状态",prop:"status",code:"contract_status"}),F({label:"供应商",prop:"partyCodeList",multiple:!0,searchMethod:Z}),F({label:"机构名称",prop:"ourPartyCodeList",multiple:!0,searchMethod:w}),K({label:"合同金额",prop:"amount",sf:"startAmount",ef:"endAmount"}),A({label:"创建时间",prop:"createTime",sf:"createTimeStart",ef:"createTimeEnd"}),A({label:"有效时间",prop:"yxTime",sf:"startDate",ef:"endDate"}),D({label:"归档",prop:"archive",code:"archived_status"})]},tableProps:{code:`${r}Table`,showIndex:!0,showSelect:!0,autoTable:!1,columns:[{label:"合同名称｜合同编号｜合同金额",prop:"contractName",slot:"contractName",minWidth:300},{label:"业务类型 | 合同类型",slot:"type",minWidth:240},{label:"金额信息",slot:"amount",minWidth:200},{label:"人员｜签约方信息",slot:"personnel",minWidth:280},{label:"时间信息",slot:"timex",minWidth:180}]}});L.value.tableProps.columns.push({label:"操作",prop:"operate",fixed:"right",width:150,slot:"operate"});const k=g([]);ee(()=>({test:k.value.length==0}));const T=()=>{C.value.refresh()},I=()=>{C.value.search()},B=(s,t)=>{const p=ne();re.getInstance().setData(p,{cacheCode:p,...JSON.parse(s.todoInfo)}),E({name:"ContractCreate",params:{cacheCode:p}})},M=(s,t)=>{z({body:()=>U(()=>import("./form-dialogcg-BafkUszJ.js"),__vite__mapDeps([0,1,2,3])),bodyData:{initData:s||{}},isReject:!0}).then(()=>{s?T():I()})},q=s=>{O.push({name:"ContractDetails",params:{code:s.contractCode}})},W=s=>{let t={};s&&(t={id:s.id,contractId:s.contractId,contractName:s.contractName}),z({body:()=>U(()=>import("./form-dialog-tYIoweV_.js"),__vite__mapDeps([4,1,2,3])),bodyData:{initData:t||{}},isReject:!0}).then(()=>{s?T():I()}).catch(()=>{})},H=s=>{E({name:"ContractStorage",params:{id:s.id}})},j=s=>{pe.confirm("确认已读？","提示",{type:"warning"}).then(()=>{de({id:s.id}).then(()=>{ie.success("已读成功"),T()})})},X=s=>{E({name:"ContractEdit",params:{id:s.contractId}})};return(s,t)=>{const p=b("el-link"),P=b("el-tag"),y=b("FsButton"),G=b("complex-page"),f=te("per");return i(),m(G,oe({ref_key:"pageRef",ref:C,searchData:R.value,"onUpdate:searchData":t[0]||(t[0]=e=>R.value=e),"select-list":k.value,"onUpdate:selectList":t[1]||(t[1]=e=>k.value=e)},L.value),{contractName:n(({row:e,$index:_})=>[S(p,{underline:!1,style:{"font-size":"13px","margin-bottom":"5px"},type:"primary",onClick:l=>q(e)},{default:n(()=>[d(o(e.contractName),1)]),_:2},1032,["onClick"]),a("div",me,o(e.contractCode),1),a("div",ue,o(s.$format.thousandsFormatCurrency(e.totalAmount)),1)]),type:n(({row:e,$index:_})=>[a("div",ye,o(e.businessTypeName),1),a("div",fe,[e.contractType?(i(),m(P,{key:0,size:"small",color:"#fff",type:"info",style:{"margin-right":"12px"}},{default:n(()=>[d(o(v(V).valueToLabelSync(e.contractType,"contract_type")),1)]),_:2},1024)):c("",!0),S(P,{size:"small",type:e.todoType=="ARCHIVE"?"warning":e.todoType=="CONTRACT_EXPIRE"?"danger":e.todoType=="DRAFT"?"primary":"success",style:{"margin-right":"12px"}},{default:n(()=>[d(o(e.todoType=="ARCHIVE"?"归档":e.todoType=="CONTRACT_EXPIRE"?"合同到期":e.todoType=="DRAFT"?"草稿":"其他"),1)]),_:2},1032,["type"])])]),amount:n(({row:e,$index:_})=>[a("div",_e,[t[2]||(t[2]=a("span",{style:{display:"inline-block",width:"66px","text-align":"right"}},"总金额：",-1)),a("span",null,o(s.$format.thousandsFormatCurrency(e.totalAmount)),1)]),a("div",he,[t[3]||(t[3]=a("span",{style:{display:"inline-block",width:"66px","text-align":"right"}},"已付金额：",-1)),a("span",null,o(s.$format.thousandsFormatCurrency(e.amountFinish)),1)]),a("div",ge,[t[4]||(t[4]=a("span",{style:{display:"inline-block",width:"66px","text-align":"right"}},"在途金额：",-1)),a("span",null,o(s.$format.thousandsFormatCurrency(e.amountApply)),1)])]),personnel:n(({row:e,$index:_})=>[e.createUserName?(i(),N("div",ve,[t[5]||(t[5]=a("span",{style:{display:"inline-block",width:"55px","text-align":"right"}},"创建人：",-1)),a("span",null,o(e.createUserName),1)])):c("",!0),e.contractPartyList&&e.contractPartyList.length>0?(i(!0),N(ae,{key:1},se(e.contractPartyList,(l,Ae)=>(i(),N("div",be,[a("span",xe,o(l.partyTypeName)+"：",1),a("span",null,o(l.partyName),1)]))),256)):c("",!0)]),timex:n(({row:e,$index:_})=>[a("div",Ce,[a("div",ke,[t[6]||(t[6]=a("div",{class:"desc-label"},"有效时间起：",-1)),a("div",Te,o(v(x)(e.startDate)),1)]),a("div",De,[t[7]||(t[7]=a("div",{class:"desc-label"},"有效时间止：",-1)),a("div",Ne,o(v(x)(e.endDate)),1)]),a("div",Ee,[t[8]||(t[8]=a("div",{class:"desc-label"},"创建时间：",-1)),a("div",Re,o(v(x)(e.createTime)),1)]),a("div",Le,[t[9]||(t[9]=a("div",{class:"desc-label"},"签订时间：",-1)),a("div",Ie,o(v(x)(e.signDate)),1)])])]),operate:n(({row:e,$index:_})=>[e.archive=="NO_ARCHIVED"&&(e.contractStatus=="IN_FULFILLMENT"||e.contractStatus=="ENDED")?h((i(),m(y,{key:0,"show-loading":!1,link:"",type:"primary",onClick:l=>W(e)},{default:n(()=>t[10]||(t[10]=[d("归档")])),_:2,__:[10]},1032,["onClick"])),[[f,u.value.archiving]]):c("",!0),e.todoType=="DRAFT"?h((i(),m(y,{key:1,"show-loading":!1,link:"",type:"primary",onClick:l=>H(e)},{default:n(()=>t[11]||(t[11]=[d("编辑")])),_:2,__:[11]},1032,["onClick"])),[[f,u.value.edit]]):c("",!0),e.contractStatus=="IN_FULFILLMENT"&&e.status=="UNREAD"?h((i(),m(y,{key:2,"show-loading":!1,link:"",type:"primary",onClick:l=>j(e)},{default:n(()=>t[12]||(t[12]=[d("已读")])),_:2,__:[12]},1032,["onClick"])),[[f,u.value.read]]):c("",!0),e.contractStatus=="IN_FULFILLMENT"&&e.status=="UNREAD"?h((i(),m(y,{key:3,"show-loading":!1,link:"",type:"primary",onClick:l=>X(e)},{default:n(()=>t[13]||(t[13]=[d("变更")])),_:2,__:[13]},1032,["onClick"])),[[f,u.value.change]]):c("",!0),e.todoType=="DRAFT"?h((i(),m(y,{key:4,"show-loading":!1,link:"",type:"primary",onClick:l=>B(e,l)},{default:n(()=>t[14]||(t[14]=[d("复制")])),_:2,__:[14]},1032,["onClick"])),[[f,u.value.copy]]):c("",!0),e.todoType=="DRAFT"?h((i(),m(y,{key:5,"show-loading":!1,link:"",type:"primary",onClick:l=>M(e,_)},{default:n(()=>t[15]||(t[15]=[d("删除")])),_:2,__:[15]},1032,["onClick"])),[[f,u.value.del]]):c("",!0)]),_:1},16,["searchData","select-list"])}}}),Me=le(Pe,[["__scopeId","data-v-815550d7"]]);export{Me as default};
