import{d as Ce,ap as be,r as h,aq as Le,b2 as B,aS as ge,T as Ve,h as C,y as oe,k as m,A as f,w as r,F as Ae,z as $e,j as N,B as I,q as i,t as k,v as w,as as Me,b3 as ze,E as ke,aV as he,b4 as we,Q as Ne,N as Ue,a6 as Be,i as Ee,m as F,b5 as Pe,b6 as We,p,b7 as je,b8 as He,L as ae,b9 as Xe,ag as Ge,ba as Je,bb as Ke,bc as Ye,P as Re,bd as Qe,be as Ze,bf as et,bg as tt,u as at,aH as ot,e as _e,s as Te,b as nt,a as lt,l as st,D as ye,H as rt}from"./index-B-DYpXrm.js";import{f as it,i as ut,h as dt,q as ct,j as mt,k as pt,b as U,d as De,A as ve,p as ft,e as yt}from"./add-order-hE-kb25m.js";import{t as xe}from"./index-DTCKMPKS.js";import{_ as me}from"./contract-order-void.vue_vue_type_script_setup_true_lang-BtYW8LKp.js";const vt={class:"demo-collapse"},_t={key:0},bt={style:{"font-weight":"bold","font-size":"14px"}},gt={style:{"margin-left":"10px","font-size":"18px"}},ht={class:"w-full"},Ct=Ce({__name:"order-row-collapse",props:be({config:{type:Object,default:()=>({})},disabled:{type:Boolean,default:!1},secondTypeCode:{type:String,default:""},partyList:{type:Array,default:()=>[]},incomeConfig:{type:Object,default:()=>({})},expenditureConfig:{type:Object,default:()=>({})},rowConfig:{type:Object,default:()=>({})},targetInfo:{type:Object,default:()=>({})}},{modelValue:{default:()=>({orderLists:[]})},modelModifiers:{}}),emits:["update:modelValue"],setup(K,{expose:ue}){const y=K;h(!0);const A=Le(K,"modelValue");B.INCOME+"",B.EXPENDITURE+"";const j=h("create"),q=h(-1),W=h(!0),H={orderName:[{required:!0,message:"请输入订单名称"}],targetData:[{required:!0,message:"请添加商品信息",type:"array"}],quantity:[{required:!0,message:"请输入大于1的整数"}],contractListFulfillmentPlainParamList:[{type:"object",validator(P,_,b){if(_[B.INCOME].length==0&&_[B.EXPENDITURE].length==0)return b(new Error("请添加履约信息"));b()}}]},ne=P=>{const{column:_}=P;if(_.property&&_.property=="quantity")return"header-required"},X=P=>{},d=ge(),T=()=>d.value.validate(),G=h(["totalAmount"]);let Y=h(!1);const Q=P=>{const _=[];return P.columns.forEach((b,E)=>{var S;if(E===0)_[E]="";else if(G.value.includes(b.property)){let V=P.data.reduce((Z,s)=>he(Z,Number(s[b.property])||0),0);V=((S=b.relationData)==null?void 0:S.thousand)||!1?we(V,""):V,_[E]=`汇总：${V}元`}else _[E]=""}),_},le=Ve(()=>{const E=Y?40:0;return 40+5*40+E});return ue({validate:T}),(P,_)=>{const b=C("el-form-item"),E=C("el-row"),S=C("el-table-column"),V=C("el-table"),se=C("el-collapse-item"),Z=C("el-collapse");return m(),oe("div",vt,[f(Z,{modelValue:q.value,"onUpdate:modelValue":_[0]||(_[0]=s=>q.value=s),accordion:"",onChange:X},{default:r(()=>[(m(!0),oe(Ae,null,$e(A.value.orderLists,(s,t)=>(m(),N(se,{title:s.companyName,name:t,key:t},{default:r(()=>[q.value===t?(m(),oe("div",_t,[f(b,{label:"订单名称",prop:`orderLists.${t}.orderName`,required:["create"].includes(j.value),rules:H.orderName},{default:r(()=>[i("span",bt,k(s.orderName),1)]),_:2},1032,["prop","required","rules"]),f(E,{style:{"margin-bottom":"14px","align-items":"center"}},{default:r(()=>[_[1]||(_[1]=i("span",{style:{"font-size":"14px"}},"订单金额",-1)),i("span",gt,k(s.totalAmountText)+"元",1)]),_:2,__:[1]},1024),f(b,{"label-position":"top",label:"商品信息",prop:`orderLists.${t}.targetData`,required:["create"].includes(j.value),rules:H.targetData},{default:r(()=>[f(V,{"row-key":"_id",data:s.targetData,border:"","max-height":le.value,style:{width:"100%"},size:"small","show-summary":!0,"summary-method":Q,"scrollbar-always-on":"","header-cell-class-name":ne},{default:r(()=>[(m(!0),oe(Ae,null,$e(K.targetInfo.targetColumns,(v,D)=>(m(),N(S,{key:v.code,label:v.label,"min-width":160,prop:v.code},null,8,["label","prop"]))),128)),f(S,{label:"数量",prop:"quantity"},{default:r(({row:v,$index:D})=>[f(b,{class:"table-form-item",prop:`orderLists.${t}.targetData.${D}.quantity`,rules:H.quantity},{default:r(()=>[i("span",null,k(v.quantity),1)]),_:2},1032,["prop","rules"])]),_:2},1024),W.value?(m(),N(S,{key:0,label:"总金额",prop:"totalAmount","min-width":200,formatter:w(Me)},null,8,["formatter"])):I("",!0)]),_:2},1032,["data","max-height"])]),_:2},1032,["prop","required","rules"]),["create"].includes(j.value)?(m(),N(b,{key:0,class:"fulfillmentplanListedit-item","label-position":"top",label:"履约计划",prop:`orderLists.${t}.fulfillPlains`,required:""},{default:r(()=>[i("div",ht,[f(ze,ke({ref_for:!0,ref_key:"planRefMain",ref:d},{ref_for:!0},y,{modelValue:A.value.orderLists[t].fulfillPlains,"onUpdate:modelValue":v=>A.value.orderLists[t].fulfillPlains=v}),null,16,["modelValue","onUpdate:modelValue"])])]),_:2},1032,["prop"])):I("",!0)])):I("",!0)]),_:2},1032,["title","name"]))),128))]),_:1},8,["modelValue"])])}}}),kt=Ne(Ct,[["__scopeId","data-v-31c32654"]]),Nt={key:0,class:"progress-main"},It={style:{height:"70vh","overflow-y":"scroll",background:"#fff"}},At={key:0,class:"btn-view"},$t=Ce({name:"AddImporOrder",inheritAttrs:!1,__name:"add-impor-order",props:be({initData:{type:Object,default:()=>({})}},{modelValue:{},modelModifiers:{}}),emits:be(["success"],["update:modelValue"]),setup(K,{emit:ue}){var Ie;const y=K,A=h(y.initData.plainType||"create"),j=ue,q=Le(K,"modelValue"),W=(o,e,a="value",n="label")=>{const c=Re[o];if(!c)return console.error(`未找到名为 ${o} 的字典`),"";const u=c.find(L=>L[a]==e);return u?u[n]:""},H=h({create:"批量导入订单"}),ne=()=>{let o;return(e=>{e.create="确认"})(o||(o={})),o[A.value]||"确认"},X=ge(),d=h({id:y.initData.id||"",contractCode:y.initData.code||"",contractId:y.initData.contractId||y.initData.id||"",orderName:"",processName:"",processId:"",remark:"",orderLists:[]}),T={contractCode:[{required:!0,message:"请选择框架协议"}],processId:[{required:!0,message:"请配置框架订单流程"}],orderLists:[{required:!0,message:"请先下载模版，再批量导入订单",type:"array"}],orderName:[{required:!0,message:"请输入订单名称"}]},G=h(),Y=h(!1),Q=h(!1),le=h(0),P=ge([]),_=h(""),b=h({disabled:!0,config:{sourceInfo:"order"},secondTypeCode:(Ie=y.initData)==null?void 0:Ie.businessTypeSecond,targetInfo:{columns:[],initData:[],targetColumns:[],amountCode:""},incomeConfig:{showRow:!1,showFieldMap:{deposit:!0,depositReturnDate:!0}},expenditureConfig:{showRow:!0,showFieldMap:{}},rowConfig:{[B.INCOME]:{showRow:!1},[B.EXPENDITURE]:{showRow:!0}}}),E=async o=>{let e=P.value.find(a=>a.our==1)||null;e=e&&e.useRange?JSON.parse(e.useRange):[];try{return e=e.map(a=>({label:a.companyName,value:a.companyCode})),e}catch(a){return console.error(a),[]}},S=o=>je({contractCodeOrName:o}).then(e=>Promise.resolve(e.map(a=>({value:a.code,label:a.name,contractId:a.id,businessTypeSecond:a.businessTypeSecond,partyList:a.partyList||[],otherList:a.otherList||[]})))),V=o=>{let e=o.find(a=>a.fieldDefineType==="target")||null;if(e){const a=JSON.parse(e.fieldDefineInfo);b.value.targetInfo.columns=a.columns,b.value.targetInfo.targetColumns=b.value.targetInfo.columns.filter(n=>(n.uPrice==="1"&&(b.value.targetInfo.amountCode=n.code),n.targetType==="spec"||n.targetType==="amount"))}},se=o=>{const e=o.selected;b.value.secondTypeCode=e.businessTypeSecond,d.value.contractId=e.contractId,P.value=e.partyList,E(""),d.value.orderCompanyCode="",Z(e.businessTypeSecond),e.otherList&&V(e.otherList),d.value.orderLists=[]},Z=async o=>{const e=await He({businessTypeCode:o,contractType:"FRAMEWORK_ORDER"});if(e.length>0){const a=e[0];["create","cancel","cancel2"].includes(A.value)?(d.value.processName=a.startProcessName,d.value.processId=a.startProcessId):["change","change2"].includes(A.value)?(d.value.processName=a.availableProcessName,d.value.processId=a.availableProcessId):["end"].includes(A.value)&&(d.value.processName=a.endProcessName,d.value.processId=a.endProcessId)}else d.value.processId="",d.value.processName=""};h({fileName:`框架订单模版-${Ue()}.xlsx`});const s=({params:o})=>new Promise((e,a)=>{it({contractId:d.value.contractId}).then(n=>{e()}).catch(n=>{a(n)})}),t=o=>Qe(o).then(e=>{const a=e==null?void 0:e[0];return a?{...a,value:a.centerCode,label:a.centerName}:{value:"",label:""}}),v=o=>Ze(o).then(e=>{const a=e==null?void 0:e[0];return a?{value:a.feeCode,label:a.typeName,...a}:{value:"",label:""}}),D=o=>{const e=o.replace(/[^0-9]/g,"-").split("-"),a=e[0],n=String(e[1]).padStart(2,"0"),c=String(e[2]).padStart(2,"0");return{feeStartTime:`${a}-${n}-${c} 00:00:00`,feeEndTime:`${a}-${n}-${c} 00:00:00`}},re=async o=>{const e=[],a=[];for(let n of o.fulfillPlains){n={_id:n._id||n.id,payMethod:"ONLINE_BANKING",...n},n.invoiceType=W("invoice_type",n.invoiceType,"label","value");let c=await t({label:n.costCenterCode});n.costCenterName=c.label||"";let u=await v({codeOrName:n.costTypeCode});if(n.costTypeCode=u.value||"",n.costTypeName=u.label||"",n.feeTime){let O=D(n.feeTime);n.feeStartTime=O.feeStartTime||"",n.feeEndTime=O.feeEndTime||"",n.feeTime=`${n.feeStartTime} ~ ${n.feeEndTime}`}n.autoExtend=W("auto_extend",n.autoExtend,"label","value")||"NO";let L=await J(o);n._bankAccountInfo=ee(L,n),n.financeType==B.INCOME?e.push(n):a.push(n)}o.fulfillPlains={[B.INCOME]:e,[B.EXPENDITURE]:a}};let x=null;const pe=(o,e)=>{let a=o<e?1:-1;x=setInterval(()=>{o+=a,le.value=o,o===e&&clearInterval(x)},10)},R=o=>(_.value="",d.value.orderLists=[],new Promise((e,a)=>{const n=new FormData;n.append("contractId",d.value.contractId),n.append("file",o),ut(n).then(async c=>{if(c[0].errId)_.value=c[0].errId,ae.error("导入失败，请下载失败数据查看原因");else{Y.value=!0;let u=0;if(Q.value=!0,c){let L=0;for(let O of c){O.targetData.forEach(z=>{z.quantity&&(z.totalAmount=Xe(z.product_price,z.quantity))}),O.totalAmountText=we(O.targetData.reduce((z,de)=>he(z,de.totalAmount),0));let ie=Math.round((L+1)/c.length*99);pe(u,ie),u=ie,await re(O),L++}}d.value.orderLists=c||[],Ge(()=>{Y.value=!1,pe(u,100),ae.success("导入成功"),setTimeout(()=>{Q.value=!1},2500)})}e()}).catch(c=>{a(c)})})),l=o=>{console.log(o)},M=()=>new Promise((o,e)=>{dt(_.value).then(a=>{o()}).catch(a=>{e(a)})}),g=async o=>o.targetData.reduce((e,a)=>he(e,a.totalAmount),0),J=async o=>{var u;let e=((u=P.value.find(L=>L.our==1))==null?void 0:u.useRange)||[];e&&(e=JSON.parse(e));const a=e.find(L=>L.companyName===o.companyName).companyCode||"";let n=await Ke([a]),c={};return n&&Ye(c,n[0].bankInfoList[0]),c},ee=(o,e)=>{let a=o?[o.bankName,o.bankSubName,o.bankAccountName,o.bankAccountNumber].filter(n=>!!n).join(","):"";return e&&(o&&(e.bankAccountName=o.bankAccountName||"",e.bankAccountNumber=o.bankAccountNumber||"",e.bankName=o.bankName||"",e.bankSubName=o.bankSubName||"",e.bankAccountNumberId=o.bankAccountNumberId),e._bankAccountInfo=a),a},te=async o=>{const{targetInfo:e}=b.value;return JSON.stringify({columns:[...e.targetColumns.map(a=>({label:a.label,code:a.code,minWidth:160,uPrice:a.uPrice||"0",sum:a.sum||"0"}))],data:o.targetData})},fe=async(o,e)=>{let a=[];for(let n in o.fulfillPlains)if(o.fulfillPlains[n].length>0){let c=o.fulfillPlains[n];for(let u of c)u.financeType=u.financeType||n,u.fulfillStatus="WAIT_PROMISE",u.fulfillDate=u.fulfillDate?et(u.fulfillDate).format("YYYY-MM-DD 00:00:00"):"",n===B.EXPENDITURE?(u.payPartyCode=o.companyCode,u.payPartyName=o.companyName):(u.receivePartyCode=o.partyCode,u.receivePartyName=o.partyName,u.disdeposit===1&&(u.depositReturnReceivePartyCode=o.partyCode,u.depositReturnReceivePartyName=o.partyName,u.depositReturnReceivePartyBankAccountNumber=e.bankAccountNumber));a=[...a,...tt(o.fulfillPlains[n])];break}return a},Oe=async()=>{const{targetInfo:o}=b.value,{id:e,orderLists:a,...n}=d.value,c=[];return await Promise.all(a.map(async u=>{let L=await g(u),O=await J(u),ie=await te(u),z=await fe(u,O),de={...n,orderCompanyCode:u.companyCode||"",orderCompanyName:u.companyName,orderName:u.orderName,remark:"",amount:L,orderCompanyBankInfo:O,orderDetail:ie,contractListFulfillmentPlainParamList:z};c.push({...de})})),c},Se=async o=>{if(["create"].includes(A.value))try{o.value=!1;try{if(await X.value.validate(),!G.value)return ae.error("请下载模版后，再批量导入数据"),!1}catch(a){for(const n in a)if(a[n][0]){ae.error(a[n][0].message);return}return}let e=await Oe();await Je(e),ae.success("批量导入成功"),j("success"),q.value=!1}catch(e){console.log(e),o.value=!1}};return Be(()=>d.value.contractCode,(o,e)=>{o?E(""):d.value={amount:0,contractCode:y.initData.code,orderLists:[]}},{immediate:!0}),(o,e)=>{const a=C("el-progress"),n=C("form-select-v2"),c=C("el-form-item"),u=C("el-col"),L=C("UploadFilled"),O=C("el-icon"),ie=C("el-button"),z=C("el-row"),de=C("el-form"),Fe=C("complex-dialog"),qe=Ee("loading");return m(),N(Fe,{top:"10vh",title:H.value[A.value],modelValue:q.value,"onUpdate:modelValue":e[2]||(e[2]=ce=>q.value=ce),width:"80vw",onSubmit:Se,confirmText:ne()},{default:r(()=>[Q.value?(m(),oe("div",Nt,[f(a,{"text-inside":!0,"stroke-width":10,percentage:le.value,color:"#3e79ff"},null,8,["percentage"])])):I("",!0),F((m(),oe("div",It,[f(de,{class:"radius-box add-order-main",ref_key:"formRef",ref:X,model:d.value,"label-position":"left",rules:T,style:{padding:"12px 12px 0"}},{default:r(()=>[f(z,null,{default:r(()=>[f(u,{span:16},{default:r(()=>[f(c,{label:"框架协议",prop:"contractCode",required:["create"].includes(A.value)},{default:r(()=>[f(n,{modelValue:d.value.contractCode,"onUpdate:modelValue":e[0]||(e[0]=ce=>d.value.contractCode=ce),"search-method":S,disabled:!["create","change2"].includes(A.value),clearable:"",placeholder:["create","change2"].includes(A.value)?"请输入合同编号或名称选择框架协议":" ",onChange:se},null,8,["modelValue","disabled","placeholder"])]),_:1},8,["required"])]),_:1}),f(u,{span:8},{default:r(()=>[d.value.contractCode?(m(),oe("div",At,[f(w(Pe),{class:"link",size:"small",link:"",text:"下载模版",requestMethod:s}),f(w(We),{class:"link",accept:".xlsx",text:"批量导入",link:"",size:100,fileUpload:R,onSuccess:l},{default:r(()=>[f(ie,{type:"primary",link:"",size:"small",style:{display:"inline-block"}},{default:r(()=>[f(O,{style:{"margin-right":"6px"}},{default:r(()=>[f(L)]),_:1}),e[3]||(e[3]=i("span",{style:{"margin-top":"2px"}},"批量导入",-1))]),_:1,__:[3]})]),_:1}),_.value?(m(),N(w(Pe),{key:0,class:"link",size:"small",link:"",text:"下载失败数据",style:{color:"red"},requestMethod:M})):I("",!0)])):I("",!0)]),_:1})]),_:1}),f(c,{label:"审批流程",prop:"processId",required:["create"].includes(A.value)},{default:r(()=>[p(k(d.value.processName||"-"),1)]),_:1},8,["required"]),d.value.orderLists&&d.value.orderLists.length>0?(m(),N(kt,ke({key:0,ref_key:"orderRowCollapseRef",ref:G,modelValue:d.value,"onUpdate:modelValue":e[1]||(e[1]=ce=>d.value=ce),partyList:P.value},b.value),null,16,["modelValue","partyList"])):I("",!0)]),_:1},8,["model"])])),[[qe,Y.value]])]),_:1},8,["title","modelValue","confirmText"])}}}),Pt=Ne($t,[["__scopeId","data-v-2640544e"]]),Tt={class:"amount-list"},Dt={class:"amount-title"},xt={class:"text-ellipsis"},Lt={class:"multi-line-ellipsis",style:{"line-height":"24px"}},wt={style:{color:"#1d2129","font-size":"13px","margin-bottom":"5px"}},Et={style:{color:"#1d2129","font-size":"12px","margin-bottom":"5px"}},Rt={style:{color:"#1d2129","font-size":"12px","margin-bottom":"5px"}},Ot={style:{color:"#1d2129","font-size":"12px","margin-bottom":"5px"}},St={style:{color:"#1d2129","font-size":"12px","margin-bottom":"5px"}},Ft={style:{color:"#1d2129","font-size":"12px","margin-bottom":"5px"}},qt={style:{color:"#1d2129","font-size":"12px","margin-bottom":"5px"}},Vt={style:{color:"#1d2129","font-size":"12px","margin-bottom":"5px"}},Mt={style:{color:"#1d2129","font-size":"12px","margin-bottom":"5px"}},zt={style:{color:"#1d2129","font-size":"12px","margin-bottom":"5px"}},Ut={class:"amount-list"},Bt={class:"amount-title"},Wt={class:"multi-line-ellipsis",style:{"line-height":"24px"}},jt={class:"display-flex"},$="ContractOrder",Ht=Ce({name:$,__name:"index",setup(K){const ue=at();ot();const y=h({add:`${$}:add`,importOrder:`${$}:importOrder`,edit:`${$}:edit`,del:`${$}:del`,end:`${$}:end`,void:`${$}:void`,submit:`${$}:submit`,submitChange:`${$}:submitChange`,cancel:`${$}:cancel`,cancelChange:`${$}:cancelChange`,cancelEnd:`${$}:cancelEnd`,withdraw:`${$}:withdraw`,withdrawChange:`${$}:withdrawChange`,withdrawEnd:`${$}:withdrawEnd`,change:`${$}:change`}),A=h(),j=h({}),q=(s,t)=>{const v=Re[s];if(!v)return console.error(`未找到名为 ${s} 的字典`),"";const D=v.find(re=>re.value==t);return D?D.label:""},W={INVALID:"#4e5969",WAITE_APPROVAL:"#ff802a",IN_APPROVAL:"#34c759",IN_FULFILLMENT:"#34c759",CHANGED_WAITE_APPROVAL:"#ff802a",CHANGED_APPROVAL:"#34c759",STOPPING:"#34C759",STOPPED:"#4E5969",TASK_EFFECT:"#4E5969"},H=h({code:name,requestFunction:ct,pageSize:20,searchProps:{code:`${name}Search`,options:[_e({label:"订单名称",prop:"orderName"}),_e({label:"订单编号",prop:"orderCode"}),Te({label:"下单公司",prop:"orderCompanyCode",multiple:!1,searchMethod:mt}),Te({label:"下单人",prop:"createUserId",multiple:!1,searchMethod:pt}),nt({label:"创建时间",prop:"",sf:"startDate",ef:"endDate"}),_e({label:"所属合同",prop:"contractCodeOrName",placeholder:"请输入合同编号或名称"}),lt({label:"状态",prop:"orderStatus",code:"order_status",multiple:!1})]},tableProps:{code:`${name}Table`,showIndex:!1,showSelect:!0,autoTable:!1,columns:[{label:"订单",prop:"orderName",slot:"orderName",minWidth:260},{label:"下单公司",prop:"orderCompanyName",minWidth:180},{label:"总金额",prop:"contractAmount",slot:"contractAmount",minWidth:120},{label:"收入计划",slot:"contractAmountReq",minWidth:260},{label:"支出计划",slot:"contractAmountRes",minWidth:260},{label:"经办人",prop:"createUserName",minWidth:120},{label:"经办部门",prop:"createUserDept",minWidth:160},{label:"合同",prop:"contractName",slot:"contractName",minWidth:260}]}});H.value.tableProps.columns.push({label:"操作",prop:"operate",fixed:"right",width:280,slot:"operate"});const ne=h([]),X=()=>{A.value.refresh()},d=()=>{A.value.search()},T=(s,t,v={})=>{rt({body:s,bodyData:{initData:{...t,...v}},isReject:!0}).then(D=>{D.success&&(t?X():d())}).catch(()=>{})},G=async(s,t="create")=>{if(t==="submit"){const v=await De(s.id);if(v)try{v&&xe({submitId:v}),ae.success("提交成功"),X()}catch(D){console.log(D)}else ae.error("数据异常，无订单不能提交")}else T(ve,s,{plainType:t})},Y=s=>{ue.push({name:"ContractDetails",params:{code:s.contractCode}})},Q=()=>{T(Pt,{})},le=s=>{T(ve,{...s},{plainType:"edit"})},P=s=>T(me,s,{type:"terminate"}),_=async(s,t)=>{ft(s.id).then(v=>{T(ve,s,{plainType:"change"})}).catch(()=>{}).finally(()=>{t.done()})},b=s=>{yt(s.id).then(t=>{t&&T(ve,s,{plainType:"end"})})},E=s=>T(me,s,{type:"cancelChange"}),S=(s,t)=>{De(s.id).then(v=>{xe({submitId:v}),X()}).finally(()=>{t.done()})},V=s=>T(me,s,{type:"withdraw"}),se=s=>T(me,s,{type:"modify"}),Z=s=>{T(me,s,{type:"stopWithdraw"})};return(s,t)=>{const v=C("el-button"),D=C("el-link"),re=C("el-tooltip"),x=C("FsButton"),pe=C("complex-page"),R=Ee("per");return m(),N(pe,ke({ref_key:"contractOrderListRef",ref:A,searchData:j.value,"onUpdate:searchData":t[2]||(t[2]=l=>j.value=l),"select-list":ne.value,"onUpdate:selectList":t[3]||(t[3]=l=>ne.value=l)},H.value),st({orderName:r(({row:l,$index:M})=>[i("div",Tt,[i("div",Dt,[f(re,{class:"box-item",effect:"dark",content:l.orderName,placement:"top"},{default:r(()=>[f(D,{type:"primary",class:"multi-line-ellipsis",onClick:g=>G(l,"info"),underline:"never"},{default:r(()=>[i("div",xt,k(l.orderName),1)]),_:2},1032,["onClick"])]),_:2},1032,["content"])]),i("div",Lt,k(l.orderCode),1)])]),contractAmount:r(({row:l,$index:M})=>[i("div",wt,[i("span",null,k(s.$format.thousandsFormatCurrency(l.amount)),1)])]),contractAmountReq:r(({row:l,$index:M})=>{var g,J,ee,te;return[i("div",Et,[t[6]||(t[6]=p(" 计划总金额： ")),i("span",null,k(s.$format.thousandsFormatCurrency((g=l.inAmountList)==null?void 0:g.amount)),1)]),i("div",Rt,[t[7]||(t[7]=p(" 已履约金额： ")),i("span",null,k(s.$format.thousandsFormatCurrency((J=l.inAmountList)==null?void 0:J.fulfillmentAmount)),1)]),i("div",Ot,[t[8]||(t[8]=p(" 在途履约金额： ")),i("span",null,k(s.$format.thousandsFormatCurrency((ee=l.inAmountList)==null?void 0:ee.inFulfillmentAmount)),1)]),i("div",St,[t[9]||(t[9]=p(" 待履约金额： ")),i("span",null,k(s.$format.thousandsFormatCurrency((te=l.inAmountList)==null?void 0:te.waitFulfillmentAmount)),1)])]}),contractAmountRes:r(({row:l,$index:M})=>{var g,J,ee,te,fe;return[i("div",Ft,[t[10]||(t[10]=p(" 计划总金额： ")),i("span",null,k(s.$format.thousandsFormatCurrency((g=l.outAmountList)==null?void 0:g.amount)),1)]),i("div",qt,[t[11]||(t[11]=p(" 已履约金额： ")),i("span",null,k(s.$format.thousandsFormatCurrency((J=l.outAmountList)==null?void 0:J.fulfillmentAmount)),1)]),i("div",Vt,[t[12]||(t[12]=p(" 在途履约金额： ")),i("span",null,k(s.$format.thousandsFormatCurrency((ee=l.outAmountList)==null?void 0:ee.inFulfillmentAmount)),1)]),i("div",Mt,[t[13]||(t[13]=p(" 预留保证金： ")),i("span",null,k(s.$format.thousandsFormatCurrency((te=l.outAmountList)==null?void 0:te.preWarrantyAmount)),1)]),i("div",zt,[t[14]||(t[14]=p(" 待履约金额： ")),i("span",null,k(s.$format.thousandsFormatCurrency((fe=l.outAmountList)==null?void 0:fe.waitFulfillmentAmount)),1)])]}),status:r(({row:l,$index:M})=>[i("div",{class:"contract-status",style:ye(`color: ${W[l.status]}`)},[i("i",{style:ye(`background: ${W[l.status]}`)},null,4),p(" "+k(q("contract_order_status",l.status)),1)],4)]),contractName:r(({row:l,$index:M})=>[i("div",Ut,[i("div",Bt,[f(re,{class:"box-item",effect:"dark",content:l.contractName,placement:"top"},{default:r(()=>[f(D,{type:"primary",class:"multi-line-ellipsis",onClick:g=>Y(l),underline:"never"},{default:r(()=>[p(k(l.contractName),1)]),_:2},1032,["onClick"])]),_:2},1032,["content"])]),i("div",Wt,k(l.contractCode||""),1)])]),operate:r(({row:l,$index:M})=>[i("div",jt,[i("div",{class:"contract-status",style:ye(`color: ${W[l.status]}`)},[i("i",{style:ye(`background: ${W[l.status]}`)},null,4),p(" "+k(q("contract_order_status",l.status)),1)],4)]),i("div",null,[f(x,{link:"","show-loading":!1,onClick:g=>G(l,"info")},{default:r(()=>t[15]||(t[15]=[p("详情")])),_:2,__:[15]},1032,["onClick"]),w(U)(10,l.status)?F((m(),N(x,{key:0,link:"",type:"danger","show-loading":!1,onClick:g=>E(l)},{default:r(()=>t[16]||(t[16]=[p("取消变更")])),_:2,__:[16]},1032,["onClick"])),[[R,y.value.cancelChange]]):I("",!0),w(U)(3,l.status)?F((m(),N(x,{key:1,link:"",type:"primary","show-loading":!1,onClick:g=>le(l)},{default:r(()=>t[17]||(t[17]=[p("编辑")])),_:2,__:[17]},1032,["onClick"])),[[R,y.value.edit]]):I("",!0),w(U)(6,l.status)?F((m(),N(x,{key:2,link:"",type:"danger","show-loading":!1,onClick:g=>P(l)},{default:r(()=>t[18]||(t[18]=[p("作废")])),_:2,__:[18]},1032,["onClick"])),[[R,y.value.void]]):I("",!0),w(U)(15,l.status)?F((m(),N(x,{key:3,link:"",type:"primary",onClick:g=>_(l,g)},{default:r(()=>t[19]||(t[19]=[p("变更")])),_:2,__:[19]},1032,["onClick"])),[[R,y.value.change]]):I("",!0),w(U)(7,l.status)?F((m(),N(x,{key:4,link:"",type:"primary",onClick:g=>S(l,g)},{default:r(()=>t[20]||(t[20]=[p("提交审批")])),_:2,__:[20]},1032,["onClick"])),[[R,y.value.submit]]):I("",!0),w(U)(8,l.status)?F((m(),N(x,{key:5,link:"",type:"primary",onClick:g=>S(l,g)},{default:r(()=>t[21]||(t[21]=[p("提交审批")])),_:2,__:[21]},1032,["onClick"])),[[R,y.value.submitChange]]):I("",!0),w(U)(5,l.status)?F((m(),N(x,{key:6,link:"",type:"danger","show-loading":!1,onClick:g=>b(l)},{default:r(()=>t[22]||(t[22]=[p("终止")])),_:2,__:[22]},1032,["onClick"])),[[R,y.value.end]]):I("",!0),w(U)(12,l.status)?F((m(),N(x,{key:7,link:"",type:"danger","show-loading":!1,onClick:g=>V(l)},{default:r(()=>t[23]||(t[23]=[p("撤回")])),_:2,__:[23]},1032,["onClick"])),[[R,y.value.withdraw]]):I("",!0),w(U)(13,l.status)?F((m(),N(x,{key:8,link:"",type:"danger","show-loading":!1,onClick:g=>se(l)},{default:r(()=>t[24]||(t[24]=[p("撤回")])),_:2,__:[24]},1032,["onClick"])),[[R,y.value.withdrawChange]]):I("",!0),w(U)(14,l.status)?F((m(),N(x,{key:9,link:"","show-loading":!1,onClick:g=>Z(l)},{default:r(()=>t[25]||(t[25]=[p("撤回")])),_:2,__:[25]},1032,["onClick"])),[[R,y.value.withdrawEnd]]):I("",!0)])]),_:2},[y.value.add||y.value.importOrder?{name:"action",fn:r(({queryData:l})=>[y.value.add?(m(),N(v,{key:0,size:"small",type:"primary",onClick:t[0]||(t[0]=M=>G({}))},{default:r(()=>t[4]||(t[4]=[p("单个订单新增")])),_:1,__:[4]})):I("",!0),y.value.importOrder?(m(),N(v,{key:1,size:"small",type:"primary",onClick:t[1]||(t[1]=M=>Q())},{default:r(()=>t[5]||(t[5]=[p("批量导入订单")])),_:1,__:[5]})):I("",!0)]),key:"0"}:void 0]),1040,["searchData","select-list"])}}}),Yt=Ne(Ht,[["__scopeId","data-v-2acf1b01"]]);export{Yt as default};
