const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/prior-application-pzrFPkpO.js","assets/index-Cyvvb__l.js","assets/index-CCn4OCkM.css","assets/index-i7ixLZTb.js"])))=>i.map(i=>d[i]);
import{d as ce,r as b,u as ue,o as pe,e as z,a as F,s as H,n as me,b as q,c as ye,f as _e,g as ve,h as g,i as fe,j as u,k as o,l as Ce,w as i,m as _,p as r,q as a,t as p,v as c,x as E,y as N,F as he,z as ke,A as D,B as v,C as R,D as L,E as be,G as I,H as x,I as ge,J as $e,K as Te,L as Ae,M as Ee,N as G,O as Ne,P as De,Q as Le}from"./index-Cyvvb__l.js";import{L as U}from"./StorageCache-CXk3PELT.js";import{t as Ie}from"./index-i7ixLZTb.js";import{g as f,A as Oe}from"./add-order-yZp2642q.js";import{_ as Pe,a as $,b as Fe}from"./contract-filing.vue_vue_type_script_setup_true_lang-3AGij5ug.js";/* empty css                                                                          */import Re from"./add-dialog-ZAlQGuxm.js";import"./index-BdKTu7rQ.js";import"./error-Cq9Fpw4b.js";const xe={class:"display-flex"},Se={key:0,style:{width:"120px","font-size":"12px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},Ve={class:"amount-list"},We={class:"amount-title"},Me={class:"multi-line-ellipsis",style:{"line-height":"24px"}},Be={style:{display:"flex","justify-content":"space-between","align-items":"center"}},je={style:{"line-height":"24px",color:"#ff2222"}},ze={class:"amount-list"},He={style:{"margin-top":"8px"}},qe={class:"desc-list width-c3"},Ge={class:"desc-item"},Ue={class:"desc-value"},Ke={class:"desc-label"},Je={class:"desc-value"},Qe={class:"desc-list width-c5"},Ye={class:"desc-item"},Xe={class:"desc-value"},Ze={class:"desc-item"},we={class:"desc-value"},et={class:"desc-item"},tt={class:"desc-value"},st={class:"desc-item"},at={class:"desc-value"},nt={class:"desc-list width-c4"},it={class:"desc-item"},ot={class:"desc-value"},lt={class:"desc-item"},dt={class:"desc-value"},rt={class:"desc-item"},ct={class:"desc-value"},d="ContractList",ut=ce({name:d,__name:"index",setup(pt){const O=b(),S=b({}),K=ue();pe(()=>{});const m=b({add:`${d}:add`,edit:`${d}:edit`,del:`${d}:del`,copy:`${d}:copy`,change:`${d}:change`,archiving:`${d}:archiving`,end:`${d}:end`,void:`${d}:void`,addOrder:`${d}:addOrder`,addContractOrder:`${d}:addContractOrder`,submit:`${d}:submit`,submitChange:`${d}:submitChange`,cancel:`${d}:cancel`,cancelChange:`${d}:cancelChange`,cancelEnd:`${d}:cancelEnd`,withdraw:`${d}:withdraw`,withdrawChange:`${d}:withdrawChange`,withdrawEnd:`${d}:withdrawEnd`}),T={CREATED:"#FF802A",INVALID:"#4E5969",IN_APPROVAL:"#34C759",CHANGE_IN_APPROVAL:"#34C759",CANCELLED:"#4E5969",CHANGED_WAITE_APPROVAL:"#FF802A",IN_FULFILLMENT:"#34C759",IN_STOP:"#34C759",ENDED:"#4E5969",FINISHED:"#4E5969"},J=b({code:d,beforeRequest:s=>{if(s.businessTypeList){const e=[];return s.businessTypeList.forEach(n=>{e.push(n[n.length-1])}),{...s,businessTypeList:e}}},requestFunction:ye,pageSize:20,searchProps:{code:`${d}Search`,options:[z({label:"合同编号",prop:"code"}),z({label:"合同名称",prop:"name"}),F({label:"合同类型",prop:"contractTypeEnumList",code:"contract_type",multiple:!0}),{formItemProps:{prop:"businessTypeList",label:"业务类型"},inputName:"YmCascader",inputProps:{clearable:!0,placeholder:"请选择业务类型",multiple:!0,filterable:!0,checkStrictly:!0}},F({label:"状态",prop:"contractStatusEnumList",code:"contract_status",multiple:!0}),H({label:"供应商",prop:"partyCodeList",multiple:!0,searchMethod:_e}),H({label:"机构名称",prop:"orgCodeList",multiple:!0,searchMethod:ve}),me({label:"合同金额",prop:"",sf:"startAmount",ef:"endAmount"}),q({label:"合同创建时间",prop:"",sf:"startCreateTime",ef:"endCreateTime"}),q({label:"合同有效期",prop:"",sf:"startDate",ef:"endDate"}),F({label:"归档",prop:"archived",code:"archived_status"})]},tableProps:{code:`${d}Table`,showSelect:!0,autoTable:!1,columns:[{label:"合同名称｜合同编号｜合同金额",prop:"amount",slot:"amount",minWidth:260},{label:"业务类型｜合同类型",prop:"type",slot:"type",minWidth:160},{label:"人员｜签约方信息",prop:"contractPartyList",slot:"contractPartyList",minWidth:240},{label:"时间信息",prop:"time",slot:"time",width:200},{label:"金额信息",prop:"price",slot:"price",minWidth:200},{label:"当前状态｜操作",prop:"operate",slot:"operate",fixed:"right",width:280}]}}),V=b([]),W=s=>{if(s&&s.id){I({name:"ContractEdit",params:{id:s.id}});return}const e={bodyFilePathSet:[],...s,fileType:"importFile"};x({body:Re,bodyData:{initData:e||{}},isReject:!0})},M=()=>{O.value.refresh()},Q=()=>{x({body:()=>ge(()=>import("./prior-application-pzrFPkpO.js"),__vite__mapDeps([0,1,2,3])),bodyData:{},isReject:!0}).then(()=>{})},Y=()=>{O.value.search()},X=s=>{K.push({name:"ContractDetails",params:{code:s.code}})},B=(s,e)=>{$e({id:s.id}).then(n=>{Ie({submitId:n}),M()}).finally(()=>{e.done()})},Z=async(s,e)=>{try{await Te(s.id,s.code)?I({name:"ContractEdit",params:{id:s.id}}):Ae.error("存在履约进行中的计划，不允许变更")}finally{e.done()}},C=(s,e,n={})=>{x({body:s,bodyData:{initData:{...e,...n}},isReject:!0}).then(h=>{h.success&&(e?M():Y())}).catch(()=>{})},w=s=>{Ee({contractId:s.id}).then(e=>{e&&C(Pe,s)})},ee=s=>C(Oe,s),te=s=>C($,s,{type:"cancelChange"}),se=s=>C($,s,{type:"terminate"}),ae=s=>C($,s,{type:"withdraw"}),ne=s=>C($,s,{type:"modify"}),ie=s=>C(Fe,s),oe=s=>{const e=G();U.getInstance().setData(e,{cacheCode:e,businessTypeFirst:s.businessTypeFirst,businessTypeFirstName:s.businessTypeFirstName,businessTypeSecond:s.businessTypeSecond,businessTypeSecondName:s.businessTypeSecondName,businessTypeInfo:s.businessTypeFirstName+"-"+s.businessTypeSecondName,relatedContractCode:s.code,relatedContractName:s.name,type:Ne.ORDER_CONTRACT}),I({name:"ContractCreate",params:{cacheCode:e}})},le=(s,e)=>{const n=G();U.getInstance().setData(n,{cacheCode:n,copyContractId:s.id}),I({name:"ContractCreate",params:{cacheCode:n}})},de=s=>{C($,s,{type:"stopWithdraw"})},P=(s,e)=>{const n=De[s];if(!n)return console.error(`未找到名为 ${s} 的字典`),"";const h=n.find(A=>A.value==e);return h?h.label:""};return(s,e)=>{const n=g("FsButton"),h=g("el-link"),A=g("el-tooltip"),j=g("el-tag"),re=g("complex-page"),y=fe("per");return o(),u(re,be({ref_key:"contractListRef",ref:O,searchData:S.value,"onUpdate:searchData":e[2]||(e[2]=t=>S.value=t),"select-list":V.value,"onUpdate:selectList":e[3]||(e[3]=t=>V.value=t)},J.value),Ce({operate:i(({row:t,$index:k})=>[a("div",xe,[[c(R).IN_APPROVAL,c(R).CHANGE_IN_APPROVAL,c(R).IN_STOP].includes(t.status)&&t.processId?(o(),u(A,{key:0,class:"box-item",content:`流程单号: ${t.processId||""}`,placement:"top-start"},{default:i(()=>[D(h,{type:"primary",underline:"never"},{default:i(()=>[a("div",{class:"contract-status",style:L(`color: ${T[t.status]}`)},[a("i",{style:L(`background: ${T[t.status]}`)},null,4),r(" "+p(P("contract_status",t.status)),1)],4),t.processId?(o(),N("div",Se,"(流程单号: "+p(t.processId||"")+")",1)):v("",!0)]),_:2},1024)]),_:2},1032,["content"])):(o(),N("div",{key:1,class:"contract-status",style:L(`color: ${T[t.status]}`)},[a("i",{style:L(`background: ${T[t.status]}`)},null,4),r(" "+p(P("contract_status",t.status)),1)],4))]),c(f)(14,t.status)?_((o(),u(n,{key:0,link:"",type:"danger","show-loading":!1,onClick:l=>te(t)},{default:i(()=>e[6]||(e[6]=[r("取消变更")])),_:2,__:[6]},1032,["onClick"])),[[y,m.value.cancelChange]]):v("",!0),c(f)(2,t.status)?_((o(),u(n,{key:1,link:"",type:"primary","show-loading":!1,onClick:l=>W(t)},{default:i(()=>e[7]||(e[7]=[r("编辑")])),_:2,__:[7]},1032,["onClick"])),[[y,m.value.edit]]):v("",!0),c(f)(8,t.status)?_((o(),u(n,{key:2,link:"",type:"danger","show-loading":!1,onClick:l=>se(t)},{default:i(()=>e[8]||(e[8]=[r("作废")])),_:2,__:[8]},1032,["onClick"])),[[y,m.value.void]]):v("",!0),c(f)(5,t.status)?_((o(),u(n,{key:3,link:"",type:"primary",onClick:l=>Z(t,l)},{default:i(()=>e[9]||(e[9]=[r("变更")])),_:2,__:[9]},1032,["onClick"])),[[y,m.value.change]]):v("",!0),c(f)(11,t.status)?_((o(),u(n,{key:4,link:"",type:"primary",onClick:l=>B(t,l)},{default:i(()=>e[10]||(e[10]=[r("提交审批")])),_:2,__:[10]},1032,["onClick"])),[[y,m.value.submit]]):v("",!0),c(f)(12,t.status)?_((o(),u(n,{key:5,link:"",type:"primary",onClick:l=>B(t,l)},{default:i(()=>e[11]||(e[11]=[r("提交审批")])),_:2,__:[11]},1032,["onClick"])),[[y,m.value.submitChange]]):v("",!0),c(f)(7,t.status)?_((o(),u(n,{key:6,link:"",type:"danger","show-loading":!1,onClick:l=>w(t)},{default:i(()=>e[12]||(e[12]=[r("终止")])),_:2,__:[12]},1032,["onClick"])),[[y,m.value.end]]):v("",!0),c(f)(16,t.status)?_((o(),u(n,{key:7,link:"",type:"danger","show-loading":!1,onClick:l=>ae(t)},{default:i(()=>e[13]||(e[13]=[r("撤回")])),_:2,__:[13]},1032,["onClick"])),[[y,m.value.withdraw]]):v("",!0),c(f)(17,t.status)?_((o(),u(n,{key:8,link:"",type:"danger","show-loading":!1,onClick:l=>ne(t)},{default:i(()=>e[14]||(e[14]=[r("撤回")])),_:2,__:[14]},1032,["onClick"])),[[y,m.value.withdrawChange]]):v("",!0),c(f)(18,t.status)?_((o(),u(n,{key:9,link:"","show-loading":!1,onClick:l=>de(t)},{default:i(()=>e[15]||(e[15]=[r("撤回")])),_:2,__:[15]},1032,["onClick"])),[[y,m.value.withdrawEnd]]):v("",!0),c(f)(6,t.status)&&t.archived==="NO_ARCHIVED"?_((o(),u(n,{key:10,link:"","show-loading":!1,onClick:l=>ie(t)},{default:i(()=>e[16]||(e[16]=[r("归档")])),_:2,__:[16]},1032,["onClick"])),[[y,m.value.archiving]]):v("",!0),c(f)(9,t.status)&&t.type==="FRAMEWORK_CONTRACT"?_((o(),u(n,{key:11,link:"",type:"primary","show-loading":!1,onClick:l=>ee(t)},{default:i(()=>e[17]||(e[17]=[r("新增订单")])),_:2,__:[17]},1032,["onClick"])),[[y,m.value.addOrder]]):v("",!0),c(f)(10,t.status)&&t.type==="FRAMEWORK_CONTRACT"?_((o(),u(n,{key:12,link:"","show-loading":!1,onClick:l=>oe(t)},{default:i(()=>e[18]||(e[18]=[r("新增订单合同")])),_:2,__:[18]},1032,["onClick"])),[[y,m.value.addContractOrder]]):v("",!0),c(f)(4,t.status)?_((o(),u(n,{key:13,link:"","show-loading":!1,onClick:l=>le(t,l)},{default:i(()=>e[19]||(e[19]=[r("复制")])),_:2,__:[19]},1032,["onClick"])),[[y,m.value.copy]]):v("",!0)]),amount:i(({row:t,$index:k})=>[a("div",Ve,[a("div",We,[D(A,{class:"box-item",effect:"dark",content:t.name,placement:"top"},{default:i(()=>[D(h,{type:"primary",class:"multi-line-ellipsis",onClick:l=>X(t),underline:"never"},{default:i(()=>[r(p(t.name),1)]),_:2},1032,["onClick"])]),_:2},1032,["content"])]),a("div",Me,p(t.code),1),a("div",Be,[a("div",je,p(s.$format.thousandsFormatCurrency(t.amount)),1)])])]),type:i(({row:t,$index:k})=>[a("div",ze,[a("div",null,p(t.businessTypeFirstName)+" - "+p(t.businessTypeSecondName),1),a("div",He,[D(j,{effect:"plain",type:"info",style:{color:"#1d2129"},size:"small"},{default:i(()=>[r(p(P("contract_type",t.type)),1)]),_:2},1024),t.changed?(o(),u(j,{key:0,style:{"margin-left":"4px",color:"#ff2a2a"},size:"small",type:"danger"},{default:i(()=>e[20]||(e[20]=[r("变更")])),_:1,__:[20]})):v("",!0)])])]),contractPartyList:i(({row:t,$index:k})=>[a("div",qe,[a("div",Ge,[e[21]||(e[21]=a("div",{class:"desc-label"},"创建人：",-1)),a("div",Ue,p(t.createUserName),1)]),(o(!0),N(he,null,ke(t.contractPartyList,l=>(o(),N("div",{class:"desc-item",key:l.id},[a("div",Ke,p(l.partyTypeName)+"方：",1),a("div",Je,p(l.partyName),1)]))),128))])]),time:i(({row:t,$index:k})=>[a("div",Qe,[a("div",Ye,[e[22]||(e[22]=a("div",{class:"desc-label"},"有效时间起：",-1)),a("div",Xe,p(c(E)(t.startDate)),1)]),a("div",Ze,[e[23]||(e[23]=a("div",{class:"desc-label"},"有效时间止：",-1)),a("div",we,p(c(E)(t.endDate)),1)]),a("div",et,[e[24]||(e[24]=a("div",{class:"desc-label"},"创建时间：",-1)),a("div",tt,p(c(E)(t.createTime)),1)]),a("div",st,[e[25]||(e[25]=a("div",{class:"desc-label"},"签订时间：",-1)),a("div",at,p(c(E)(t.signDate)),1)])])]),price:i(({row:t,$index:k})=>[a("div",nt,[a("div",it,[e[26]||(e[26]=a("div",{class:"desc-label"},"总金额：",-1)),a("div",ot,p(s.$format.thousandsFormatCurrency(t.amount)),1)]),a("div",lt,[e[27]||(e[27]=a("div",{class:"desc-label"},"已付金额：",-1)),a("div",dt,p(s.$format.thousandsFormatCurrency(t.amountFinish)),1)]),a("div",rt,[e[28]||(e[28]=a("div",{class:"desc-label"},"在途金额：",-1)),a("div",ct,p(s.$format.thousandsFormatCurrency(t.amountApply)),1)])])]),_:2},[m.value.add?{name:"action",fn:i(({queryData:t})=>[_((o(),u(n,{"show-loading":!1,type:"primary",onClick:e[0]||(e[0]=k=>W())},{default:i(()=>e[4]||(e[4]=[r("新建合同")])),_:1,__:[4]})),[[y,m.value.add]]),_((o(),u(n,{"show-loading":!1,type:"primary",onClick:e[1]||(e[1]=k=>Q())},{default:i(()=>e[5]||(e[5]=[r("发起事前申请")])),_:1,__:[5]})),[[y,m.value.add]])]),key:"0"}:void 0]),1040,["searchData","select-list"])}}}),$t=Le(ut,[["__scopeId","data-v-af2121e8"]]);export{$t as default};
