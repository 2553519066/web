const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/BizTypeScopeDailog-Dw5Qtc_Y.js","assets/index-7XFzyDag.js","assets/index-CCf3sdPh.css","assets/icon-download-gMM3hg_1.js","assets/index-BOPu5dgU.js","assets/index-DjU9Y7w1.js","assets/error-Cq9Fpw4b.js","assets/BizTypeScopeDailog-DqCA5wSH.css","assets/UserForm-CJHMVQ6M.js","assets/FormDialog-Bh5vZ0fb.js"])))=>i.map(i=>d[i]);
import{bh as _,bi as m,cg as ce,d as Y,r as g,bj as H,ch as ae,h as l,i as J,y as P,k as h,A as e,w as t,j as $,B as j,q as b,t as K,m as k,v as f,ci as v,p as S,cj as R,I as w,L as M,o as de,c7 as pe,Q as _e}from"./index-7XFzyDag.js";import{E as G}from"./index-BOPu5dgU.js";const me=()=>_.get(`${m.contract}/authConfig/query`),Oe=n=>_.post(`${m.contract}/authConfig/add`,n),Ue=n=>_.post(`${m.contract}/authConfig/update`,n),ge=n=>_.get(`${m.contract}/authConfig/delete/${n}`),fe=n=>_.get(`${m.contract}/authConfig/queryAuthInfoByGroup/${n}`),Ve=n=>_.post(`${m.contract}/authConfig/addAuthRange`,n),qe=n=>_.post(`${m.contract}/authConfig/updateAuthRange`,n),ve=n=>_.get(`${m.contract}/authConfig/deleteAuthRangeById/${n}`),he=n=>_.get(`${m.contract}/authConfig/queryAuthUserListByGroupId/${n}`),Pe=n=>_.post(`${m.contract}/authConfig/addAuthUser`,n),be=n=>_.get(`${m.contract}/authConfig/deleteAuthUser/${n}`),ye=n=>_.get(`${m.contract}/authConfig/setAuthUserToGroupManager/${n}`),je=({onDownloadProgress:n}={})=>ce({params:{templateType:"COMPANY_INFO"},fileName:"权限配置经营单位导入模版.xlsx",onDownloadProgress:n}),Me=({data:n,onUploadProgress:u})=>_.upload(`${m.contract}/authConfig/importCompany`,{method:"POST",data:n,onUploadProgress:u}),Ge=()=>_.get(`${m.contract}/authConfig/queryAuthMenu`),Fe=()=>_.get(`${m.contract}/authConfig/queryContractBusinessType`),Ce={style:{padding:"12px"}},ke={style:{padding:"12px"}},Ae=Y({__name:"BizTypeScope",props:{group:{type:Object,required:!0}},setup(n,{expose:u}){const A=n,s=g({add:"AuthConfig:biz:add",edit:"AuthConfig:biz:edit",del:"AuthConfig:biz:del"});s.value.operate=H([s.value.edit,s.value.del]);const a=g([]),y=g([]),E=(p,r,i,C)=>i&&i.length>200?i.substring(0,300)+"...":i,z=()=>{!A.group||!A.group.id||fe(A.group.id).then(p=>{a.value=(p==null?void 0:p.sysGroupBizRel)||[],console.log(a.value)})},x=()=>{R({initData:{groupId:A.group.id}},()=>w(()=>import("./BizTypeScopeDailog-Dw5Qtc_Y.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))).then(()=>{z()})},O=p=>{R({initData:p},()=>w(()=>import("./BizTypeScopeDailog-Dw5Qtc_Y.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))).then(()=>{z()})},U=p=>{G.confirm("确定删除该条记录吗？","提示",{type:"warning"}).then(()=>{ve(p.id).then(()=>{M.success("删除成功"),z()})})};return ae(()=>{z()}),u({add(){x()}}),(p,r)=>{const i=l("el-table-column"),C=l("el-scrollbar"),D=l("el-button"),L=l("FsTable"),T=J("per");return h(),P("div",null,[e(L,{tableData:a.value,tableColumns:y.value},{default:t(()=>[e(i,{label:"业务场景",prop:"bizTypeName",width:"100px"}),e(i,{label:"经营单位",prop:"companyList","min-width":"240px",formatter:E},{default:t(({row:c})=>[e(C,{"max-height":"60px"},{default:t(()=>[b("div",Ce,K(c.companyList&&c.companyList.length>0&&c.companyList.map(o=>o.companyName).join(", ")),1)]),_:2},1024)]),_:1}),e(i,{label:"合同业务类型",prop:"contractBizTypeList","min-width":"240px",formatter:E},{default:t(({row:c})=>[e(C,{"max-height":"60px"},{default:t(()=>[b("div",ke,K(c.contractBizTypeList&&c.contractBizTypeList.length>0&&c.contractBizTypeList.map(o=>o.businessTypeName).join(", ")),1)]),_:2},1024)]),_:1}),s.value.operate?(h(),$(i,{key:0,label:"操作",prop:"id",width:"100px"},{default:t(({row:c})=>[k((h(),$(D,{type:"primary",link:"",size:f(v).actionSize,onClick:o=>O(c,p.$index)},{default:t(()=>r[0]||(r[0]=[S("编辑")])),_:2,__:[0]},1032,["size","onClick"])),[[T,s.value.edit]]),k((h(),$(D,{type:"primary",link:"",size:f(v).actionSize,onClick:o=>U(c,p.$index)},{default:t(()=>r[1]||(r[1]=[S("删除")])),_:2,__:[1]},1032,["size","onClick"])),[[T,s.value.del]])]),_:1})):j("",!0)]),_:1},8,["tableData","tableColumns"])])}}}),$e=Y({__name:"UserList",props:{group:{type:Object,required:!0}},emits:["setting-success"],setup(n,{expose:u,emit:A}){const s=n,a=g({add:"AuthConfig:user:add",setting:"AuthConfig:user:setting",del:"AuthConfig:user:del"});a.value.operate=H([a.value.setting,a.value.del]);const y=g([]),E=g([]),z=A,x=()=>{!s.group||!s.group.id||he(s.group.id).then(r=>{y.value=r})},O=()=>{R({group:s.group},()=>w(()=>import("./UserForm-CJHMVQ6M.js"),__vite__mapDeps([8,1,2,4,5,6]))).then(()=>{x()})},U=r=>{G.confirm("确定删除该条记录吗？","提示",{type:"warning"}).then(()=>{be(r.id).then(()=>{M.success("删除成功"),x()})})},p=r=>{G.confirm(`确定设置人员【${r.userName}】为该组联系人？`,"提示",{type:"warning"}).then(()=>{let i={...s.group,managerAccount:r.userAccount,managerName:r.userName};ye(r.id).then(()=>{M.success("设置成功"),x(),z("setting-success",i)})})};return ae(()=>{x()}),u({add(){O()}}),(r,i)=>{const C=l("el-table-column"),D=l("el-button"),L=l("FsTable"),T=J("per");return h(),P("div",null,[e(L,{tableData:y.value,tableColumns:E.value},{default:t(()=>[e(C,{label:"用户姓名",prop:"userName",minWidth:"140px"}),e(C,{label:"账号",prop:"userAccount",minWidth:"140px"}),a.value.operate?(h(),$(C,{key:0,label:"操作",prop:"id",width:"140px"},{default:t(({row:c})=>[c.userAccount!=n.group.managerAccount?k((h(),$(D,{key:0,type:"primary",link:"",size:f(v).actionSize,onClick:o=>p(c,r.$index)},{default:t(()=>i[0]||(i[0]=[S("设为负责人")])),_:2,__:[0]},1032,["size","onClick"])),[[T,a.value.setting]]):j("",!0),k((h(),$(D,{type:"primary",link:"",size:f(v).actionSize,onClick:o=>U(c,r.$index)},{default:t(()=>i[1]||(i[1]=[S("删除")])),_:2,__:[1]},1032,["size","onClick"])),[[T,a.value.del]])]),_:1})):j("",!0)]),_:1},8,["tableData","tableColumns"])])}}}),ze={class:"container-wrap"},xe={class:"padding-10"},De={class:"custom-tree-node"},Te={class:"padding-10"},Se={class:"tab-wrapper"},Ee={id:"addTeleport",class:"add-teleport"},Le={class:"tab-content-wrapper"},Be={class:"tab-content-wrapper"},N="AuthConfig",Ie=Y({name:N,__name:"index",setup(n){const u=g({add:`${N}:add`,edit:`${N}:edit`,del:`${N}:del`,bizAdd:`${N}:biz:add`,userAdd:`${N}:user:add`});u.value.operate=H([u.value.edit,u.value.del]),console.log(u.value);const A=g(null),s=g([]),a=g({}),y=()=>{me().then(o=>{!a.value.id&&o.length>0&&(a.value=o[0],A.value.setCurrentKey(o[0].id)),s.value=o,console.log("treeData",s.value)})};de(()=>{y()});const E=()=>{R({groupList:s.value,initData:{}},()=>w(()=>import("./FormDialog-Bh5vZ0fb.js"),__vite__mapDeps([9,1,2,4,5,6]))).then(o=>{y()})},z=o=>{R({groupList:s.value,initData:o},()=>w(()=>import("./FormDialog-Bh5vZ0fb.js"),__vite__mapDeps([9,1,2,4,5,6]))).then(d=>{y()})},x=o=>{R({groupList:s.value,initData:{parentId:o.id}},()=>w(()=>import("./FormDialog-Bh5vZ0fb.js"),__vite__mapDeps([9,1,2,4,5,6]))).then(d=>{y()})},O=o=>{G.confirm("确定删除该分组吗？","提示",{type:"warning"}).then(()=>{ge(o.id).then(()=>{M.success("删除成功"),o.id==a.id&&(a.value={}),y()})})},U=o=>{console.log(o),a.value=o},p=g({checkStrictly:!0,label:"name",value:"id"}),r=o=>{Object.assign(a.value,o||{})},i=g("1"),C=g(),D=()=>{C.value.add()},L=g(),T=()=>{L.value.add()},c=()=>{};return(o,d)=>{const X=l("el-col"),B=l("el-button"),Z=l("el-row"),ee=l("el-header"),le=l("el-tree"),F=l("el-main"),Q=l("el-container"),se=l("el-aside"),te=l("el-input"),W=l("el-form-item"),ie=l("el-cascader"),re=l("el-form"),ne=l("el-tab-pane"),ue=l("el-tabs"),I=J("per");return h(),P("div",ze,[e(Q,{class:"group-container"},{default:t(()=>[e(se,{width:"300px"},{default:t(()=>[e(Q,null,{default:t(()=>[e(ee,{class:"content-header",height:"46px"},{default:t(()=>[e(Z,{class:"padding-10",gutter:10},{default:t(()=>[e(X,{span:12},{default:t(()=>d[2]||(d[2]=[b("span",null,"数据权限",-1)])),_:1,__:[2]}),e(X,{span:12,style:{"text-align":"right"}},{default:t(()=>[k((h(),$(B,{type:"primary",size:f(v).actionSize,icon:f(v).icon.add,onClick:E},{default:t(()=>d[3]||(d[3]=[S("新增分组")])),_:1,__:[3]},8,["size","icon"])),[[I,u.value.add]])]),_:1})]),_:1})]),_:1}),e(F,null,{default:t(()=>[b("div",xe,[e(le,{ref_key:"treeRef",ref:A,"current-node-key":a.value.id,data:s.value,"expand-on-click-node":!1,label:"groupName","node-key":"id","default-expand-all":"","highlight-current":"",onCurrentChange:U},{default:t(({node:V,data:q})=>[b("span",De,[b("span",null,K(q.name),1),u.value.operate?(h(),P("span",{key:0,onClick:pe(c,["stop"])},[k(e(B,{type:"primary",link:"",icon:f(v).icon.add,title:"新增子分组",onClick:oe=>x(q)},null,8,["icon","onClick"]),[[I,u.value.add]]),k(e(B,{type:"primary",link:"",icon:f(v).icon.edit,title:"编辑分组",onClick:oe=>z(q)},null,8,["icon","onClick"]),[[I,u.value.edit]]),k(e(B,{type:"primary",link:"",icon:f(v).icon.delete,title:"删除分组",onClick:oe=>O(q)},null,8,["icon","onClick"]),[[I,u.value.del]])])):j("",!0)])]),_:1},8,["current-node-key","data"])])]),_:1})]),_:1})]),_:1}),e(F,{style:{overflow:"hidden"}},{default:t(()=>[e(Q,null,{default:t(()=>[e(ee,{height:"46px"},{default:t(()=>[e(Z,{class:"padding-10",gutter:10},{default:t(()=>d[4]||(d[4]=[b("span",null,"权限基础信息",-1)])),_:1,__:[4]})]),_:1}),e(F,null,{default:t(()=>[b("div",Te,[e(re,{inline:""},{default:t(()=>[e(W,{label:"名称"},{default:t(()=>[e(te,{"model-value":a.value.name,disabled:"",placeholder:"请输入名称"},null,8,["model-value"])]),_:1}),e(W,{label:"上级"},{default:t(()=>[e(ie,{"model-value":a.value.parentId,options:s.value,props:p.value,disabled:""},null,8,["model-value","options","props"])]),_:1}),e(W,{label:"负责人"},{default:t(()=>[e(te,{modelValue:a.value.managerName,"onUpdate:modelValue":d[0]||(d[0]=V=>a.value.managerName=V),disabled:"",placeholder:"请设置负责人"},null,8,["modelValue"])]),_:1})]),_:1}),b("div",Se,[b("span",Ee,[i.value==="1"?k((h(),$(B,{key:0,type:"primary",size:f(v).actionSize,icon:f(v).icon.add,onClick:D},{default:t(()=>d[5]||(d[5]=[S("添加数据权限范围")])),_:1,__:[5]},8,["size","icon"])),[[I,u.value.bizAdd]]):k((h(),$(B,{key:1,type:"primary",size:f(v).actionSize,icon:f(v).icon.add,onClick:T},{default:t(()=>d[6]||(d[6]=[S("添加成员信息")])),_:1,__:[6]},8,["size","icon"])),[[I,u.value.userAdd]])]),e(ue,{modelValue:i.value,"onUpdate:modelValue":d[1]||(d[1]=V=>i.value=V),class:"tabs-modify data-permission-tabs"},{default:t(()=>[e(ne,{label:"数据权限范围",name:"1"},{default:t(()=>[b("div",Le,[e(Ae,{ref_key:"scopeRef",ref:C,group:a.value},null,8,["group"])])]),_:1}),e(ne,{label:"成员信息",name:"2"},{default:t(()=>[b("div",Be,[e($e,{ref_key:"userRef",ref:L,group:a.value,onSettingSuccess:r},null,8,["group"])])]),_:1})]),_:1},8,["modelValue"])])])]),_:1})]),_:1})]),_:1})]),_:1})])}}}),Ne=_e(Ie,[["__scopeId","data-v-f5e6c122"]]),Qe=Object.freeze(Object.defineProperty({__proto__:null,default:Ne},Symbol.toStringTag,{value:"Module"}));export{Ue as a,Ge as b,Fe as c,Ve as d,qe as e,je as f,Oe as g,Me as h,he as i,Pe as j,Qe as k};
