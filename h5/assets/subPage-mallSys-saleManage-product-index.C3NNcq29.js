import{d as e,c as a,e as l,a9 as t,f as o,a as u,o as s,z as n,r,P as d,A as i,w as c,b as m,_ as v,aa as f,B as b,C as p,g as P,i as g,D as h,q as _,p as y,n as w,t as x,T as k,k as C,F as S,l as N,E as M,v as A,ab as F}from"./index-BvTRnY6x.js";import{g as B}from"./phones.CXKAVbyd.js";const $=n(e({__name:"index",props:{show:{type:Boolean},brands:{},selectedBrand:{},model:{},storage:{},color:{},modelMap:{},storages:{},colors:{}},emits:["update:show","confirm","change"],setup(e,{emit:n}){const r=e,d=n,i=a({get:()=>r.selectedBrand&&r.model&&r.storage&&r.color?[r.model,r.storage,r.color]:[],set(e){}}),c=a(()=>`${r.selectedBrand||""}-${i.value.join("-")}`),m=a(()=>{if(r.selectedBrand){return(r.modelMap[r.selectedBrand]||[]).map(e=>({label:e,value:e,children:r.storages.map(e=>({label:e,value:e,children:r.colors.map(e=>({label:e,value:e}))}))}))}return(r.brands||[]).map(e=>({label:e,value:e,children:(r.modelMap[e]||[]).map(e=>({label:e,value:e,children:r.storages.map(e=>({label:e,value:e,children:r.colors.map(e=>({label:e,value:e}))}))}))}))}),v=()=>{d("update:show",!1)},f=e=>{const a=Array.isArray(e)?e:e.value;a&&(r.selectedBrand?3===a.length&&d("confirm",{brand:r.selectedBrand,model:a[0],storage:a[1],color:a[2]}):4===a.length&&d("confirm",{brand:a[0],model:a[1],storage:a[2],color:a[3]}),d("update:show",!1))},b=e=>{d("change",e)};return(e,a)=>{const n=l(o("up-cascader"),t);return s(),u(n,{show:e.show,data:m.value,title:"请选择商品规格",closeable:!0,autoClose:!0,optionsCols:1,labelKey:"label",valueKey:"value",childrenKey:"children",key:c.value,"onUpdate:show":v,onClose:v,onConfirm:f,onChange:b,modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=e=>i.value=e)},null,8,["show","data","modelValue"])}}}),[["__scopeId","data-v-70193da3"]]),V=n(e({__name:"index",setup(e){const t=r(!1),n=r("new"),V=r({brand:"",model:"",storage:"",color:"",salePrice:0,guidePrice:0,installment:0,downPaymentAmount:"",downPaymentPercent:""});r(1);const U=r(null),z=r(!1);r(!1),r(!1),r(!1);const D=r(!1),G=r(!1),X=["Apple","Samsung","Huawei","Xiaomi"],H=r([X]),I={Apple:{"iPhone 15":{salePrice:5999,guidePrice:6999},"iPhone 15 Pro":{salePrice:7999,guidePrice:8999},"iPhone 15 Pro Max":{salePrice:9999,guidePrice:10999}},Samsung:{"Galaxy S24":{salePrice:5499,guidePrice:6499},"Galaxy S24 Ultra":{salePrice:8999,guidePrice:9999}},Huawei:{"Mate 60":{salePrice:6999,guidePrice:7999},P60:{salePrice:4999,guidePrice:5999}},Xiaomi:{"Xiaomi 14":{salePrice:3999,guidePrice:4999},"Xiaomi 14 Pro":{salePrice:4999,guidePrice:5999}}},j={Apple:["iPhone 15","iPhone 15 Pro","iPhone 15 Pro Max"],Samsung:["Galaxy S24","Galaxy S24 Ultra"],Huawei:["Mate 60","P60"],Xiaomi:["Xiaomi 14","Xiaomi 14 Pro"]};a(()=>{if(!V.value.brand)return[[]];return[j[V.value.brand]||[]]});const K=["128GB","256GB","512GB","1TB"];r([K]);const q=["黑色","白色","蓝色","紫色","金色"];r([q]);const E=r([[3,6,12,24].map(e=>`${e}期`)]),T=r("month"),Y=a(()=>V.value.installment?`${V.value.installment}期`:""),J=a(()=>!!(V.value.brand&&V.value.model&&V.value.storage&&V.value.color)),O=a(()=>{const e=Number(V.value.salePrice||0),a=Number(V.value.downPaymentAmount||0);if(a>0)return Number(a.toFixed(2));const l=Number(V.value.downPaymentPercent||0);return e>0&&l>0?Number((e*(l/100)).toFixed(2)):0}),R=a(()=>{if(!J.value||!V.value.installment)return"--";const e=Number(V.value.salePrice||0),a=O.value,l=Math.max(e-a,0),t=Number(V.value.installment||0);if(!t)return"0.00";const o=t-(a>0?1:0);return o<=0?"0.00":(l/o).toFixed(2)}),L=a(()=>{if(!J.value||!V.value.installment)return[];const e=Number(V.value.salePrice||0),a=O.value,l=Math.max(e-a,0),t=Number(V.value.installment||0);if(!t||e<=0)return[];const o=t-(a>0?1:0),u=o>0?Number((l/o).toFixed(2)):0,s=[];let n=0;const r=e=>{const a=["零","一","二","三","四","五","六","七","八","九"];return 10===e?"十":e<10?a[e]:e<20?"十"+a[e-10]:e%10==0?a[Math.floor(e/10)]+"十":a[Math.floor(e/10)]+"十"+a[e%10]},d=new Date,i=d.getFullYear(),c=String(d.getMonth()+1).padStart(2,"0"),m=String(d.getDate()).padStart(2,"0");a>0&&s.push({key:"first",label:"首付",date:`${i}-${c}-${m}`,amount:a.toFixed(2)});for(let v=1;v<=o;v++){const e=v===o?Number((l-n).toFixed(2)):u;n+=e;const t=new Date;"week"===T.value?t.setDate(t.getDate()+7*v):t.setMonth(t.getMonth()+v);const d=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),c=String(t.getDate()).padStart(2,"0"),m=a>0?v+1:v;s.push({key:`p-${v}`,label:`第${r(m)}期`,date:`${d}-${i}-${c}`,amount:e.toFixed(2)})}return s}),Q=a(()=>"week"===T.value?"每周应付":"每月应付"),W={width:"100%",height:"50rpx",lineHeight:"100rpx",backgroundColor:"transparent",padding:"0",fontSize:"28rpx"},Z={width:"100%",height:"50rpx",backgroundColor:"transparent",padding:"0",fontSize:"28rpx"},ee=r(!1);d(()=>V.value.downPaymentAmount,e=>{if(ee.value)return;const a=Number(V.value.salePrice||0),l=Number(e||0);if(a>0){if(ee.value=!0,l>0){const e=l/a*100;V.value.downPaymentPercent=e.toFixed(2)}else V.value.downPaymentPercent="";F(()=>{ee.value=!1})}}),d(()=>V.value.downPaymentPercent,e=>{if(ee.value)return;const a=Number(V.value.salePrice||0),l=Number(e||0);if(a>0){if(ee.value=!0,l>0){const e=a*l/100;V.value.downPaymentAmount=e.toFixed(2)}else V.value.downPaymentAmount="";F(()=>{ee.value=!1})}}),d(()=>V.value.salePrice,e=>{const a=Number(e||0);if(!a)return V.value.downPaymentAmount="",void(V.value.downPaymentPercent="");const l=Number(V.value.downPaymentPercent||0),t=Number(V.value.downPaymentAmount||0);if(l>0){const e=a*l/100;V.value.downPaymentAmount=e?e.toFixed(2):""}else if(t>0){const e=t/a*100;V.value.downPaymentPercent=e?e.toFixed(2):""}});const ae=()=>{V.value.brand?D.value=!0:M({title:"请先选择品牌",icon:"none"})},le=()=>{V.value.model="",V.value.storage="",V.value.color="",V.value.salePrice=0,V.value.guidePrice=0,V.value.installment=0},te=()=>{V.value.brand?V.value.model?V.value.storage?V.value.color?G.value=!0:M({title:"请先选择颜色",icon:"none"}):M({title:"请先选择内存",icon:"none"}):M({title:"请先选择型号",icon:"none"}):M({title:"请先选择品牌",icon:"none"})},oe=e=>{V.value.brand=e.value[0],V.value.model="",V.value.storage="",V.value.color="",V.value.salePrice=0,V.value.guidePrice=0,V.value.installment=0,z.value=!1},ue=e=>{var a;if(V.value.model=e.model,V.value.storage=e.storage,V.value.color=e.color,V.value.installment=0,V.value.brand&&V.value.model){const e=null==(a=I[V.value.brand])?void 0:a[V.value.model];e&&(V.value.salePrice=e.salePrice,V.value.guidePrice=e.guidePrice)}},se=e=>{const a=e.value[0],l=parseInt(a);if(V.value.installment=l,V.value.salePrice&&l){const e=Number(V.value.salePrice),a=e-Math.floor(e/l*100)/100*(l-1);V.value.downPaymentAmount=a.toFixed(2)}G.value=!1},ne=()=>{if(!(V.value.brand&&V.value.model&&V.value.storage&&V.value.color))return void M({title:"请完善商品信息",icon:"none"});if(!V.value.salePrice)return void M({title:"请填写售价",icon:"none"});if(!V.value.installment)return void M({title:"请选择期数",icon:"none"});const e=encodeURIComponent(JSON.stringify(V.value)),a=null!=U.value?`&id=${U.value}`:"";A({url:`/subPage/mallSys/saleManage/product/qrCode?form=${e}${a}`})};return i(e=>{if(e.id){U.value=Number(e.id);const a=B(e.id);a&&(V.value.brand=a.brand,V.value.model=a.name,V.value.salePrice=a.price,V.value.guidePrice=a.price+1e3,V.value.storage=e.storage||e.memory||K[0],V.value.color=e.color||q[0],V.value.installment=12)}}),(e,a)=>{const r=m("b-navbar"),d=g,i=w,M=l(o("up-icon"),v),A=l(o("up-input"),f),F=l(o("up-button"),b),B=l(o("up-picker"),p),U=m("head-top");return s(),u(U,{loading:t.value,is_footer_mar:!1},{default:c(()=>[P(d,{class:"order-container"},{default:c(()=>[P(r,{title:"快速下单"}),P(d,{class:_(["type-tabs",{right:"old"==n.value}])},{default:c(()=>[P(d,{class:_(["tab","new"===n.value?"active":""]),onClick:a[0]||(a[0]=e=>n.value="new")},{default:c(()=>[y("新机")]),_:1},8,["class"]),P(d,{class:_(["tab","old"===n.value?"active":""]),onClick:a[1]||(a[1]=e=>n.value="old")},{default:c(()=>[y("旧机")]),_:1},8,["class"])]),_:1},8,["class"]),P(d,{class:"card"},{default:c(()=>[P(d,{class:"card-title"},{default:c(()=>[y("商品信息")]),_:1}),P(d,{class:"product-form"},{default:c(()=>[P(d,{class:"form-item",onClick:a[2]||(a[2]=e=>z.value=!0)},{default:c(()=>[P(d,{class:"form-label"},{default:c(()=>[y("品牌")]),_:1}),P(d,{class:"input-box"},{default:c(()=>[P(i,{class:_(["input-text",{placeholder:!V.value.brand}])},{default:c(()=>[y(x(V.value.brand||"请选择品牌"),1)]),_:1},8,["class"]),P(M,{name:"arrow-down",size:"16",color:"#909399"})]),_:1})]),_:1}),P(d,{class:"form-item",onClick:ae},{default:c(()=>[P(d,{class:"form-label"},{default:c(()=>[y("型号+颜色+内存")]),_:1}),P(d,{class:_(["input-box",{disabled:!V.value.brand}])},{default:c(()=>[P(i,{class:_(["input-text",{placeholder:!V.value.model}])},{default:c(()=>[y(x(V.value.model?V.value.model+"/"+V.value.storage+"/"+V.value.color:"请选择型号"),1)]),_:1},8,["class"]),V.value.model?(s(),u(d,{key:0,onClick:k(le,["stop"]),style:{padding:"10rpx"}},{default:c(()=>[P(M,{name:"close-circle-fill",size:"16",color:"#909399"})]),_:1})):(s(),u(M,{key:1,name:"arrow-down",size:"16",color:"#909399"}))]),_:1},8,["class"])]),_:1})]),_:1})]),_:1}),P(d,{class:"card"},{default:c(()=>[P(d,{class:"card-title"},{default:c(()=>[y("订单金额")]),_:1}),P(d,{class:"discount-grid"},{default:c(()=>[P(d,{class:"discount-item"},{default:c(()=>[P(d,{class:"label"},{default:c(()=>[y("售价：")]),_:1}),P(d,{class:_(["input-box",{disabled:!J.value}])},{default:c(()=>[P(A,{modelValue:V.value.salePrice,"onUpdate:modelValue":a[3]||(a[3]=e=>V.value.salePrice=e),type:"number",placeholder:"请输入售价",border:"none",disabled:!J.value,customStyle:W},null,8,["modelValue","disabled"])]),_:1},8,["class"])]),_:1}),P(d,{class:"discount-item"},{default:c(()=>[P(d,{class:"label"},{default:c(()=>[y("指导价：")]),_:1}),P(d,{class:"guide-display"},{default:c(()=>[y(x(J.value&&V.value.guidePrice?"¥"+Number(V.value.guidePrice).toFixed(2):"--"),1)]),_:1})]),_:1})]),_:1})]),_:1}),P(d,{class:"card"},{default:c(()=>[P(d,{class:"card-title"},{default:c(()=>[y("购机还款计划")]),_:1}),P(d,{class:"discount-grid"},{default:c(()=>[P(d,{class:"discount-item"},{default:c(()=>[P(d,{class:"label"},{default:c(()=>[y("还款类型：")]),_:1}),P(d,{class:"repay-type"},{default:c(()=>[P(d,{class:_(["repay-tag","month"===T.value?"active":""]),onClick:a[4]||(a[4]=e=>T.value="month")},{default:c(()=>[y(" 每月 ")]),_:1},8,["class"]),P(d,{class:_(["repay-tag","week"===T.value?"active":""]),onClick:a[5]||(a[5]=e=>T.value="week")},{default:c(()=>[y(" 每周 ")]),_:1},8,["class"])]),_:1})]),_:1}),P(d,{class:"discount-item"},{default:c(()=>[P(d,{class:"label"},{default:c(()=>[y("首付金额：")]),_:1}),P(d,{class:_(["input-box",{disabled:!J.value}])},{default:c(()=>[P(A,{modelValue:V.value.downPaymentAmount,"onUpdate:modelValue":a[6]||(a[6]=e=>V.value.downPaymentAmount=e),type:"number",placeholder:"请输入首付金额",border:"none",disabled:!J.value,customStyle:Z},null,8,["modelValue","disabled"])]),_:1},8,["class"])]),_:1}),P(d,{class:"discount-item",onClick:te},{default:c(()=>[P(d,{class:"label"},{default:c(()=>[y("期数：")]),_:1}),P(d,{class:_(["input-box",{disabled:!J.value}])},{default:c(()=>[P(i,{class:_(["input-text",{placeholder:!Y.value}])},{default:c(()=>[y(x(Y.value||"选择期数"),1)]),_:1},8,["class"]),P(M,{name:"arrow-down",size:"16",color:"#909399"})]),_:1},8,["class"])]),_:1}),P(d,{class:"discount-item"},{default:c(()=>[P(d,{class:"label"},{default:c(()=>[y("首付金额占比：")]),_:1}),P(d,{class:_(["input-box",{disabled:!J.value}])},{default:c(()=>[P(A,{modelValue:V.value.downPaymentPercent,"onUpdate:modelValue":a[7]||(a[7]=e=>V.value.downPaymentPercent=e),type:"number",placeholder:"例如 20 表示 20%",border:"none",disabled:!J.value,customStyle:Z},null,8,["modelValue","disabled"]),y("% ")]),_:1},8,["class"])]),_:1})]),_:1}),J.value&&V.value.installment?(s(),u(d,{key:0,class:"period-summary"},{default:c(()=>[P(i,null,{default:c(()=>[y(x(Q.value),1)]),_:1}),P(i,{class:"amount"},{default:c(()=>[y(x("--"!==R.value?"¥"+R.value:"--"),1)]),_:1})]),_:1})):h("",!0)]),_:1}),L.value.length?(s(),u(d,{key:0,class:"card"},{default:c(()=>[P(d,{class:"card-title"},{default:c(()=>[y("账单明细")]),_:1}),P(d,{class:"bill-list"},{default:c(()=>[(s(!0),C(S,null,N(L.value,e=>(s(),u(d,{class:"bill-item",key:e.key},{default:c(()=>[P(d,{class:"bill-left"},{default:c(()=>[P(d,{class:"bill-title"},{default:c(()=>[y(x(e.label),1)]),_:2},1024),P(d,{class:"bill-date"},{default:c(()=>[y(x(e.date),1)]),_:2},1024)]),_:2},1024),P(d,{class:"bill-amount"},{default:c(()=>[y("¥"+x(e.amount),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):h("",!0),P(d,{class:"bottom-bar"},{default:c(()=>[P(F,{type:"primary",text:"生成二维码",onClick:ne,customStyle:{width:"100%",height:"44px"}})]),_:1}),P(B,{show:z.value,columns:H.value,onConfirm:oe,onCancel:a[8]||(a[8]=e=>z.value=!1)},null,8,["show","columns"]),P($,{show:D.value,"onUpdate:show":a[9]||(a[9]=e=>D.value=e),brands:X,selectedBrand:V.value.brand,model:V.value.model,storage:V.value.storage,color:V.value.color,modelMap:j,storages:K,colors:q,onConfirm:ue},null,8,["show","selectedBrand","model","storage","color"]),P(B,{show:G.value,columns:E.value,onConfirm:se,onCancel:a[10]||(a[10]=e=>G.value=!1)},null,8,["show","columns"])]),_:1})]),_:1},8,["loading"])}}}),[["__scopeId","data-v-4df422f2"]]);export{V as default};
