import{d as e,r as a,K as l,M as s,O as t,a as o,w as c,P as u,i as d,o as n,g as i,n as r,q as m,I as f,p,s as _,t as v,Q as k,R as x,v as w,T as b,E as g,A as C}from"./index-DrDFWzXK.js";import{U as h,P as y}from"./PrivacyPolicy.BymknM9S.js";const V=C(e({__name:"index",setup(e){const C=a(!1),V=a("password"),T=a(!1),P=a(0),U=a(!1),A=a(""),$=a("success"),z=a(!1),I=a(!1),Z=l({account:"",password:""}),j=l({email:"",code:""}),q=l({email:"",code:"",newPassword:""}),B=e=>{u({title:e})};s(V,e=>{"password"===e||"code"===e?B("登录"):"forgot"===e&&B("忘记密码")}),t(()=>{B("登录")});const E=()=>{V.value="password"===V.value?"code":"password"},K=()=>{V.value="forgot"},M=()=>{V.value="password"},O=()=>{T.value=!T.value},Q=()=>{z.value=!0},R=()=>{I.value=!0},D=()=>{z.value=!1,T.value=!0},F=()=>{I.value=!1,T.value=!0},G=()=>{P.value>0||(j.email?ae(j.email)?(ee("验证码已发送"),J()):ee("请输入正确的邮箱格式"):ee("请输入邮箱"))},H=()=>{P.value>0||(q.email?ae(q.email)?(ee("验证码已发送"),J()):ee("请输入正确的邮箱格式"):ee("请输入邮箱"))},J=()=>{P.value=60;const e=setInterval(()=>{P.value--,P.value<=0&&clearInterval(e)},1e3)},L=async()=>{if(T.value)if(Z.account){if(Z.password)return"admin"===Z.account?"123456"===Z.password?(ee("登录成功"),x("Token","admin_token"),void setTimeout(()=>{w({url:"/pages/userApp/my/index"})},500)):void ee("密码错误"):void(ae(Z.account)?(C.value=!0,setTimeout(()=>{if(C.value=!1,"correct_password"!==Z.password)return A.value="密码错误或用户不存在\n请使用邮箱验证码登录",$.value="error",void(U.value=!0);ee("登录成功"),x("Token","user_token"),setTimeout(()=>{b({url:"/pages/index/index"})},500)},1e3)):ee("请输入正确的邮箱格式"));ee("请输入密码")}else ee("请输入邮箱");else ee("请先阅读并同意用户协议和隐私协议")},N=async()=>{T.value?j.email?ae(j.email)?j.code?(C.value=!0,setTimeout(()=>{C.value=!1,ee("登录成功"),setTimeout(()=>{b({url:"/pages/index/index"})},500)},1e3)):ee("请输入验证码"):ee("请输入正确的邮箱格式"):ee("请输入邮箱"):ee("请先阅读并同意用户协议和隐私协议")},S=async()=>{T.value?q.email?ae(q.email)?q.code?q.newPassword?le(q.newPassword)?(C.value=!0,setTimeout(()=>{C.value=!1,ee("密码重置成功"),setTimeout(()=>{V.value="password",Z.account=q.email,Z.password=""},500)},1e3)):ee("密码格式不正确，需8~25位，含数字、字母、符号"):ee("请输入新密码"):ee("请输入验证码"):ee("请输入正确的邮箱格式"):ee("请输入邮箱"):ee("请先阅读并同意用户协议和隐私协议")},W=()=>{U.value=!1,V.value="code",j.email=Z.account},X=()=>{U.value=!1,Z.account="",Z.password=""},Y=()=>{U.value=!1},ee=e=>{g({title:e,icon:"none",duration:2e3})},ae=e=>/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(e),le=e=>/^(?=.*[0-9])(?=.*[a-zA-Z])(?=.*[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]).{8,25}$/.test(e);return(e,a)=>{const l=d,s=f,t=p;return n(),o(l,{class:"login-container"},{default:c(()=>[i(l,{class:"login-content"},{default:c(()=>[i(l,{class:"login-title"},{default:c(()=>[m("登录")]),_:1}),"password"===V.value?(n(),o(l,{key:0,class:"login-form"},{default:c(()=>[i(l,{class:"input-item"},{default:c(()=>[i(s,{modelValue:Z.account,"onUpdate:modelValue":a[0]||(a[0]=e=>Z.account=e),class:"input",placeholder:"请输入邮箱",type:"text"},null,8,["modelValue"])]),_:1}),i(l,{class:"input-item"},{default:c(()=>[i(s,{modelValue:Z.password,"onUpdate:modelValue":a[1]||(a[1]=e=>Z.password=e),class:"input",placeholder:"请输入密码",password:!0,type:"text"},null,8,["modelValue"])]),_:1}),i(l,{class:"forgot-password",onClick:K},{default:c(()=>[i(t,{class:"forgot-text"},{default:c(()=>[m("忘记密码")]),_:1})]),_:1}),i(l,{class:"agreement-box"},{default:c(()=>[i(l,{class:"checkbox-wrapper",onClick:O},{default:c(()=>[i(l,{class:_(["checkbox",{checked:T.value}])},{default:c(()=>[T.value?(n(),o(t,{key:0,class:"check-icon"},{default:c(()=>[m("✓")]),_:1})):r("",!0)]),_:1},8,["class"]),i(t,{class:"agreement-text"},{default:c(()=>[m("已阅读并同意")]),_:1})]),_:1}),i(t,{class:"link-text",onClick:Q},{default:c(()=>[m("《用户协议》")]),_:1}),i(t,{class:"agreement-text"},{default:c(()=>[m("和")]),_:1}),i(t,{class:"link-text",onClick:R},{default:c(()=>[m("《隐私协议》")]),_:1})]),_:1}),i(l,{class:"btn-login",onClick:L},{default:c(()=>[i(t,{class:"btn-text"},{default:c(()=>[m("登录")]),_:1})]),_:1}),i(l,{class:"switch-login",onClick:E},{default:c(()=>[i(t,{class:"switch-text"},{default:c(()=>[m("使用验证码登录")]),_:1})]),_:1})]),_:1})):r("",!0),"code"===V.value?(n(),o(l,{key:1,class:"login-form"},{default:c(()=>[i(l,{class:"input-item"},{default:c(()=>[i(s,{modelValue:j.email,"onUpdate:modelValue":a[2]||(a[2]=e=>j.email=e),class:"input",placeholder:"请输入邮箱",type:"text"},null,8,["modelValue"])]),_:1}),i(l,{class:"input-item code-input"},{default:c(()=>[i(s,{modelValue:j.code,"onUpdate:modelValue":a[3]||(a[3]=e=>j.code=e),class:"input flex-1",placeholder:"请输入验证码",type:"text"},null,8,["modelValue"]),i(l,{class:_(["code-btn",{disabled:P.value>0}]),onClick:G},{default:c(()=>[i(t,{class:"code-btn-text"},{default:c(()=>[m(v(P.value>0?`${P.value}s`:"获取验证码"),1)]),_:1})]),_:1},8,["class"])]),_:1}),i(l,{class:"agreement-box"},{default:c(()=>[i(l,{class:"checkbox-wrapper",onClick:O},{default:c(()=>[i(l,{class:_(["checkbox",{checked:T.value}])},{default:c(()=>[T.value?(n(),o(t,{key:0,class:"check-icon"},{default:c(()=>[m("✓")]),_:1})):r("",!0)]),_:1},8,["class"]),i(t,{class:"agreement-text"},{default:c(()=>[m("已阅读并同意")]),_:1})]),_:1}),i(t,{class:"link-text",onClick:Q},{default:c(()=>[m("《用户协议》")]),_:1}),i(t,{class:"agreement-text"},{default:c(()=>[m("和")]),_:1}),i(t,{class:"link-text",onClick:R},{default:c(()=>[m("《隐私协议》")]),_:1})]),_:1}),i(l,{class:"btn-login",onClick:N},{default:c(()=>[i(t,{class:"btn-text"},{default:c(()=>[m("登录")]),_:1})]),_:1}),i(l,{class:"switch-login",onClick:E},{default:c(()=>[i(t,{class:"switch-text"},{default:c(()=>[m("使用密码登录")]),_:1})]),_:1})]),_:1})):r("",!0),"forgot"===V.value?(n(),o(l,{key:2,class:"login-form"},{default:c(()=>[i(l,{class:"input-item"},{default:c(()=>[i(s,{modelValue:q.email,"onUpdate:modelValue":a[4]||(a[4]=e=>q.email=e),class:"input",placeholder:"请输入邮箱",type:"text"},null,8,["modelValue"])]),_:1}),i(l,{class:"input-item code-input"},{default:c(()=>[i(s,{modelValue:q.code,"onUpdate:modelValue":a[5]||(a[5]=e=>q.code=e),class:"input flex-1",placeholder:"请输入验证码",type:"text"},null,8,["modelValue"]),i(l,{class:_(["code-btn",{disabled:P.value>0}]),onClick:H},{default:c(()=>[i(t,{class:"code-btn-text"},{default:c(()=>[m(v(P.value>0?`${P.value}s`:"获取验证码"),1)]),_:1})]),_:1},8,["class"])]),_:1}),i(l,{class:"input-item"},{default:c(()=>[i(s,{modelValue:q.newPassword,"onUpdate:modelValue":a[6]||(a[6]=e=>q.newPassword=e),class:"input",placeholder:"请输入新密码（8~25位，含数字、字母、符号）",password:!0,type:"text"},null,8,["modelValue"])]),_:1}),i(l,{class:"agreement-box"},{default:c(()=>[i(l,{class:"checkbox-wrapper",onClick:O},{default:c(()=>[i(l,{class:_(["checkbox",{checked:T.value}])},{default:c(()=>[T.value?(n(),o(t,{key:0,class:"check-icon"},{default:c(()=>[m("✓")]),_:1})):r("",!0)]),_:1},8,["class"]),i(t,{class:"agreement-text"},{default:c(()=>[m("已阅读并同意")]),_:1})]),_:1}),i(t,{class:"link-text",onClick:Q},{default:c(()=>[m("《用户协议》")]),_:1}),i(t,{class:"agreement-text"},{default:c(()=>[m("和")]),_:1}),i(t,{class:"link-text",onClick:R},{default:c(()=>[m("《隐私协议》")]),_:1})]),_:1}),i(l,{class:"btn-confirm",onClick:S},{default:c(()=>[i(t,{class:"btn-text"},{default:c(()=>[m("确认")]),_:1})]),_:1}),i(l,{class:"btn-back",onClick:M},{default:c(()=>[i(t,{class:"btn-back-text"},{default:c(()=>[m("返回")]),_:1})]),_:1})]),_:1})):r("",!0)]),_:1}),U.value?(n(),o(l,{key:0,class:"modal-mask",onClick:Y},{default:c(()=>[i(l,{class:"modal-content",onClick:a[7]||(a[7]=k(()=>{},["stop"]))},{default:c(()=>[i(l,{class:"modal-text"},{default:c(()=>[m(v(A.value),1)]),_:1}),"error"===$.value?(n(),o(l,{key:0,class:"modal-actions"},{default:c(()=>[i(l,{class:"modal-btn primary",onClick:W},{default:c(()=>[i(t,{class:"modal-btn-text"},{default:c(()=>[m("邮箱验证码登录")]),_:1})]),_:1}),i(l,{class:"modal-btn",onClick:X},{default:c(()=>[i(t,{class:"modal-btn-text"},{default:c(()=>[m("换个邮箱试试")]),_:1})]),_:1})]),_:1})):r("",!0)]),_:1})]),_:1})):r("",!0),i(h,{visible:z.value,onClose:a[8]||(a[8]=e=>z.value=!1),onConfirm:D},null,8,["visible"]),i(y,{visible:I.value,onClose:a[9]||(a[9]=e=>I.value=!1),onConfirm:F},null,8,["visible"])]),_:1})}}}),[["__scopeId","data-v-56c605c3"]]);export{V as default};
