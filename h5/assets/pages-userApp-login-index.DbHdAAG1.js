import{d as e,r as l,E as a,J as s,K as t,c as o,w as c,L as u,i as d,o as n,f as i,l as r,n as m,I as f,m as p,p as _,t as v,M as k,O as x,q as w,P as b,A as g,u as C}from"./index-Bk2owZ7A.js";import{U as h,P as y}from"./PrivacyPolicy.C4es17w7.js";const V=C(e({__name:"index",setup(e){const C=l(!1),V=l("password"),P=l(!1),T=l(0),U=l(!1),A=l(""),z=l("success"),$=l(!1),I=l(!1),Z=a({account:"",password:""}),j=a({email:"",code:""}),q=a({email:"",code:"",newPassword:""}),E=e=>{u({title:e})};s(V,e=>{"password"===e||"code"===e?E("登录"):"forgot"===e&&E("忘记密码")}),t(()=>{E("登录")});const J=()=>{V.value="password"===V.value?"code":"password"},K=()=>{V.value="forgot"},L=()=>{V.value="password"},M=()=>{P.value=!P.value},O=()=>{$.value=!0},B=()=>{I.value=!0},D=()=>{$.value=!1,P.value=!0},F=()=>{I.value=!1,P.value=!0},G=()=>{T.value>0||(j.email?le(j.email)?(ee("验证码已发送"),N()):ee("请输入正确的邮箱格式"):ee("请输入邮箱"))},H=()=>{T.value>0||(q.email?le(q.email)?(ee("验证码已发送"),N()):ee("请输入正确的邮箱格式"):ee("请输入邮箱"))},N=()=>{T.value=60;const e=setInterval(()=>{T.value--,T.value<=0&&clearInterval(e)},1e3)},Q=async()=>{if(P.value)if(Z.account){if(Z.password)return"admin"===Z.account?"123456"===Z.password?(ee("登录成功"),x("Token","admin_token"),void setTimeout(()=>{w({url:"/pages/userApp/my/index"})},500)):void ee("密码错误"):void(le(Z.account)?(C.value=!0,setTimeout(()=>{if(C.value=!1,"correct_password"!==Z.password)return A.value="密码错误或用户不存在\n请使用邮箱验证码登录",z.value="error",void(U.value=!0);ee("登录成功"),x("Token","user_token"),setTimeout(()=>{b({url:"/pages/index/index"})},500)},1e3)):ee("请输入正确的邮箱格式"));ee("请输入密码")}else ee("请输入邮箱");else ee("请先阅读并同意用户协议和隐私协议")},R=async()=>{P.value?j.email?le(j.email)?j.code?(C.value=!0,setTimeout(()=>{C.value=!1,ee("登录成功"),setTimeout(()=>{b({url:"/pages/index/index"})},500)},1e3)):ee("请输入验证码"):ee("请输入正确的邮箱格式"):ee("请输入邮箱"):ee("请先阅读并同意用户协议和隐私协议")},S=async()=>{P.value?q.email?le(q.email)?q.code?q.newPassword?ae(q.newPassword)?(C.value=!0,setTimeout(()=>{C.value=!1,ee("密码重置成功"),setTimeout(()=>{V.value="password",Z.account=q.email,Z.password=""},500)},1e3)):ee("密码格式不正确，需8~25位，含数字、字母、符号"):ee("请输入新密码"):ee("请输入验证码"):ee("请输入正确的邮箱格式"):ee("请输入邮箱"):ee("请先阅读并同意用户协议和隐私协议")},W=()=>{U.value=!1,V.value="code",j.email=Z.account},X=()=>{U.value=!1,Z.account="",Z.password=""},Y=()=>{U.value=!1},ee=e=>{g({title:e,icon:"none",duration:2e3})},le=e=>/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(e),ae=e=>/^(?=.*[0-9])(?=.*[a-zA-Z])(?=.*[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]).{8,25}$/.test(e);return(e,l)=>{const a=d,s=f,t=p;return n(),o(a,{class:"login-container"},{default:c(()=>[i(a,{class:"login-content"},{default:c(()=>[i(a,{class:"login-title"},{default:c(()=>[m("登录")]),_:1}),"password"===V.value?(n(),o(a,{key:0,class:"login-form"},{default:c(()=>[i(a,{class:"input-item"},{default:c(()=>[i(s,{modelValue:Z.account,"onUpdate:modelValue":l[0]||(l[0]=e=>Z.account=e),class:"input",placeholder:"请输入邮箱",type:"text"},null,8,["modelValue"])]),_:1}),i(a,{class:"input-item"},{default:c(()=>[i(s,{modelValue:Z.password,"onUpdate:modelValue":l[1]||(l[1]=e=>Z.password=e),class:"input",placeholder:"请输入密码",password:!0,type:"text"},null,8,["modelValue"])]),_:1}),i(a,{class:"forgot-password",onClick:K},{default:c(()=>[i(t,{class:"forgot-text"},{default:c(()=>[m("忘记密码")]),_:1})]),_:1}),i(a,{class:"agreement-box"},{default:c(()=>[i(a,{class:"checkbox-wrapper",onClick:M},{default:c(()=>[i(a,{class:_(["checkbox",{checked:P.value}])},{default:c(()=>[P.value?(n(),o(t,{key:0,class:"check-icon"},{default:c(()=>[m("✓")]),_:1})):r("",!0)]),_:1},8,["class"]),i(t,{class:"agreement-text"},{default:c(()=>[m("已阅读并同意")]),_:1})]),_:1}),i(t,{class:"link-text",onClick:O},{default:c(()=>[m("《用户协议》")]),_:1}),i(t,{class:"agreement-text"},{default:c(()=>[m("和")]),_:1}),i(t,{class:"link-text",onClick:B},{default:c(()=>[m("《隐私协议》")]),_:1})]),_:1}),i(a,{class:"btn-login",onClick:Q},{default:c(()=>[i(t,{class:"btn-text"},{default:c(()=>[m("登录")]),_:1})]),_:1}),i(a,{class:"switch-login",onClick:J},{default:c(()=>[i(t,{class:"switch-text"},{default:c(()=>[m("使用验证码登录")]),_:1})]),_:1})]),_:1})):r("",!0),"code"===V.value?(n(),o(a,{key:1,class:"login-form"},{default:c(()=>[i(a,{class:"input-item"},{default:c(()=>[i(s,{modelValue:j.email,"onUpdate:modelValue":l[2]||(l[2]=e=>j.email=e),class:"input",placeholder:"请输入邮箱",type:"text"},null,8,["modelValue"])]),_:1}),i(a,{class:"input-item code-input"},{default:c(()=>[i(s,{modelValue:j.code,"onUpdate:modelValue":l[3]||(l[3]=e=>j.code=e),class:"input flex-1",placeholder:"请输入验证码",type:"text"},null,8,["modelValue"]),i(a,{class:_(["code-btn",{disabled:T.value>0}]),onClick:G},{default:c(()=>[i(t,{class:"code-btn-text"},{default:c(()=>[m(v(T.value>0?`${T.value}s`:"获取验证码"),1)]),_:1})]),_:1},8,["class"])]),_:1}),i(a,{class:"agreement-box"},{default:c(()=>[i(a,{class:"checkbox-wrapper",onClick:M},{default:c(()=>[i(a,{class:_(["checkbox",{checked:P.value}])},{default:c(()=>[P.value?(n(),o(t,{key:0,class:"check-icon"},{default:c(()=>[m("✓")]),_:1})):r("",!0)]),_:1},8,["class"]),i(t,{class:"agreement-text"},{default:c(()=>[m("已阅读并同意")]),_:1})]),_:1}),i(t,{class:"link-text",onClick:O},{default:c(()=>[m("《用户协议》")]),_:1}),i(t,{class:"agreement-text"},{default:c(()=>[m("和")]),_:1}),i(t,{class:"link-text",onClick:B},{default:c(()=>[m("《隐私协议》")]),_:1})]),_:1}),i(a,{class:"btn-login",onClick:R},{default:c(()=>[i(t,{class:"btn-text"},{default:c(()=>[m("登录")]),_:1})]),_:1}),i(a,{class:"switch-login",onClick:J},{default:c(()=>[i(t,{class:"switch-text"},{default:c(()=>[m("使用密码登录")]),_:1})]),_:1})]),_:1})):r("",!0),"forgot"===V.value?(n(),o(a,{key:2,class:"login-form"},{default:c(()=>[i(a,{class:"input-item"},{default:c(()=>[i(s,{modelValue:q.email,"onUpdate:modelValue":l[4]||(l[4]=e=>q.email=e),class:"input",placeholder:"请输入邮箱",type:"text"},null,8,["modelValue"])]),_:1}),i(a,{class:"input-item code-input"},{default:c(()=>[i(s,{modelValue:q.code,"onUpdate:modelValue":l[5]||(l[5]=e=>q.code=e),class:"input flex-1",placeholder:"请输入验证码",type:"text"},null,8,["modelValue"]),i(a,{class:_(["code-btn",{disabled:T.value>0}]),onClick:H},{default:c(()=>[i(t,{class:"code-btn-text"},{default:c(()=>[m(v(T.value>0?`${T.value}s`:"获取验证码"),1)]),_:1})]),_:1},8,["class"])]),_:1}),i(a,{class:"input-item"},{default:c(()=>[i(s,{modelValue:q.newPassword,"onUpdate:modelValue":l[6]||(l[6]=e=>q.newPassword=e),class:"input",placeholder:"请输入新密码（8~25位，含数字、字母、符号）",password:!0,type:"text"},null,8,["modelValue"])]),_:1}),i(a,{class:"agreement-box"},{default:c(()=>[i(a,{class:"checkbox-wrapper",onClick:M},{default:c(()=>[i(a,{class:_(["checkbox",{checked:P.value}])},{default:c(()=>[P.value?(n(),o(t,{key:0,class:"check-icon"},{default:c(()=>[m("✓")]),_:1})):r("",!0)]),_:1},8,["class"]),i(t,{class:"agreement-text"},{default:c(()=>[m("已阅读并同意")]),_:1})]),_:1}),i(t,{class:"link-text",onClick:O},{default:c(()=>[m("《用户协议》")]),_:1}),i(t,{class:"agreement-text"},{default:c(()=>[m("和")]),_:1}),i(t,{class:"link-text",onClick:B},{default:c(()=>[m("《隐私协议》")]),_:1})]),_:1}),i(a,{class:"btn-confirm",onClick:S},{default:c(()=>[i(t,{class:"btn-text"},{default:c(()=>[m("确认")]),_:1})]),_:1}),i(a,{class:"btn-back",onClick:L},{default:c(()=>[i(t,{class:"btn-back-text"},{default:c(()=>[m("返回")]),_:1})]),_:1})]),_:1})):r("",!0)]),_:1}),U.value?(n(),o(a,{key:0,class:"modal-mask",onClick:Y},{default:c(()=>[i(a,{class:"modal-content",onClick:l[7]||(l[7]=k(()=>{},["stop"]))},{default:c(()=>[i(a,{class:"modal-text"},{default:c(()=>[m(v(A.value),1)]),_:1}),"error"===z.value?(n(),o(a,{key:0,class:"modal-actions"},{default:c(()=>[i(a,{class:"modal-btn primary",onClick:W},{default:c(()=>[i(t,{class:"modal-btn-text"},{default:c(()=>[m("邮箱验证码登录")]),_:1})]),_:1}),i(a,{class:"modal-btn",onClick:X},{default:c(()=>[i(t,{class:"modal-btn-text"},{default:c(()=>[m("换个邮箱试试")]),_:1})]),_:1})]),_:1})):r("",!0)]),_:1})]),_:1})):r("",!0),i(h,{visible:$.value,onClose:l[8]||(l[8]=e=>$.value=!1),onConfirm:D},null,8,["visible"]),i(y,{visible:I.value,onClose:l[9]||(l[9]=e=>I.value=!1),onConfirm:F},null,8,["visible"])]),_:1})}}}),[["__scopeId","data-v-56c605c3"]]);export{V as default};
