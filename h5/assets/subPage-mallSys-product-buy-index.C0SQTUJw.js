import{d as e,r as a,v as l,x as t,c as s,w as u,a as r,b as o,_ as d,e as n,y as c,o as i,f as v,i as m,V as f,l as p,p as b,n as _,t as g,g as h,h as y,F as x,j as k,m as P,M as N,s as F,A as C,q as S,u as $}from"./index-PVX4T5SZ.js";import{g as w}from"./phones.CXKAVbyd.js";import{R as M}from"./RentAgreement.BPpI5Sg-.js";import{P as j,U as D}from"./PrivacyPolicy.C5y1eJJ5.js";const R=$(e({__name:"index",setup(e){const $=a(!1),R=a("store"),q=a({name:"张三",phone:"13616008888"}),z=a("福建省厦门市思明区软件园2期望海路7号楼望海路7号楼望海路7号楼"),A=a(""),I=l(()=>!!A.value),U=a(!1),Y=a(!1),B=a(!1),J=a(!1),O=a({brand:"",model:"",storage:"",color:"",salePrice:0,guidePrice:0,installment:0}),V=a(""),E=a(null),G=l(()=>"https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?auto=format&fit=crop&w=400&h=400&q=80"),H=l(()=>O.value.installment?`${O.value.installment}期`:""),K=l(()=>!!(O.value.brand&&O.value.model&&O.value.storage&&O.value.color)),L=l(()=>{const e=Number(O.value.installment||0);return e?e<=6?.2:.3:0}),Q=l(()=>{const e=Number(O.value.salePrice||0);return Number((e*L.value).toFixed(2))});l(()=>{if(!K.value||!O.value.installment)return"--";const e=Number(O.value.salePrice||0),a=Q.value,l=Math.max(e-a,0),t=Number(O.value.installment||0);if(!t)return"0.00";const s=t-(a>0?1:0);return s<=0?"0.00":(l/s).toFixed(2)});const T=l(()=>{if(!K.value||!O.value.installment)return[];const e=Number(O.value.salePrice||0),a=Q.value,l=Math.max(e-a,0),t=Number(O.value.installment||0);if(!t||e<=0)return[];const s=t-(a>0?1:0),u=s>0?Number((l/s).toFixed(2)):0,r=[];let o=0;const d=e=>{const a=["零","一","二","三","四","五","六","七","八","九"];return 10===e?"十":e<10?a[e]:e<20?"十"+a[e-10]:e%10==0?a[Math.floor(e/10)]+"十":a[Math.floor(e/10)]+"十"+a[e%10]},n=new Date,c=n.getFullYear(),i=String(n.getMonth()+1).padStart(2,"0"),v=String(n.getDate()).padStart(2,"0");a>0&&r.push({key:"first",label:"首付",date:`${c}-${i}-${v}`,amount:a.toFixed(2)});for(let m=1;m<=s;m++){const e=m===s?Number((l-o).toFixed(2)):u;o+=e;const t=new Date;t.setMonth(t.getMonth()+m);const n=t.getFullYear(),c=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),v=a>0?m+1:m;r.push({key:`p-${m}`,label:`第${d(v)}期`,date:`${n}-${c}-${i}`,amount:e.toFixed(2)})}return r}),W=l(()=>O.value.model?O.value.model:O.value.brand?`${O.value.brand} 手机`:""),X=l(()=>{const e=[];return O.value.color&&e.push(O.value.color),O.value.storage&&e.push(O.value.storage),H.value&&e.push(H.value),e.join(" · ")}),Z=l(()=>{const e=Number(O.value.salePrice||0);return e?e.toFixed(2):"--"}),ee=()=>{U.value=!U.value},ae=()=>{U.value=!0,Y.value=!1,B.value=!1,J.value=!1},le=()=>{F({url:"/subPage/other/addarea/addarea"})},te=()=>{K.value&&O.value.installment?"express"!==R.value||I.value?U.value?S({url:`/subPage/mallSys/product/buy/payment?amount=${Q.value.toFixed(2)}`}):C({title:"请先阅读并勾选协议",icon:"none"}):C({title:"请选择收货地址",icon:"none"}):C({title:"订单信息不完整",icon:"none"})};return t(e=>{if(e&&e.form)try{const a=decodeURIComponent(e.form),l=JSON.parse(a);O.value.brand=l.brand||"",O.value.model=l.model||"",O.value.storage=l.storage||"",O.value.color=l.color||"",O.value.salePrice=Number(l.salePrice||0),O.value.guidePrice=Number(l.guidePrice||0),O.value.installment=Number(l.installment||0)}catch(a){}if(e&&e.id){E.value=Number(e.id);const a=w(e.id);a&&(V.value=a.img,O.value.brand||(O.value.brand=a.brand),O.value.model||(O.value.model=a.name),O.value.salePrice||(O.value.salePrice=a.price,O.value.guidePrice=a.price+1e3))}}),(e,a)=>{const l=r("b-navbar"),t=m,F=o(n("up-icon"),d),C=h,S=P,w=f,O=o(n("up-button"),c),E=r("head-top");return i(),s(E,{loading:$.value,is_footer_mar:!1},{default:u(()=>[v(t,{class:"buy-page"},{default:u(()=>[v(l,{title:"确认订单"}),v(w,{class:"buy-body","scroll-y":""},{default:u(()=>[p("",!0),"store"===R.value?(i(),s(t,{key:1,class:"card address-card"},{default:u(()=>[v(t,{class:"address-header"},{default:u(()=>[v(t,{class:"address-name"},{default:u(()=>[_(g(q.value.name),1)]),_:1}),v(t,{class:"address-phone"},{default:u(()=>[_(g(q.value.phone),1)]),_:1})]),_:1}),v(t,{class:"address-detail"},{default:u(()=>[_(g(z.value),1)]),_:1})]),_:1})):(i(),s(t,{key:2,class:"card address-card",onClick:le},{default:u(()=>[v(t,{class:"address-header"},{default:u(()=>[v(t,{class:"address-name"},{default:u(()=>[_(g(I.value?q.value.name:"请选择收货地址"),1)]),_:1}),I.value?(i(),s(t,{key:0,class:"address-phone"},{default:u(()=>[_(g(q.value.phone),1)]),_:1})):p("",!0)]),_:1}),v(t,{class:"address-detail"},{default:u(()=>[_(g(I.value?A.value:"点击前往收货地址管理"),1)]),_:1}),v(t,{class:"address-arrow"},{default:u(()=>[v(F,{name:"arrow-right",size:"16",color:"#c0c4cc"})]),_:1})]),_:1})),v(t,{class:"card product-card"},{default:u(()=>[v(t,{class:"product-main"},{default:u(()=>[v(C,{class:"product-image",src:V.value||G.value,mode:"aspectFill"},null,8,["src"]),v(t,{class:"product-info"},{default:u(()=>[v(t,{class:"product-title"},{default:u(()=>[_(g(W.value||"待选择商品"),1)]),_:1}),X.value?(i(),s(t,{key:0,class:"product-desc"},{default:u(()=>[_(g(X.value),1)]),_:1})):p("",!0),H.value?(i(),s(t,{key:1,class:"product-sub"},{default:u(()=>[_(" 分期："+g(H.value),1)]),_:1})):p("",!0)]),_:1})]),_:1}),v(t,{class:"product-bottom"},{default:u(()=>[v(t,{class:"product-price"},{default:u(()=>[_(" ¥"+g(Z.value),1)]),_:1}),v(t,{class:"product-count"},{default:u(()=>[_("数量：1")]),_:1})]),_:1})]),_:1}),v(t,{class:"card"},{default:u(()=>[v(t,{class:"card-title-row"},{default:u(()=>[v(t,{class:"card-title"},{default:u(()=>[_("首付金额")]),_:1}),v(t,{class:"card-title-amount"},{default:u(()=>[_(" ¥"+g(Q.value.toFixed(2)),1)]),_:1})]),_:1})]),_:1}),T.value.length?(i(),s(t,{key:3,class:"card"},{default:u(()=>[v(t,{class:"card-title"},{default:u(()=>[_("账单明细")]),_:1}),v(t,{class:"bill-list"},{default:u(()=>[(i(!0),y(x,null,k(T.value,e=>(i(),s(t,{class:"bill-item",key:e.key},{default:u(()=>[v(t,{class:"bill-left"},{default:u(()=>[v(t,{class:"bill-title"},{default:u(()=>[_(g(e.label),1)]),_:2},1024),v(t,{class:"bill-date"},{default:u(()=>[_(g(e.date),1)]),_:2},1024)]),_:2},1024),v(t,{class:"bill-amount"},{default:u(()=>[_("¥"+g(e.amount),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):p("",!0),v(t,{class:"agreement-row"},{default:u(()=>[v(t,{class:b(["agreement-checkbox",{checked:U.value}]),onClick:ee},{default:u(()=>[U.value?(i(),s(S,{key:0,class:"agreement-checkbox-icon"},{default:u(()=>[_("✔")]),_:1})):p("",!0)]),_:1},8,["class"]),v(t,{class:"agreement-text"},{default:u(()=>[v(S,null,{default:u(()=>[_("我已阅读并同意")]),_:1}),v(S,{class:"agreement-link",onClick:a[2]||(a[2]=N(e=>Y.value=!0,["stop"]))},{default:u(()=>[_("《租赁服务协议》")]),_:1}),v(S,{class:"agreement-link",onClick:a[3]||(a[3]=N(e=>B.value=!0,["stop"]))},{default:u(()=>[_("《隐私协议》")]),_:1}),v(S,{class:"agreement-link",onClick:a[4]||(a[4]=N(e=>J.value=!0,["stop"]))},{default:u(()=>[_("《用户授权协议》")]),_:1})]),_:1})]),_:1}),v(t,{class:"summary-row"},{default:u(()=>[v(t,{class:"summary-text"},{default:u(()=>[_(" 共1件，目前应付 "),v(S,{class:"summary-amount"},{default:u(()=>[_("¥"+g(Q.value.toFixed(2)),1)]),_:1})]),_:1})]),_:1})]),_:1}),v(t,{class:"bottom-bar"},{default:u(()=>[v(O,{type:"primary",text:"确认订单",customStyle:{width:"100%",height:"44px"},onClick:te})]),_:1}),v(M,{visible:Y.value,onClose:a[5]||(a[5]=e=>Y.value=!1),onConfirm:ae},null,8,["visible"]),v(j,{visible:B.value,onClose:a[6]||(a[6]=e=>B.value=!1),onConfirm:ae},null,8,["visible"]),v(D,{visible:J.value,onClose:a[7]||(a[7]=e=>J.value=!1),onConfirm:ae},null,8,["visible"])]),_:1})]),_:1},8,["loading"])}}}),[["__scopeId","data-v-f814d03c"]]);export{R as default};
