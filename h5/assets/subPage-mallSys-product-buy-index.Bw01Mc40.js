import{d as e,r as a,c as l,B as t,a as s,w as u,b as r,e as o,_ as n,f as d,C as c,o as i,g as v,i as m,Y as f,n as p,s as b,q as _,t as g,h,k as y,F as k,l as x,p as P,Q as N,x as C,E as F,v as S,A as $}from"./index-B8xfDC1T.js";import{g as w}from"./phones.CXKAVbyd.js";import{R as M}from"./RentAgreement.4ZW64AsU.js";import{P as j,U as D}from"./PrivacyPolicy.jGpoZu39.js";const R=$(e({__name:"index",setup(e){const $=a(!1),R=a("store"),Y=a({name:"张三",phone:"13616008888"}),q=a("福建省厦门市思明区软件园2期望海路7号楼望海路7号楼望海路7号楼"),z=a(""),A=l(()=>!!z.value),B=a(!1),I=a(!1),U=a(!1),E=a(!1),J=a({brand:"",model:"",storage:"",color:"",salePrice:0,guidePrice:0,installment:0}),O=a(""),Q=a(null),G=l(()=>"https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?auto=format&fit=crop&w=400&h=400&q=80"),H=l(()=>J.value.installment?`${J.value.installment}期`:""),K=l(()=>!!(J.value.brand&&J.value.model&&J.value.storage&&J.value.color)),L=l(()=>{const e=Number(J.value.installment||0);return e?e<=6?.2:.3:0}),T=l(()=>{const e=Number(J.value.salePrice||0);return Number((e*L.value).toFixed(2))});l(()=>{if(!K.value||!J.value.installment)return"--";const e=Number(J.value.salePrice||0),a=T.value,l=Math.max(e-a,0),t=Number(J.value.installment||0);if(!t)return"0.00";const s=t-(a>0?1:0);return s<=0?"0.00":(l/s).toFixed(2)});const V=l(()=>{if(!K.value||!J.value.installment)return[];const e=Number(J.value.salePrice||0),a=T.value,l=Math.max(e-a,0),t=Number(J.value.installment||0);if(!t||e<=0)return[];const s=t-(a>0?1:0),u=s>0?Number((l/s).toFixed(2)):0,r=[];let o=0;const n=e=>{const a=["零","一","二","三","四","五","六","七","八","九"];return 10===e?"十":e<10?a[e]:e<20?"十"+a[e-10]:e%10==0?a[Math.floor(e/10)]+"十":a[Math.floor(e/10)]+"十"+a[e%10]},d=new Date,c=d.getFullYear(),i=String(d.getMonth()+1).padStart(2,"0"),v=String(d.getDate()).padStart(2,"0");a>0&&r.push({key:"first",label:"首付",date:`${c}-${i}-${v}`,amount:a.toFixed(2)});for(let m=1;m<=s;m++){const e=m===s?Number((l-o).toFixed(2)):u;o+=e;const t=new Date;t.setMonth(t.getMonth()+m);const d=t.getFullYear(),c=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),v=a>0?m+1:m;r.push({key:`p-${m}`,label:`第${n(v)}期`,date:`${d}-${c}-${i}`,amount:e.toFixed(2)})}return r}),W=l(()=>J.value.model?J.value.model:J.value.brand?`${J.value.brand} 手机`:""),X=l(()=>{const e=[];return J.value.color&&e.push(J.value.color),J.value.storage&&e.push(J.value.storage),H.value&&e.push(H.value),e.join(" · ")}),Z=l(()=>{const e=Number(J.value.salePrice||0);return e?e.toFixed(2):"--"}),ee=()=>{B.value=!B.value},ae=()=>{B.value=!0,I.value=!1,U.value=!1,E.value=!1},le=()=>{C({url:"/subPage/other/addarea/addarea"})},te=()=>{K.value&&J.value.installment?"express"!==R.value||A.value?B.value?S({url:`/subPage/mallSys/product/buy/payment?amount=${T.value.toFixed(2)}`}):F({title:"请先阅读并勾选协议",icon:"none"}):F({title:"请选择收货地址",icon:"none"}):F({title:"订单信息不完整",icon:"none"})};return t(e=>{let a=null;if(e&&e.form)try{const l=decodeURIComponent(e.form);a=JSON.parse(l)}catch(r){a=null}let l=null;a&&(l=a.form&&"object"==typeof a.form?a.form:a),l&&(J.value.brand=l.brand||"",J.value.model=l.model||"",J.value.storage=l.storage||"",J.value.color=l.color||"",J.value.salePrice=Number(l.salePrice||0),J.value.guidePrice=Number(l.guidePrice||0),J.value.installment=Number(l.installment||0));const t=e&&e.id?e.id:null,s=a&&a.id?a.id:null,u=t||s;if(null!=u&&""!==u){Q.value=Number(u);const e=w(u);e&&(O.value=e.img,J.value.brand||(J.value.brand=e.brand),J.value.model||(J.value.model=e.name),J.value.salePrice||(J.value.salePrice=e.price,J.value.guidePrice=e.price+1e3))}}),(e,a)=>{const l=r("b-navbar"),t=m,C=o(d("up-icon"),n),F=h,S=P,w=f,J=o(d("up-button"),c),Q=r("head-top");return i(),s(Q,{loading:$.value,is_footer_mar:!1},{default:u(()=>[v(t,{class:"buy-page"},{default:u(()=>[v(l,{title:"确认订单"}),v(w,{class:"buy-body","scroll-y":""},{default:u(()=>[p("",!0),"store"===R.value?(i(),s(t,{key:1,class:"card address-card"},{default:u(()=>[v(t,{class:"address-header"},{default:u(()=>[v(t,{class:"address-name"},{default:u(()=>[_(g(Y.value.name),1)]),_:1}),v(t,{class:"address-phone"},{default:u(()=>[_(g(Y.value.phone),1)]),_:1})]),_:1}),v(t,{class:"address-detail"},{default:u(()=>[_(g(q.value),1)]),_:1})]),_:1})):(i(),s(t,{key:2,class:"card address-card",onClick:le},{default:u(()=>[v(t,{class:"address-header"},{default:u(()=>[v(t,{class:"address-name"},{default:u(()=>[_(g(A.value?Y.value.name:"请选择收货地址"),1)]),_:1}),A.value?(i(),s(t,{key:0,class:"address-phone"},{default:u(()=>[_(g(Y.value.phone),1)]),_:1})):p("",!0)]),_:1}),v(t,{class:"address-detail"},{default:u(()=>[_(g(A.value?z.value:"点击前往收货地址管理"),1)]),_:1}),v(t,{class:"address-arrow"},{default:u(()=>[v(C,{name:"arrow-right",size:"16",color:"#c0c4cc"})]),_:1})]),_:1})),v(t,{class:"card product-card"},{default:u(()=>[v(t,{class:"product-main"},{default:u(()=>[v(F,{class:"product-image",src:O.value||G.value,mode:"aspectFill"},null,8,["src"]),v(t,{class:"product-info"},{default:u(()=>[v(t,{class:"product-title"},{default:u(()=>[_(g(W.value||"待选择商品"),1)]),_:1}),X.value?(i(),s(t,{key:0,class:"product-desc"},{default:u(()=>[_(g(X.value),1)]),_:1})):p("",!0),H.value?(i(),s(t,{key:1,class:"product-sub"},{default:u(()=>[_(" 分期："+g(H.value),1)]),_:1})):p("",!0)]),_:1})]),_:1}),v(t,{class:"product-bottom"},{default:u(()=>[v(t,{class:"product-price"},{default:u(()=>[_(" ¥"+g(Z.value),1)]),_:1}),v(t,{class:"product-count"},{default:u(()=>[_("数量：1")]),_:1})]),_:1})]),_:1}),v(t,{class:"card"},{default:u(()=>[v(t,{class:"card-title-row"},{default:u(()=>[v(t,{class:"card-title"},{default:u(()=>[_("首付金额")]),_:1}),v(t,{class:"card-title-amount"},{default:u(()=>[_(" ¥"+g(T.value.toFixed(2)),1)]),_:1})]),_:1})]),_:1}),V.value.length?(i(),s(t,{key:3,class:"card"},{default:u(()=>[v(t,{class:"card-title"},{default:u(()=>[_("账单明细")]),_:1}),v(t,{class:"bill-list"},{default:u(()=>[(i(!0),y(k,null,x(V.value,e=>(i(),s(t,{class:"bill-item",key:e.key},{default:u(()=>[v(t,{class:"bill-left"},{default:u(()=>[v(t,{class:"bill-title"},{default:u(()=>[_(g(e.label),1)]),_:2},1024),v(t,{class:"bill-date"},{default:u(()=>[_(g(e.date),1)]),_:2},1024)]),_:2},1024),v(t,{class:"bill-amount"},{default:u(()=>[_("¥"+g(e.amount),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):p("",!0),v(t,{class:"agreement-row"},{default:u(()=>[v(t,{class:b(["agreement-checkbox",{checked:B.value}]),onClick:ee},{default:u(()=>[B.value?(i(),s(S,{key:0,class:"agreement-checkbox-icon"},{default:u(()=>[_("✔")]),_:1})):p("",!0)]),_:1},8,["class"]),v(t,{class:"agreement-text"},{default:u(()=>[v(S,null,{default:u(()=>[_("我已阅读并同意")]),_:1}),v(S,{class:"agreement-link",onClick:a[2]||(a[2]=N(e=>I.value=!0,["stop"]))},{default:u(()=>[_("《租赁服务协议》")]),_:1}),v(S,{class:"agreement-link",onClick:a[3]||(a[3]=N(e=>U.value=!0,["stop"]))},{default:u(()=>[_("《隐私协议》")]),_:1}),v(S,{class:"agreement-link",onClick:a[4]||(a[4]=N(e=>E.value=!0,["stop"]))},{default:u(()=>[_("《用户授权协议》")]),_:1})]),_:1})]),_:1}),v(t,{class:"summary-row"},{default:u(()=>[v(t,{class:"summary-text"},{default:u(()=>[_(" 共1件，目前应付 "),v(S,{class:"summary-amount"},{default:u(()=>[_("¥"+g(T.value.toFixed(2)),1)]),_:1})]),_:1})]),_:1})]),_:1}),v(t,{class:"bottom-bar"},{default:u(()=>[v(J,{type:"primary",text:"确认订单",customStyle:{width:"100%",height:"44px"},onClick:te})]),_:1}),v(M,{visible:I.value,onClose:a[5]||(a[5]=e=>I.value=!1),onConfirm:ae},null,8,["visible"]),v(j,{visible:U.value,onClose:a[6]||(a[6]=e=>U.value=!1),onConfirm:ae},null,8,["visible"]),v(D,{visible:E.value,onClose:a[7]||(a[7]=e=>E.value=!1),onConfirm:ae},null,8,["visible"])]),_:1})]),_:1},8,["loading"])}}}),[["__scopeId","data-v-8d370906"]]);export{R as default};
