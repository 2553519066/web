import{d as e,r as a,c as l,A as t,a as s,w as u,b as r,e as o,_ as d,f as n,B as c,o as i,g as m,i as v,a5 as f,D as p,q as _,p as b,t as g,h,k as y,F as k,l as x,n as P,T as N,v as F,E as S,s as $,z as w}from"./index-BvTRnY6x.js";import{g as M}from"./phones.CXKAVbyd.js";const C=w(e({__name:"index",setup(e){const w=a(!1),C=a("store"),D=a({name:"张三",phone:"13616008888"}),j=a("福建省厦门市思明区软件园2期望海路7号楼望海路7号楼望海路7号楼"),A=a(""),q=l(()=>!!A.value),z=a(!1),E=a({brand:"",model:"",storage:"",color:"",salePrice:0,guidePrice:0,installment:0}),I=a(""),Y=a(null),B=l(()=>"https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?auto=format&fit=crop&w=400&h=400&q=80"),J=l(()=>E.value.installment?`${E.value.installment}期`:""),O=l(()=>!!(E.value.brand&&E.value.model&&E.value.storage&&E.value.color)),R=l(()=>{const e=Number(E.value.installment||0);return e?e<=6?.2:.3:0}),T=l(()=>{const e=Number(E.value.salePrice||0);return Number((e*R.value).toFixed(2))});l(()=>{if(!O.value||!E.value.installment)return"--";const e=Number(E.value.salePrice||0),a=T.value,l=Math.max(e-a,0),t=Number(E.value.installment||0);if(!t)return"0.00";const s=t-(a>0?1:0);return s<=0?"0.00":(l/s).toFixed(2)});const U=l(()=>{if(!O.value||!E.value.installment)return[];const e=Number(E.value.salePrice||0),a=T.value,l=Math.max(e-a,0),t=Number(E.value.installment||0);if(!t||e<=0)return[];const s=t-(a>0?1:0),u=s>0?Number((l/s).toFixed(2)):0,r=[];let o=0;const d=e=>{const a=["零","一","二","三","四","五","六","七","八","九"];return 10===e?"十":e<10?a[e]:e<20?"十"+a[e-10]:e%10==0?a[Math.floor(e/10)]+"十":a[Math.floor(e/10)]+"十"+a[e%10]},n=new Date,c=n.getFullYear(),i=String(n.getMonth()+1).padStart(2,"0"),m=String(n.getDate()).padStart(2,"0");a>0&&r.push({key:"first",label:"首付",date:`${c}-${i}-${m}`,amount:a.toFixed(2)});for(let v=1;v<=s;v++){const e=v===s?Number((l-o).toFixed(2)):u;o+=e;const t=new Date;t.setMonth(t.getMonth()+v);const n=t.getFullYear(),c=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),m=a>0?v+1:v;r.push({key:`p-${v}`,label:`第${d(m)}期`,date:`${n}-${c}-${i}`,amount:e.toFixed(2)})}return r}),G=l(()=>E.value.model?E.value.model:E.value.brand?`${E.value.brand} 手机`:""),H=l(()=>{const e=[];return E.value.color&&e.push(E.value.color),E.value.storage&&e.push(E.value.storage),J.value&&e.push(J.value),e.join(" · ")}),K=l(()=>{const e=Number(E.value.salePrice||0);return e?e.toFixed(2):"--"}),L=()=>{z.value=!z.value},Q=e=>{F({url:"/subPage/mallSys/login/treaty?type="+e})},V=()=>{F({url:"/subPage/other/addarea/addarea"})},W=()=>{O.value&&E.value.installment?"express"!==C.value||q.value?z.value?$({url:`/subPage/mallSys/product/buy/payment?amount=${T.value.toFixed(2)}`}):S({title:"请先阅读并勾选协议",icon:"none"}):S({title:"请选择收货地址",icon:"none"}):S({title:"订单信息不完整",icon:"none"})};return t(e=>{let a=null;if(e&&e.form)try{const l=decodeURIComponent(e.form);a=JSON.parse(l)}catch(r){a=null}let l=null;a&&(l=a.form&&"object"==typeof a.form?a.form:a),l&&(E.value.brand=l.brand||"",E.value.model=l.model||"",E.value.storage=l.storage||"",E.value.color=l.color||"",E.value.salePrice=Number(l.salePrice||0),E.value.guidePrice=Number(l.guidePrice||0),E.value.installment=Number(l.installment||0));const t=e&&e.id?e.id:null,s=a&&a.id?a.id:null,u=t||s;if(null!=u&&""!==u){Y.value=Number(u);const e=M(u);e&&(I.value=e.img,E.value.brand||(E.value.brand=e.brand),E.value.model||(E.value.model=e.name),E.value.salePrice||(E.value.salePrice=e.price,E.value.guidePrice=e.price+1e3))}}),(e,a)=>{const l=r("b-navbar"),t=v,F=o(n("up-icon"),d),S=h,$=P,M=f,E=o(n("up-button"),c),Y=r("head-top");return i(),s(Y,{loading:w.value,is_footer_mar:!1},{default:u(()=>[m(t,{class:"buy-page"},{default:u(()=>[m(l,{title:"确认订单"}),m(M,{class:"buy-body","scroll-y":""},{default:u(()=>[p("",!0),"store"===C.value?(i(),s(t,{key:1,class:"card address-card"},{default:u(()=>[m(t,{class:"address-header"},{default:u(()=>[m(t,{class:"address-name"},{default:u(()=>[b(g(D.value.name),1)]),_:1}),m(t,{class:"address-phone"},{default:u(()=>[b(g(D.value.phone),1)]),_:1})]),_:1}),m(t,{class:"address-detail"},{default:u(()=>[b(g(j.value),1)]),_:1})]),_:1})):(i(),s(t,{key:2,class:"card address-card",onClick:V},{default:u(()=>[m(t,{class:"address-header"},{default:u(()=>[m(t,{class:"address-name"},{default:u(()=>[b(g(q.value?D.value.name:"请选择收货地址"),1)]),_:1}),q.value?(i(),s(t,{key:0,class:"address-phone"},{default:u(()=>[b(g(D.value.phone),1)]),_:1})):p("",!0)]),_:1}),m(t,{class:"address-detail"},{default:u(()=>[b(g(q.value?A.value:"点击前往收货地址管理"),1)]),_:1}),m(t,{class:"address-arrow"},{default:u(()=>[m(F,{name:"arrow-right",size:"16",color:"#c0c4cc"})]),_:1})]),_:1})),m(t,{class:"card product-card"},{default:u(()=>[m(t,{class:"product-main"},{default:u(()=>[m(S,{class:"product-image",src:I.value||B.value,mode:"aspectFill"},null,8,["src"]),m(t,{class:"product-info"},{default:u(()=>[m(t,{class:"product-title"},{default:u(()=>[b(g(G.value||"待选择商品"),1)]),_:1}),H.value?(i(),s(t,{key:0,class:"product-desc"},{default:u(()=>[b(g(H.value),1)]),_:1})):p("",!0),J.value?(i(),s(t,{key:1,class:"product-sub"},{default:u(()=>[b(" 分期："+g(J.value),1)]),_:1})):p("",!0)]),_:1})]),_:1}),m(t,{class:"product-bottom"},{default:u(()=>[m(t,{class:"product-price"},{default:u(()=>[b(" ¥"+g(K.value),1)]),_:1}),m(t,{class:"product-count"},{default:u(()=>[b("数量：1")]),_:1})]),_:1})]),_:1}),m(t,{class:"card"},{default:u(()=>[m(t,{class:"card-title-row"},{default:u(()=>[m(t,{class:"card-title"},{default:u(()=>[b("首付金额")]),_:1}),m(t,{class:"card-title-amount"},{default:u(()=>[b(" ¥"+g(T.value.toFixed(2)),1)]),_:1})]),_:1})]),_:1}),U.value.length?(i(),s(t,{key:3,class:"card"},{default:u(()=>[m(t,{class:"card-title"},{default:u(()=>[b("账单明细")]),_:1}),m(t,{class:"bill-list"},{default:u(()=>[(i(!0),y(k,null,x(U.value,e=>(i(),s(t,{class:"bill-item",key:e.key},{default:u(()=>[m(t,{class:"bill-left"},{default:u(()=>[m(t,{class:"bill-title"},{default:u(()=>[b(g(e.label),1)]),_:2},1024),m(t,{class:"bill-date"},{default:u(()=>[b(g(e.date),1)]),_:2},1024)]),_:2},1024),m(t,{class:"bill-amount"},{default:u(()=>[b("¥"+g(e.amount),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):p("",!0),m(t,{class:"agreement-row"},{default:u(()=>[m(t,{class:_(["agreement-checkbox",{checked:z.value}]),onClick:L},{default:u(()=>[z.value?(i(),s($,{key:0,class:"agreement-checkbox-icon"},{default:u(()=>[b("✔")]),_:1})):p("",!0)]),_:1},8,["class"]),m(t,{class:"agreement-text"},{default:u(()=>[m($,null,{default:u(()=>[b("我已阅读并同意")]),_:1}),m($,{class:"agreement-link",onClick:a[2]||(a[2]=N(e=>Q("rentAgreement"),["stop"]))},{default:u(()=>[b("《租赁服务协议》")]),_:1}),m($,{class:"agreement-link",onClick:a[3]||(a[3]=N(e=>Q("privacyPolicy"),["stop"]))},{default:u(()=>[b("《隐私协议》")]),_:1}),m($,{class:"agreement-link",onClick:a[4]||(a[4]=N(e=>Q("userAgreement"),["stop"]))},{default:u(()=>[b("《用户授权协议》")]),_:1})]),_:1})]),_:1}),m(t,{class:"summary-row"},{default:u(()=>[m(t,{class:"summary-text"},{default:u(()=>[b(" 共1件，目前应付 "),m($,{class:"summary-amount"},{default:u(()=>[b("¥"+g(T.value.toFixed(2)),1)]),_:1})]),_:1})]),_:1})]),_:1}),m(t,{class:"bottom-bar"},{default:u(()=>[m(E,{type:"primary",text:"确认订单",customStyle:{width:"100%",height:"44px"},onClick:W})]),_:1})]),_:1})]),_:1},8,["loading"])}}}),[["__scopeId","data-v-f0e93870"]]);export{C as default};
