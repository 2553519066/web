import{d as e,r as a,c as t,e as o,a3 as r,f as l,a as n,o as s,i as d,w as c,g as u,q as i,t as _,h as m,n as f,p,Q as v,A as y,K as b,B as g,b as k,a4 as h,k as C,F as w,l as P,x}from"./index-B8xfDC1T.js";import{B as R}from"./index.Cm3uaJ_t.js";import{B as F}from"./index.XdVPeSkc.js";import{o as A}from"./orders.DJuNOKoI.js";const B=y(e({__name:"OrderItem",props:{order:{}},emits:["click","clickProduct"],setup(e,{emit:y}){const b=e,g=y,k=a(!1),h=()=>{k.value=!0},C=()=>{k.value=!1,q("cancel")},w=a(""),P=[{name:"查看账单",value:"showBill"},{name:"用户资料",value:"audit"},{name:"付款凭证",value:"uploadPayProof"},{name:"线下归还",value:"returnOffline"},{name:"查看日志",value:"showLog"}],x=t(()=>{const e=b.order||{};return e.needPay?"待付款":e.needUpload?"待审核":"repay"===e.action?"待还款":"earlyRepay"===e.action?"可提前结清":"defer"===e.action||"dailyRent"===e.action?"服务中":"进行中"});t(()=>{const e=b.order||{};return e.needPay?"待支付":"identity"===e.action?"上传身份资料":"contract"===e.action?"上传合同":"repay"===e.action?"还款":"earlyRepay"===e.action?"提前还款":"defer"===e.action?"申请延期":"dailyRent"===e.action?"日租续用":"风控材料"});const R=t(()=>{const e=b.order||{};if(e.title)return e.title;const a=[e.brand,e.model,e.storage].filter(Boolean);return a.length?a.join(" "):"租赁商品"}),A=t(()=>{const e=b.order||{};return e.spec?`已选：${e.spec}`:e.storage?`已选：${e.storage}`:""}),B=t(()=>{const e=b.order||{};return e.remainingPeriods?`租期：${e.remainingPeriods}期`:e.dailyFee?`日租金：¥${Number(e.dailyFee).toFixed(2)}`:""}),U=t(()=>{const e=b.order||{},a=e.totalRent??(e.perAmount&&e.remainingPeriods?e.perAmount*e.remainingPeriods:e.perAmount);return a?Number(a).toFixed(2):"0.00"}),j=t(()=>(b.order||{}).quantity||1),L=e=>{w.value=e.value,g("click",e.value)},q=e=>{g("click",e)};return(e,a)=>{const t=d,y=m,b=p,N=o(l("up-select"),r);return s(),n(t,{class:"order_item"},{default:c(()=>[u(t,{class:"order_header"},{default:c(()=>[u(t,{class:"order_store"},{default:c(()=>[u(t,{class:"store_icon"},{default:c(()=>[i("店")]),_:1}),u(t,{class:"store_name"},{default:c(()=>[i(_(e.order.storeName||"租无忧旗舰店"),1)]),_:1})]),_:1}),u(t,{class:"order_status"},{default:c(()=>[i(_(x.value),1)]),_:1})]),_:1}),u(t,{class:"order_body",onClick:a[0]||(a[0]=a=>{return t=e.order,void g("clickProduct",t);var t})},{default:c(()=>[u(t,{class:"product_thumb"},{default:c(()=>[u(y,{class:"product_img",src:e.order.img||"https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?auto=format&fit=crop&w=400&h=400&q=80",mode:"aspectFill"},null,8,["src"])]),_:1}),u(t,{class:"product_info"},{default:c(()=>[u(t,{class:"product_title"},{default:c(()=>[i(_(R.value),1)]),_:1}),A.value?(s(),n(t,{key:0,class:"product_spec"},{default:c(()=>[i(_(A.value),1)]),_:1})):f("",!0),B.value?(s(),n(t,{key:1,class:"product_term"},{default:c(()=>[i(_(B.value),1)]),_:1})):f("",!0),u(t,{class:"product_bottom"},{default:c(()=>[u(t,{class:"total_rent"},{default:c(()=>[u(b,{class:"total_label"},{default:c(()=>[i("总租金")]),_:1}),u(b,{class:"total_amount"},{default:c(()=>[i("¥"+_(U.value),1)]),_:1})]),_:1}),u(t,{class:"quantity"},{default:c(()=>[i("x"+_(j.value),1)]),_:1})]),_:1})]),_:1})]),_:1}),u(t,{class:"order_footer"},{default:c(()=>[u(t,{class:"plan_tag"},{default:c(()=>[u(N,{current:w.value,"onUpdate:current":a[1]||(a[1]=e=>w.value=e),label:"更多",options:P,overlayOpacity:"0.3",onSelect:L},null,8,["current"])]),_:1}),u(t,{class:"order_buttons"},{default:c(()=>[u(t,{class:"order_btn",onClick:v(h,["stop"])},{default:c(()=>[i("取消订单")]),_:1}),u(t,{class:"order_btn order_btn_primary",onClick:a[2]||(a[2]=v(e=>q("orderAudit"),["stop"]))},{default:c(()=>[i("订单审核")]),_:1}),u(t,{class:"order_btn order_btn_primary",onClick:a[3]||(a[3]=v(e=>q("audit"),["stop"]))},{default:c(()=>[i("审核资料")]),_:1})]),_:1})]),_:1}),u(F,{show:k.value,"onUpdate:show":a[4]||(a[4]=e=>k.value=e),title:"取消订单",content:"订单生成后取消可能影响您的授信额度，确定继续取消吗？",showCancelButton:"",confirmText:"确认取消",cancelText:"暂不取消",confirmColor:"#3c9cff",onConfirm:C},null,8,["show"])]),_:1})}}}),[["__scopeId","data-v-9e2cd534"]]),U=y(e({__name:"index",setup(e){const r=a(!1),i=b([{name:"全部"},{name:"先审核后付"},{name:"待付款"},{name:"发货审核",badge:{value:5}},{name:"待发货"},{name:"待收货"},{name:"使用中"},{name:"已逾期"},{name:"归还中"},{name:"已完成"},{name:"已买断"},{name:"已关闭"}]),_=a(0),m=b([...A]),p=a("");g(e=>{e&&e.type&&(_.value=Number(e.type))});const v=e=>{_.value=e},y=e=>{console.log("keyword",e),p.value=e},F=t(()=>{let e=m;if(0===_.value?e=m:1===_.value?e=m.filter(e=>e.needPay):2===_.value?e=m.filter(e=>e.needUpload):3===_.value?e=m.filter(e=>!e.needPay&&!e.needUpload&&"repay"!==e.action&&"earlyRepay"!==e.action):4===_.value?e=m.filter(e=>"repay"===e.action||"earlyRepay"===e.action):5===_.value&&(e=m.filter(e=>"defer"===e.action||"dailyRent"===e.action)),p.value){const a=p.value.toLowerCase();e=e.filter(e=>e.code&&e.code.toLowerCase().includes(a)||e.brand&&e.brand.toLowerCase().includes(a)||e.model&&e.model.toLowerCase().includes(a))}return e}),U=e=>{console.log("订单点击:",e)},j=e=>{console.log("订单点击:",e),x({url:"./detail?id="+e.id})};return(e,a)=>{const t=k("b-navbar"),m=o(l("up-empty"),h),p=d,b=k("head-top");return s(),n(b,{loading:r.value,is_footer_mar:!1},{default:c(()=>[u(t,{title:"我的订单",is_back:"",is_footer_mar:!1,isSearch:"",onSearch:y}),u(R,{list:i,current:_.value,"onUpdate:current":a[0]||(a[0]=e=>_.value=e),scrollable:"",onClick:v},null,8,["list","current"]),u(p,{class:"order_list"},{default:c(()=>[(s(!0),C(w,null,P(F.value,e=>(s(),n(B,{key:e.id,order:e,onClick:U,onClickProduct:j},null,8,["order"]))),128)),0===F.value.length?(s(),n(p,{key:0,class:"no-data"},{default:c(()=>[u(m,{mode:"order",text:"暂无相关订单"})]),_:1})):f("",!0)]),_:1})]),_:1},8,["loading"])}}}),[["__scopeId","data-v-a34f19af"]]);export{U as default};
