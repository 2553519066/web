import{d as e,r as a,c as l,A as t,a as u,w as s,b as o,e as n,_ as i,f as r,B as c,C as d,o as v,g as m,i as f,D as b,h as p,p as _,q as g,n as P,t as h,k as x,F as w,l as y,E as C,v as S,z as k}from"./index-BvTRnY6x.js";import{g as N}from"./phones.CXKAVbyd.js";import{r as F}from"./request.BlpNkiyM.js";import"./userinfo.CF3eNbHI.js";const $=k(e({__name:"index",setup(e){const k=a(!1),$=a("new"),M=a({classValue:"",brand:"",brandText:"",model:"",storage:"",color:"",salePrice:0,guidePrice:0,installment:0});a(1);const G=a(null),B=a(!1),T=a(!1),z=a(!1),X=a(!1),D=a(!1),j=a([]);var U;(U={brandType:1},F({url:"/brand/comUnBrand/allBrands",method:"post",data:U})).then(e=>{j.value=[e.data.map(e=>({text:e.brandName,value:e.brandNo}))]});const q={Apple:{"iPhone 15":{salePrice:5999,guidePrice:6999},"iPhone 15 Pro":{salePrice:7999,guidePrice:8999},"iPhone 15 Pro Max":{salePrice:9999,guidePrice:10999}},Samsung:{"Galaxy S24":{salePrice:5499,guidePrice:6499},"Galaxy S24 Ultra":{salePrice:8999,guidePrice:9999}},Huawei:{"Mate 60":{salePrice:6999,guidePrice:7999},P60:{salePrice:4999,guidePrice:5999}},Xiaomi:{"Xiaomi 14":{salePrice:3999,guidePrice:4999},"Xiaomi 14 Pro":{salePrice:4999,guidePrice:5999}}},A={Apple:["iPhone 15","iPhone 15 Pro","iPhone 15 Pro Max"],Samsung:["Galaxy S24","Galaxy S24 Ultra"],Huawei:["Mate 60","P60"],Xiaomi:["Xiaomi 14","Xiaomi 14 Pro"]},I=l(()=>{if(!M.value.brand)return[[]];return[A[M.value.brand]||[]]}),E=["128GB","256GB","512GB","1TB"],H=a([E]),Y=["黑色","白色","蓝色","紫色","金色"],J=a([Y]),O=a([[3,6,12,24].map(e=>`${e}期`)]),R=l(()=>M.value.installment?`${M.value.installment}期`:""),V=l(()=>!!(M.value.brand&&M.value.model&&M.value.storage&&M.value.color)),K=l(()=>{const e=Number(M.value.installment||0);return e?e<=6?.2:.3:0}),L=l(()=>{const e=Number(M.value.salePrice||0);return Number((e*K.value).toFixed(2))}),Q=l(()=>{if(!V.value||!M.value.installment)return"--";const e=Number(M.value.salePrice||0),a=L.value,l=Math.max(e-a,0),t=Number(M.value.installment||0);if(!t)return"0.00";const u=t-(a>0?1:0);return u<=0?"0.00":(l/u).toFixed(2)}),W=l(()=>{if(!V.value||!M.value.installment)return[];const e=Number(M.value.salePrice||0),a=L.value,l=Math.max(e-a,0),t=Number(M.value.installment||0);if(!t||e<=0)return[];const u=t-(a>0?1:0),s=u>0?Number((l/u).toFixed(2)):0,o=[];let n=0;const i=e=>{const a=["零","一","二","三","四","五","六","七","八","九"];return 10===e?"十":e<10?a[e]:e<20?"十"+a[e-10]:e%10==0?a[Math.floor(e/10)]+"十":a[Math.floor(e/10)]+"十"+a[e%10]},r=new Date,c=r.getFullYear(),d=String(r.getMonth()+1).padStart(2,"0"),v=String(r.getDate()).padStart(2,"0");a>0&&o.push({key:"first",label:"首付",date:`${c}-${d}-${v}`,amount:a.toFixed(2)});for(let m=1;m<=u;m++){const e=m===u?Number((l-n).toFixed(2)):s;n+=e;const t=new Date;t.setMonth(t.getMonth()+m);const r=t.getFullYear(),c=String(t.getMonth()+1).padStart(2,"0"),d=String(t.getDate()).padStart(2,"0"),v=a>0?m+1:m;o.push({key:`p-${m}`,label:`第${i(v)}期`,date:`${r}-${c}-${d}`,amount:e.toFixed(2)})}return o}),Z=()=>{M.value.brand?T.value=!0:C({title:"请先选择品牌",icon:"none"})},ee=()=>{M.value.brand?M.value.model?z.value=!0:C({title:"请先选择型号",icon:"none"}):C({title:"请先选择品牌",icon:"none"})},ae=()=>{M.value.brand?M.value.model?X.value=!0:C({title:"请先选择型号",icon:"none"}):C({title:"请先选择品牌",icon:"none"})},le=()=>{M.value.brand?M.value.model?M.value.storage?M.value.color?D.value=!0:C({title:"请先选择颜色",icon:"none"}):C({title:"请先选择内存",icon:"none"}):C({title:"请先选择型号",icon:"none"}):C({title:"请先选择品牌",icon:"none"})},te=e=>{M.value.brand=e.value[0].value,M.value.brandText=e.value[0].text,M.value.model="",M.value.storage="",M.value.color="",M.value.salePrice=0,M.value.guidePrice=0,M.value.installment=0,B.value=!1},ue=e=>{var a;const l=e.value[0];if(M.value.model=l,M.value.storage="",M.value.color="",M.value.installment=0,M.value.brand&&l){const e=null==(a=q[M.value.brand])?void 0:a[l];e&&(M.value.salePrice=e.salePrice,M.value.guidePrice=e.guidePrice)}T.value=!1},se=e=>{M.value.storage=e.value[0],M.value.installment=0,z.value=!1},oe=e=>{M.value.color=e.value[0],M.value.installment=0,X.value=!1},ne=e=>{const a=e.value[0];M.value.installment=parseInt(a),D.value=!1},ie=()=>{if(!M.value.brand||!M.value.model||!M.value.storage)return void C({title:"请完善商品信息",icon:"none"});if(!M.value.salePrice)return void C({title:"请填写售价",icon:"none"});const e=encodeURIComponent(JSON.stringify(M.value)),a=null!=G.value?`&id=${G.value}`:"";S({url:`/subPage/mallSys/product/buy/index?form=${e}${a}`})};return t(e=>{if(e.id){G.value=Number(e.id);const a=N(e.id);a&&(M.value.brand=a.brand,M.value.model=a.name,M.value.salePrice=a.price,M.value.guidePrice=a.price+1e3,M.value.storage=e.storage||e.memory||E[0],M.value.color=e.color||Y[0],M.value.installment=12)}}),(e,a)=>{const l=o("b-navbar"),t=p,C=f,S=P,N=n(r("up-icon"),i),F=n(r("up-button"),c),G=n(r("up-picker"),d),U=o("head-top");return v(),u(U,{loading:k.value,is_footer_mar:!1},{default:s(()=>[m(C,{class:"order-container"},{default:s(()=>[m(l,{title:"确认订单"}),m(C,{class:"order-banner"},{default:s(()=>[m(t,{src:"https://images.unsplash.com/photo-1696446701796-da61225697cc?auto=format&fit=crop&w=800&q=80",mode:"aspectFill"}),m(C,{class:"banner-text"},{default:s(()=>[_("信用免押 × 随心享用")]),_:1})]),_:1}),m(C,{class:g(["type-tabs",{right:"old"==$.value}])},{default:s(()=>[m(C,{class:g(["tab","new"===$.value?"active":""]),onClick:a[0]||(a[0]=e=>$.value="new")},{default:s(()=>[_("新机")]),_:1},8,["class"]),m(C,{class:g(["tab","old"===$.value?"active":""]),onClick:a[1]||(a[1]=e=>$.value="old")},{default:s(()=>[_("旧机")]),_:1},8,["class"])]),_:1},8,["class"]),m(C,{class:"card"},{default:s(()=>[m(C,{class:"card-title"},{default:s(()=>[_("商品信息")]),_:1}),m(C,{class:"product-form"},{default:s(()=>[m(C,{class:"form-item",onClick:a[2]||(a[2]=e=>B.value=!0)},{default:s(()=>[m(C,{class:"form-label"},{default:s(()=>[_("品牌")]),_:1}),m(C,{class:"input-box"},{default:s(()=>[m(S,{class:g(["input-text",{placeholder:!M.value.brandText}])},{default:s(()=>[_(h(M.value.brandText||"请选择品牌"),1)]),_:1},8,["class"]),m(N,{name:"arrow-down",size:"16",color:"#909399"})]),_:1})]),_:1}),m(C,{class:"form-item",onClick:Z},{default:s(()=>[m(C,{class:"form-label"},{default:s(()=>[_("型号")]),_:1}),m(C,{class:g(["input-box",{disabled:!M.value.brandText}])},{default:s(()=>[m(S,{class:g(["input-text",{placeholder:!M.value.model}])},{default:s(()=>[_(h(M.value.model||"请选择型号"),1)]),_:1},8,["class"]),m(N,{name:"arrow-down",size:"16",color:"#909399"})]),_:1},8,["class"])]),_:1}),m(C,{class:"form-inline"},{default:s(()=>[m(C,{class:"form-item",onClick:ee},{default:s(()=>[m(C,{class:"form-label"},{default:s(()=>[_("内存")]),_:1}),m(C,{class:g(["input-box",{disabled:!M.value.model}])},{default:s(()=>[m(S,{class:g(["input-text",{placeholder:!M.value.storage}])},{default:s(()=>[_(h(M.value.storage||"请选择内存"),1)]),_:1},8,["class"]),m(N,{name:"arrow-down",size:"16",color:"#909399"})]),_:1},8,["class"])]),_:1}),m(C,{class:"form-item",onClick:ae},{default:s(()=>[m(C,{class:"form-label"},{default:s(()=>[_("颜色")]),_:1}),m(C,{class:g(["input-box",{disabled:!M.value.model}])},{default:s(()=>[m(S,{class:g(["input-text",{placeholder:!M.value.color}])},{default:s(()=>[_(h(M.value.color||"请选择颜色"),1)]),_:1},8,["class"]),m(N,{name:"arrow-down",size:"16",color:"#909399"})]),_:1},8,["class"])]),_:1})]),_:1})]),_:1})]),_:1}),m(C,{class:"card"},{default:s(()=>[m(C,{class:"card-title"},{default:s(()=>[_("期数金额")]),_:1}),m(C,{class:"discount-grid"},{default:s(()=>[m(C,{class:"discount-item"},{default:s(()=>[m(C,{class:"label"},{default:s(()=>[_("售价：")]),_:1}),m(C,{class:"sale-display"},{default:s(()=>[_(h(V.value&&M.value.salePrice?"¥"+Number(M.value.salePrice).toFixed(2):"--"),1)]),_:1})]),_:1}),m(C,{class:"discount-item"},{default:s(()=>[m(C,{class:"label"},{default:s(()=>[_("市场价：")]),_:1}),m(C,{class:"guide-display"},{default:s(()=>[_(h(V.value&&M.value.guidePrice?"¥"+Number(M.value.guidePrice).toFixed(2):"--"),1)]),_:1})]),_:1}),m(C,{class:"discount-item",onClick:le},{default:s(()=>[m(C,{class:"label"},{default:s(()=>[_("期数：")]),_:1}),m(C,{class:g(["input-box",{disabled:!V.value}])},{default:s(()=>[m(S,{class:g(["input-text",{placeholder:!R.value}])},{default:s(()=>[_(h(R.value||"选择期数"),1)]),_:1},8,["class"]),m(N,{name:"arrow-down",size:"16",color:"#909399"})]),_:1},8,["class"])]),_:1}),m(C,{class:"discount-item"},{default:s(()=>[m(C,{class:"label"},{default:s(()=>[_("首付金额：")]),_:1}),m(C,{class:"downpay-display"},{default:s(()=>[_(h(V.value&&M.value.installment?"¥"+L.value.toFixed(2):"--"),1)]),_:1})]),_:1})]),_:1}),V.value&&M.value.installment?(v(),u(C,{key:0,class:"period-summary"},{default:s(()=>[m(S,null,{default:s(()=>[_("每月应付")]),_:1}),m(S,{class:"amount"},{default:s(()=>[_(h("--"!==Q.value?"¥"+Q.value:"--"),1)]),_:1})]),_:1})):b("",!0)]),_:1}),W.value.length?(v(),u(C,{key:0,class:"card"},{default:s(()=>[m(C,{class:"card-title"},{default:s(()=>[_("账单明细")]),_:1}),m(C,{class:"bill-list"},{default:s(()=>[(v(!0),x(w,null,y(W.value,e=>(v(),u(C,{class:"bill-item",key:e.key},{default:s(()=>[m(C,{class:"bill-left"},{default:s(()=>[m(C,{class:"bill-title"},{default:s(()=>[_(h(e.label),1)]),_:2},1024),m(C,{class:"bill-date"},{default:s(()=>[_(h(e.date),1)]),_:2},1024)]),_:2},1024),m(C,{class:"bill-amount"},{default:s(()=>[_("¥"+h(e.amount),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):b("",!0),m(C,{class:"bottom-bar"},{default:s(()=>[m(F,{type:"primary",text:"下一步",onClick:ie,customStyle:{width:"100%",height:"44px"}})]),_:1}),m(G,{show:B.value,columns:j.value,onConfirm:te,onCancel:a[3]||(a[3]=e=>B.value=!1)},null,8,["show","columns"]),m(G,{show:T.value,columns:I.value,onConfirm:ue,onCancel:a[4]||(a[4]=e=>T.value=!1)},null,8,["show","columns"]),m(G,{show:z.value,columns:H.value,onConfirm:se,onCancel:a[5]||(a[5]=e=>z.value=!1)},null,8,["show","columns"]),m(G,{show:X.value,columns:J.value,onConfirm:oe,onCancel:a[6]||(a[6]=e=>X.value=!1)},null,8,["show","columns"]),m(G,{show:D.value,columns:O.value,onConfirm:ne,onCancel:a[7]||(a[7]=e=>D.value=!1)},null,8,["show","columns"])]),_:1})]),_:1},8,["loading"])}}}),[["__scopeId","data-v-09d3d4c2"]]);export{$ as default};
