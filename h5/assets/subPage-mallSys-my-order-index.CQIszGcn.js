import{d as e,r as a,v as t,b as r,a0 as l,e as o,c as s,o as n,i as c,w as d,f as u,n as i,t as _,g as m,l as p,m as f,M as v,u as y,E as b,x as g,a as k,a1 as h,h as x,F as P,j as C,s as R}from"./index-D6n_yxAO.js";import{_ as w}from"./index.vue_vue_type_script_setup_true_lang.CrChtQ2S.js";import{B as j}from"./index.C0ZB4X78.js";import{o as F}from"./orders.DJuNOKoI.js";const U=y(e({__name:"OrderItem",props:{order:{}},emits:["click","clickProduct"],setup(e,{emit:y}){const b=e,g=y,k=a(!1),h=()=>{k.value=!0},x=()=>{k.value=!1,q("cancel")},P=a(""),C=[{name:"查看账单",value:"showBill"},{name:"上传身份资料",value:"audit"},{name:"联系商家",value:"contact"}],R=t(()=>{const e=b.order||{};return e.needPay?"待付款":e.needUpload?"待审核":"repay"===e.action?"待还款":"earlyRepay"===e.action?"可提前结清":"defer"===e.action||"dailyRent"===e.action?"服务中":"进行中"});t(()=>{const e=b.order||{};return e.needPay?"待支付":"identity"===e.action?"上传身份资料":"contract"===e.action?"上传合同":"repay"===e.action?"还款":"earlyRepay"===e.action?"提前还款":"defer"===e.action?"申请延期":"dailyRent"===e.action?"日租续用":"风控材料"});const w=t(()=>{const e=b.order||{};if(e.title)return e.title;const a=[e.brand,e.model,e.storage].filter(Boolean);return a.length?a.join(" "):"租赁商品"}),F=t(()=>{const e=b.order||{};return e.spec?`已选：${e.spec}`:e.storage?`已选：${e.storage}`:""}),U=t(()=>{const e=b.order||{};return e.remainingPeriods?`租期：${e.remainingPeriods}期`:e.dailyFee?`日租金：¥${Number(e.dailyFee).toFixed(2)}`:""}),B=t(()=>{const e=b.order||{},a=e.totalRent??(e.perAmount&&e.remainingPeriods?e.perAmount*e.remainingPeriods:e.perAmount);return a?Number(a).toFixed(2):"0.00"}),N=t(()=>(b.order||{}).quantity||1),$=e=>{P.value=e.value,g("click",e.value)},q=e=>{g("click",e)};return(e,a)=>{const t=c,y=m,b=f,A=r(o("up-select"),l);return n(),s(t,{class:"order_item"},{default:d(()=>[u(t,{class:"order_header"},{default:d(()=>[u(t,{class:"order_store"},{default:d(()=>[u(t,{class:"store_icon"},{default:d(()=>[i("店")]),_:1}),u(t,{class:"store_name"},{default:d(()=>[i(_(e.order.storeName||"租无忧旗舰店"),1)]),_:1})]),_:1}),u(t,{class:"order_status"},{default:d(()=>[i(_(R.value),1)]),_:1})]),_:1}),u(t,{class:"order_body",onClick:a[0]||(a[0]=a=>{return t=e.order,void g("clickProduct",t);var t})},{default:d(()=>[u(t,{class:"product_thumb"},{default:d(()=>[u(y,{class:"product_img",src:e.order.img||"https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?auto=format&fit=crop&w=400&h=400&q=80",mode:"aspectFill"},null,8,["src"])]),_:1}),u(t,{class:"product_info"},{default:d(()=>[u(t,{class:"product_title"},{default:d(()=>[i(_(w.value),1)]),_:1}),F.value?(n(),s(t,{key:0,class:"product_spec"},{default:d(()=>[i(_(F.value),1)]),_:1})):p("",!0),U.value?(n(),s(t,{key:1,class:"product_term"},{default:d(()=>[i(_(U.value),1)]),_:1})):p("",!0),u(t,{class:"product_bottom"},{default:d(()=>[u(t,{class:"total_rent"},{default:d(()=>[u(b,{class:"total_label"},{default:d(()=>[i("总租金")]),_:1}),u(b,{class:"total_amount"},{default:d(()=>[i("¥"+_(B.value),1)]),_:1})]),_:1}),u(t,{class:"quantity"},{default:d(()=>[i("x"+_(N.value),1)]),_:1})]),_:1})]),_:1})]),_:1}),u(t,{class:"order_footer"},{default:d(()=>[u(t,{class:"plan_tag"},{default:d(()=>[u(A,{current:P.value,"onUpdate:current":a[1]||(a[1]=e=>P.value=e),label:"更多",options:C,overlayOpacity:"0.3",onSelect:$},null,8,["current"])]),_:1}),u(t,{class:"order_buttons"},{default:d(()=>[u(t,{class:"order_btn",onClick:v(h,["stop"])},{default:d(()=>[i("取消订单")]),_:1}),u(t,{class:"order_btn order_btn_primary",onClick:a[2]||(a[2]=v(e=>q("audit"),["stop"]))},{default:d(()=>[i("上传身份资料")]),_:1}),u(t,{class:"order_btn order_btn_primary",onClick:a[3]||(a[3]=v(e=>q("contact"),["stop"]))},{default:d(()=>[i("联系商家")]),_:1})]),_:1})]),_:1}),u(j,{show:k.value,"onUpdate:show":a[4]||(a[4]=e=>k.value=e),title:"取消订单",content:"订单生成后取消可能影响您的授信额度，确定继续取消吗？",showCancelButton:"",confirmText:"确认取消",cancelText:"暂不取消",confirmColor:"#3c9cff",onConfirm:x},null,8,["show"])]),_:1})}}}),[["__scopeId","data-v-d68c3f56"]]),B=y(e({__name:"index",setup(e){const l=a(!1),i=b([{name:"全部"},{name:"先审核后付"},{name:"待付款"},{name:"发货审核",badge:{value:5}},{name:"待发货"},{name:"待收货"},{name:"使用中"},{name:"已逾期"},{name:"归还中"},{name:"已完成"},{name:"已买断"},{name:"已关闭"}]),_=a(0),m=b([...F]);g(e=>{e&&e.type&&(_.value=Number(e.type))});const f=e=>{_.value=e},v=t(()=>0===_.value?m:1===_.value?m.filter(e=>e.needPay):2===_.value?m.filter(e=>e.needUpload):3===_.value?m.filter(e=>!e.needPay&&!e.needUpload&&"repay"!==e.action&&"earlyRepay"!==e.action):4===_.value?m.filter(e=>"repay"===e.action||"earlyRepay"===e.action):5===_.value?m.filter(e=>"defer"===e.action||"dailyRent"===e.action):m),y=e=>{console.log("订单点击:",e)},j=e=>{console.log("订单点击:",e),R({url:"./detail?id="+e.id})};return(e,a)=>{const t=k("b-navbar"),m=r(o("up-empty"),h),b=c,g=k("head-top");return n(),s(g,{loading:l.value,is_footer_mar:!1},{default:d(()=>[u(t,{title:"我的订单",is_back:!0,is_footer_mar:!1}),u(w,{list:i,current:_.value,"onUpdate:current":a[0]||(a[0]=e=>_.value=e),scrollable:"",onClick:f},null,8,["list","current"]),u(b,{class:"order_list"},{default:d(()=>[(n(!0),x(P,null,C(v.value,e=>(n(),s(U,{key:e.id,order:e,onClick:y,onClickProduct:j},null,8,["order"]))),128)),0===v.value.length?(n(),s(b,{key:0,class:"no-data"},{default:d(()=>[u(m,{mode:"order",text:"暂无相关订单"})]),_:1})):p("",!0)]),_:1})]),_:1},8,["loading"])}}}),[["__scopeId","data-v-25088160"]]);export{B as default};
