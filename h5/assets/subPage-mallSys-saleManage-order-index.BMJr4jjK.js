import{d as e,r as a,c as t,e as r,a3 as l,f as o,a as n,o as s,i as d,w as u,g as c,q as i,t as _,h as m,n as p,p as f,Q as v,A as y,K as b,B as g,b as k,a4 as h,k as P,F as x,l as C,x as w}from"./index-BmuteYHR.js";import{_ as R}from"./index.vue_vue_type_script_setup_true_lang.CS09kZXA.js";import{B as F}from"./index.C5tvjf77.js";import{o as U}from"./orders.DJuNOKoI.js";const j=y(e({__name:"OrderItem",props:{order:{}},emits:["click","clickProduct"],setup(e,{emit:y}){const b=e,g=y,k=a(!1),h=()=>{k.value=!0},P=()=>{k.value=!1,N("cancel")},x=a(""),C=[{name:"查看账单",value:"showBill"},{name:"用户资料",value:"audit"},{name:"付款凭证",value:"uploadPayProof"},{name:"线下归还",value:"returnOffline"},{name:"查看日志",value:"showLog"}],w=t(()=>{const e=b.order||{};return e.needPay?"待付款":e.needUpload?"待审核":"repay"===e.action?"待还款":"earlyRepay"===e.action?"可提前结清":"defer"===e.action||"dailyRent"===e.action?"服务中":"进行中"});t(()=>{const e=b.order||{};return e.needPay?"待支付":"identity"===e.action?"上传身份资料":"contract"===e.action?"上传合同":"repay"===e.action?"还款":"earlyRepay"===e.action?"提前还款":"defer"===e.action?"申请延期":"dailyRent"===e.action?"日租续用":"风控材料"});const R=t(()=>{const e=b.order||{};if(e.title)return e.title;const a=[e.brand,e.model,e.storage].filter(Boolean);return a.length?a.join(" "):"租赁商品"}),U=t(()=>{const e=b.order||{};return e.spec?`已选：${e.spec}`:e.storage?`已选：${e.storage}`:""}),j=t(()=>{const e=b.order||{};return e.remainingPeriods?`租期：${e.remainingPeriods}期`:e.dailyFee?`日租金：¥${Number(e.dailyFee).toFixed(2)}`:""}),A=t(()=>{const e=b.order||{},a=e.totalRent??(e.perAmount&&e.remainingPeriods?e.perAmount*e.remainingPeriods:e.perAmount);return a?Number(a).toFixed(2):"0.00"}),B=t(()=>(b.order||{}).quantity||1),q=e=>{x.value=e.value,g("click",e.value)},N=e=>{g("click",e)};return(e,a)=>{const t=d,y=m,b=f,$=r(o("up-select"),l);return s(),n(t,{class:"order_item"},{default:u(()=>[c(t,{class:"order_header"},{default:u(()=>[c(t,{class:"order_store"},{default:u(()=>[c(t,{class:"store_icon"},{default:u(()=>[i("店")]),_:1}),c(t,{class:"store_name"},{default:u(()=>[i(_(e.order.storeName||"租无忧旗舰店"),1)]),_:1})]),_:1}),c(t,{class:"order_status"},{default:u(()=>[i(_(w.value),1)]),_:1})]),_:1}),c(t,{class:"order_body",onClick:a[0]||(a[0]=a=>{return t=e.order,void g("clickProduct",t);var t})},{default:u(()=>[c(t,{class:"product_thumb"},{default:u(()=>[c(y,{class:"product_img",src:e.order.img||"https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?auto=format&fit=crop&w=400&h=400&q=80",mode:"aspectFill"},null,8,["src"])]),_:1}),c(t,{class:"product_info"},{default:u(()=>[c(t,{class:"product_title"},{default:u(()=>[i(_(R.value),1)]),_:1}),U.value?(s(),n(t,{key:0,class:"product_spec"},{default:u(()=>[i(_(U.value),1)]),_:1})):p("",!0),j.value?(s(),n(t,{key:1,class:"product_term"},{default:u(()=>[i(_(j.value),1)]),_:1})):p("",!0),c(t,{class:"product_bottom"},{default:u(()=>[c(t,{class:"total_rent"},{default:u(()=>[c(b,{class:"total_label"},{default:u(()=>[i("总租金")]),_:1}),c(b,{class:"total_amount"},{default:u(()=>[i("¥"+_(A.value),1)]),_:1})]),_:1}),c(t,{class:"quantity"},{default:u(()=>[i("x"+_(B.value),1)]),_:1})]),_:1})]),_:1})]),_:1}),c(t,{class:"order_footer"},{default:u(()=>[c(t,{class:"plan_tag"},{default:u(()=>[c($,{current:x.value,"onUpdate:current":a[1]||(a[1]=e=>x.value=e),label:"更多",options:C,overlayOpacity:"0.3",onSelect:q},null,8,["current"])]),_:1}),c(t,{class:"order_buttons"},{default:u(()=>[c(t,{class:"order_btn",onClick:v(h,["stop"])},{default:u(()=>[i("取消订单")]),_:1}),c(t,{class:"order_btn order_btn_primary",onClick:a[2]||(a[2]=v(e=>N("orderAudit"),["stop"]))},{default:u(()=>[i("订单审核")]),_:1}),c(t,{class:"order_btn order_btn_primary",onClick:a[3]||(a[3]=v(e=>N("audit"),["stop"]))},{default:u(()=>[i("审核资料")]),_:1})]),_:1})]),_:1}),c(F,{show:k.value,"onUpdate:show":a[4]||(a[4]=e=>k.value=e),title:"取消订单",content:"订单生成后取消可能影响您的授信额度，确定继续取消吗？",showCancelButton:"",confirmText:"确认取消",cancelText:"暂不取消",confirmColor:"#3c9cff",onConfirm:P},null,8,["show"])]),_:1})}}}),[["__scopeId","data-v-9e2cd534"]]),A=y(e({__name:"index",setup(e){const l=a(!1),i=b([{name:"全部"},{name:"先审核后付"},{name:"待付款"},{name:"发货审核",badge:{value:5}},{name:"待发货"},{name:"待收货"},{name:"使用中"},{name:"已逾期"},{name:"归还中"},{name:"已完成"},{name:"已买断"},{name:"已关闭"}]),_=a(0),m=b([...U]);g(e=>{e&&e.type&&(_.value=Number(e.type))});const f=e=>{_.value=e},v=t(()=>0===_.value?m:1===_.value?m.filter(e=>e.needPay):2===_.value?m.filter(e=>e.needUpload):3===_.value?m.filter(e=>!e.needPay&&!e.needUpload&&"repay"!==e.action&&"earlyRepay"!==e.action):4===_.value?m.filter(e=>"repay"===e.action||"earlyRepay"===e.action):5===_.value?m.filter(e=>"defer"===e.action||"dailyRent"===e.action):m),y=e=>{console.log("订单点击:",e)},F=e=>{console.log("订单点击:",e),w({url:"./detail?id="+e.id})};return(e,a)=>{const t=k("b-navbar"),m=r(o("up-empty"),h),b=d,g=k("head-top");return s(),n(g,{loading:l.value,is_footer_mar:!1},{default:u(()=>[c(t,{title:"我的订单",is_back:!0,is_footer_mar:!1}),c(R,{list:i,current:_.value,"onUpdate:current":a[0]||(a[0]=e=>_.value=e),scrollable:"",onClick:f},null,8,["list","current"]),c(b,{class:"order_list"},{default:u(()=>[(s(!0),P(x,null,C(v.value,e=>(s(),n(j,{key:e.id,order:e,onClick:y,onClickProduct:F},null,8,["order"]))),128)),0===v.value.length?(s(),n(b,{key:0,class:"no-data"},{default:u(()=>[c(m,{mode:"order",text:"暂无相关订单"})]),_:1})):p("",!0)]),_:1})]),_:1},8,["loading"])}}}),[["__scopeId","data-v-8d7072c5"]]);export{A as default};
