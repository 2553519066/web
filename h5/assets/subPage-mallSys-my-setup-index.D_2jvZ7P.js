import{d as e,r as l,e as a,ai as t,f as o,a as s,o as n,w as i,g as d,i as c,p as u,I as r,q as m,n as p,t as _,E as f,z as w,u as v,ag as x,ah as y,B as k,j as g,J as P,V as C,v as b,x as h,y as V}from"./index-BvTRnY6x.js";import{u as I}from"./userinfo.CF3eNbHI.js";const L=w(e({__name:"SetPasswordModal",props:{visible:{type:Boolean}},emits:["close","confirm"],setup(e,{emit:w}){const v=w,x=l({email:"",code:"",newPassword:"",confirmPassword:""}),y=l(0);function k(e){return/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(e)}function g(){y.value>0||(x.value.email?k(x.value.email)?(f({title:"验证码已发送",icon:"none"}),function(){y.value=60;const e=setInterval(()=>{y.value-=1,y.value<=0&&clearInterval(e)},1e3)}()):f({title:"请输入正确的邮箱格式",icon:"none"}):f({title:"请输入邮箱",icon:"none"}))}function P(){const e=x.value;var l;e.email?k(e.email)?e.code?e.newPassword?(l=e.newPassword,/^(?=.*[0-9])(?=.*[a-zA-Z])(?=.*[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]).{8,25}$/.test(l)?e.confirmPassword?e.newPassword===e.confirmPassword?v("confirm",{...e}):f({title:"两次输入的密码不一致",icon:"none"}):f({title:"请再次输入新密码",icon:"none"}):f({title:"密码格式不正确，需8~25位，含数字、字母、符号",icon:"none"})):f({title:"请输入新密码",icon:"none"}):f({title:"请输入验证码",icon:"none"}):f({title:"请输入正确的邮箱格式",icon:"none"}):f({title:"请输入邮箱",icon:"none"})}return(e,l)=>{const f=c,w=r,k=p,C=a(o("up-modal"),t);return n(),s(C,{show:e.visible,customStyle:{width:"620rpx"},showCancelButton:"",confirmColor:"#3c9cff",confirmText:"确认修改",cancelText:"取消",onConfirm:P,onCancel:l[4]||(l[4]=e=>v("close"))},{default:i(()=>[d(f,{class:"setpwd-modal"},{default:i(()=>[d(f,{class:"setpwd-modal__title"},{default:i(()=>[u("设置密码")]),_:1}),d(f,{class:"setpwd-modal__item"},{default:i(()=>[d(w,{modelValue:x.value.email,"onUpdate:modelValue":l[0]||(l[0]=e=>x.value.email=e),class:"setpwd-modal__input",placeholder:"请输入邮箱",type:"text"},null,8,["modelValue"])]),_:1}),d(f,{class:"setpwd-modal__item setpwd-modal__item--code"},{default:i(()=>[d(w,{modelValue:x.value.code,"onUpdate:modelValue":l[1]||(l[1]=e=>x.value.code=e),class:"setpwd-modal__input setpwd-modal__input--code",placeholder:"请输入验证码",type:"text"},null,8,["modelValue"]),d(f,{class:m(["setpwd-modal__code-btn",{"setpwd-modal__code-btn--disabled":y.value>0}]),onClick:g},{default:i(()=>[d(k,{class:"setpwd-modal__code-text"},{default:i(()=>[u(_(y.value>0?y.value+"s":"获取验证码"),1)]),_:1})]),_:1},8,["class"])]),_:1}),d(f,{class:"setpwd-modal__item"},{default:i(()=>[d(w,{modelValue:x.value.newPassword,"onUpdate:modelValue":l[2]||(l[2]=e=>x.value.newPassword=e),class:"setpwd-modal__input",placeholder:"请输入新密码（8~25位，含数字、字母、符号）",password:!0,type:"text"},null,8,["modelValue"])]),_:1}),d(f,{class:"setpwd-modal__item"},{default:i(()=>[d(w,{modelValue:x.value.confirmPassword,"onUpdate:modelValue":l[3]||(l[3]=e=>x.value.confirmPassword=e),class:"setpwd-modal__input",placeholder:"请再次输入新密码",password:!0,type:"text"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["show"])}}}),[["__scopeId","data-v-46ca2565"]]),S=w(e({__name:"index",setup(e){const t=I(),r=t.userInfo||{},{locale:m}=v(),w=l(!1),S=e=>{f({title:"密码设置成功",icon:"none"}),w.value=!1},z=()=>{P({title:"提示",content:"确定要退出登录吗？",success:e=>{e.confirm&&(t.clearUserInfo(),C({url:"/pages/userApp/login/index"}))}})},A=()=>{w.value=!0},U=e=>{b({url:"/subPage/mallSys/login/treaty?type="+e})},B=e=>{b({url:e})},Z=()=>{h({itemList:["简体中文","English","Bahasa Indonesia"],success:e=>{let l="";0===e.tapIndex?l="zh":1===e.tapIndex?l="en":2===e.tapIndex&&(l="id"),l&&(m.value=l,V("locale",l),f({title:"Language changed",icon:"none"}))}})};return(e,l)=>{const t=p,m=a(o("up-cell"),x),f=c,v=a(o("up-cell-group"),y),P=a(o("up-button"),k);return n(),s(f,{class:"setup"},{default:i(()=>[d(v,{border:!1},{default:i(()=>[d(m,{title:"邮箱账号",isLink:!1,arrow:!1},{value:i(()=>[d(t,{class:"user-email"},{default:i(()=>[u(_(g(r).email||"未绑定邮箱"),1)]),_:1})]),_:1}),d(m,{title:"审核资料",value:"查看详情",isLink:!0,onClick:l[0]||(l[0]=e=>B("/subPage/mallSys/my/information/index"))}),d(m,{title:"基础资料",value:"查看详情",isLink:!0,onClick:l[1]||(l[1]=e=>B("/subPage/mallSys/my/setup/userProfile"))}),d(m,{title:"补充资料",value:"查看详情",isLink:!0,onClick:l[2]||(l[2]=e=>B("/subPage/mallSys/my/information/identityeExtra"))}),d(f,{class:"divider"}),d(m,{title:"设置密码",isLink:!0,titleStyle:{color:"#3c9cff"},onClick:A}),d(m,{title:"多语言",isLink:!0,onClick:Z}),d(m,{title:"用户服务协议",isLink:!0,onClick:l[3]||(l[3]=e=>U("userAgreement"))}),d(m,{title:"租赁服务协议",isLink:!0,onClick:l[4]||(l[4]=e=>U("rentAgreement"))}),d(m,{title:"隐私协议",isLink:!0,onClick:l[5]||(l[5]=e=>U("privacyPolicy"))})]),_:1}),d(f,{class:"logout-btn-container"},{default:i(()=>[d(P,{text:"退出登录",onClick:z,customStyle:{color:"#333",backgroundColor:"#fff",border:"none",height:"100rpx",fontSize:"30rpx"}})]),_:1}),d(L,{visible:w.value,onClose:l[6]||(l[6]=e=>w.value=!1),onConfirm:S},null,8,["visible"])]),_:1})}}}),[["__scopeId","data-v-1345d1f3"]]);export{S as default};
